"use strict";(self.webpackChunkangular_app=self.webpackChunkangular_app||[]).push([[179],{991:(a,h,s)=>{function u(e){return"function"==typeof e}function l(e){const n=e(r=>{Error.call(r),r.stack=(new Error).stack});return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}const d=l(e=>function(n){e(this),this.message=n?`${n.length} errors occurred during unsubscription:\n${n.map((r,o)=>`${o+1}) ${r.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=n});function p(e,t){if(e){const n=e.indexOf(t);0<=n&&e.splice(n,1)}}class m{constructor(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let t;if(!this.closed){this.closed=!0;const{_parentage:n}=this;if(n)if(this._parentage=null,Array.isArray(n))for(const c of n)c.remove(this);else n.remove(this);const{initialTeardown:r}=this;if(u(r))try{r()}catch(c){t=c instanceof d?c.errors:[c]}const{_finalizers:o}=this;if(o){this._finalizers=null;for(const c of o)try{w(c)}catch(f){t=t??[],f instanceof d?t=[...t,...f.errors]:t.push(f)}}if(t)throw new d(t)}}add(t){var n;if(t&&t!==this)if(this.closed)w(t);else{if(t instanceof m){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(n=this._finalizers)&&void 0!==n?n:[]).push(t)}}_hasParent(t){const{_parentage:n}=this;return n===t||Array.isArray(n)&&n.includes(t)}_addParent(t){const{_parentage:n}=this;this._parentage=Array.isArray(n)?(n.push(t),n):n?[n,t]:t}_removeParent(t){const{_parentage:n}=this;n===t?this._parentage=null:Array.isArray(n)&&p(n,t)}remove(t){const{_finalizers:n}=this;n&&p(n,t),t instanceof m&&t._removeParent(this)}}m.EMPTY=(()=>{const e=new m;return e.closed=!0,e})();const v=m.EMPTY;function b(e){return e instanceof m||e&&"closed"in e&&u(e.remove)&&u(e.add)&&u(e.unsubscribe)}function w(e){u(e)?e():e.unsubscribe()}const S={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},M={setTimeout(e,t,...n){const{delegate:r}=M;return r?.setTimeout?r.setTimeout(e,t,...n):setTimeout(e,t,...n)},clearTimeout(e){const{delegate:t}=M;return(t?.clearTimeout||clearTimeout)(e)},delegate:void 0};function A(e){M.setTimeout(()=>{const{onUnhandledError:t}=S;if(!t)throw e;t(e)})}function k(){}const N=G("C",void 0,void 0);function G(e,t,n){return{kind:e,value:t,error:n}}let te=null;function be(e){if(S.useDeprecatedSynchronousErrorHandling){const t=!te;if(t&&(te={errorThrown:!1,error:null}),e(),t){const{errorThrown:n,error:r}=te;if(te=null,n)throw r}}else e()}class oe extends m{constructor(t){super(),this.isStopped=!1,t?(this.destination=t,b(t)&&t.add(this)):this.destination=$e}static create(t,n,r){return new xe(t,n,r)}next(t){this.isStopped?Ae(function z(e){return G("N",e,void 0)}(t),this):this._next(t)}error(t){this.isStopped?Ae(function B(e){return G("E",void 0,e)}(t),this):(this.isStopped=!0,this._error(t))}complete(){this.isStopped?Ae(N,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(t){this.destination.next(t)}_error(t){try{this.destination.error(t)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const we=Function.prototype.bind;function Ge(e,t){return we.call(e,t)}class ve{constructor(t){this.partialObserver=t}next(t){const{partialObserver:n}=this;if(n.next)try{n.next(t)}catch(r){Oe(r)}}error(t){const{partialObserver:n}=this;if(n.error)try{n.error(t)}catch(r){Oe(r)}else Oe(t)}complete(){const{partialObserver:t}=this;if(t.complete)try{t.complete()}catch(n){Oe(n)}}}class xe extends oe{constructor(t,n,r){let o;if(super(),u(t)||!t)o={next:t??void 0,error:n??void 0,complete:r??void 0};else{let c;this&&S.useDeprecatedNextContext?(c=Object.create(t),c.unsubscribe=()=>this.unsubscribe(),o={next:t.next&&Ge(t.next,c),error:t.error&&Ge(t.error,c),complete:t.complete&&Ge(t.complete,c)}):o=t}this.destination=new ve(o)}}function Oe(e){S.useDeprecatedSynchronousErrorHandling?function me(e){S.useDeprecatedSynchronousErrorHandling&&te&&(te.errorThrown=!0,te.error=e)}(e):A(e)}function Ae(e,t){const{onStoppedNotification:n}=S;n&&M.setTimeout(()=>n(e,t))}const $e={closed:!0,next:k,error:function Ce(e){throw e},complete:k},Re="function"==typeof Symbol&&Symbol.observable||"@@observable";function H(e){return e}let $=(()=>{class e{constructor(n){n&&(this._subscribe=n)}lift(n){const r=new e;return r.source=this,r.operator=n,r}subscribe(n,r,o){const c=function Pe(e){return e&&e instanceof oe||function W(e){return e&&u(e.next)&&u(e.error)&&u(e.complete)}(e)&&b(e)}(n)?n:new xe(n,r,o);return be(()=>{const{operator:f,source:g}=this;c.add(f?f.call(c,g):g?this._subscribe(c):this._trySubscribe(c))}),c}_trySubscribe(n){try{return this._subscribe(n)}catch(r){n.error(r)}}forEach(n,r){return new(r=J(r))((o,c)=>{const f=new xe({next:g=>{try{n(g)}catch(y){c(y),f.unsubscribe()}},error:c,complete:o});this.subscribe(f)})}_subscribe(n){var r;return null===(r=this.source)||void 0===r?void 0:r.subscribe(n)}[Re](){return this}pipe(...n){return function j(e){return 0===e.length?H:1===e.length?e[0]:function(n){return e.reduce((r,o)=>o(r),n)}}(n)(this)}toPromise(n){return new(n=J(n))((r,o)=>{let c;this.subscribe(f=>c=f,f=>o(f),()=>r(c))})}}return e.create=t=>new e(t),e})();function J(e){var t;return null!==(t=e??S.Promise)&&void 0!==t?t:Promise}const Ze=l(e=>function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let qe=(()=>{class e extends ${constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(n){const r=new Vt(this,this);return r.operator=n,r}_throwIfClosed(){if(this.closed)throw new Ze}next(n){be(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const r of this.currentObservers)r.next(n)}})}error(n){be(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=n;const{observers:r}=this;for(;r.length;)r.shift().error(n)}})}complete(){be(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:n}=this;for(;n.length;)n.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var n;return(null===(n=this.observers)||void 0===n?void 0:n.length)>0}_trySubscribe(n){return this._throwIfClosed(),super._trySubscribe(n)}_subscribe(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)}_innerSubscribe(n){const{hasError:r,isStopped:o,observers:c}=this;return r||o?v:(this.currentObservers=null,c.push(n),new m(()=>{this.currentObservers=null,p(c,n)}))}_checkFinalizedStatuses(n){const{hasError:r,thrownError:o,isStopped:c}=this;r?n.error(o):c&&n.complete()}asObservable(){const n=new $;return n.source=this,n}}return e.create=(t,n)=>new Vt(t,n),e})();class Vt extends qe{constructor(t,n){super(),this.destination=t,this.source=n}next(t){var n,r;null===(r=null===(n=this.destination)||void 0===n?void 0:n.next)||void 0===r||r.call(n,t)}error(t){var n,r;null===(r=null===(n=this.destination)||void 0===n?void 0:n.error)||void 0===r||r.call(n,t)}complete(){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.complete)||void 0===n||n.call(t)}_subscribe(t){var n,r;return null!==(r=null===(n=this.source)||void 0===n?void 0:n.subscribe(t))&&void 0!==r?r:v}}function it(e){return t=>{if(function $t(e){return u(e?.lift)}(t))return t.lift(function(n){try{return e(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function Nn(e,t,n,r,o){return new sy(e,t,n,r,o)}class sy extends oe{constructor(t,n,r,o,c,f){super(t),this.onFinalize=c,this.shouldUnsubscribe=f,this._next=n?function(g){try{n(g)}catch(y){t.error(y)}}:super._next,this._error=o?function(g){try{o(g)}catch(y){t.error(y)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(g){t.error(g)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:n}=this;super.unsubscribe(),!n&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}}}function bn(e){return this instanceof bn?(this.v=e,this):new bn(e)}function cc(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,t=e[Symbol.asyncIterator];return t?t.call(e):(e=function js(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(e),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(c){n[c]=e[c]&&function(f){return new Promise(function(g,y){!function o(c,f,g,y){Promise.resolve(y).then(function(_){c({value:_,done:g})},f)}(g,y,(f=e[c](f)).done,f.value)})}}}"function"==typeof SuppressedError&&SuppressedError;const dc=e=>e&&"number"==typeof e.length&&"function"!=typeof e;function fc(e){return u(e?.then)}function pc(e){return u(e[Re])}function hc(e){return Symbol.asyncIterator&&u(e?.[Symbol.asyncIterator])}function gc(e){return new TypeError(`You provided ${null!==e&&"object"==typeof e?"an invalid object":`'${e}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const mc=function ky(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function vc(e){return u(e?.[mc])}function yc(e){return function uc(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o,r=n.apply(e,t||[]),c=[];return o={},f("next"),f("throw"),f("return"),o[Symbol.asyncIterator]=function(){return this},o;function f(D){r[D]&&(o[D]=function(I){return new Promise(function(T,x){c.push([D,I,T,x])>1||g(D,I)})})}function g(D,I){try{!function y(D){D.value instanceof bn?Promise.resolve(D.value.v).then(_,C):E(c[0][2],D)}(r[D](I))}catch(T){E(c[0][3],T)}}function _(D){g("next",D)}function C(D){g("throw",D)}function E(D,I){D(I),c.shift(),c.length&&g(c[0][0],c[0][1])}}(this,arguments,function*(){const n=e.getReader();try{for(;;){const{value:r,done:o}=yield bn(n.read());if(o)return yield bn(void 0);yield yield bn(r)}}finally{n.releaseLock()}})}function _c(e){return u(e?.getReader)}function nn(e){if(e instanceof $)return e;if(null!=e){if(pc(e))return function Ay(e){return new $(t=>{const n=e[Re]();if(u(n.subscribe))return n.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(e);if(dc(e))return function xy(e){return new $(t=>{for(let n=0;n<e.length&&!t.closed;n++)t.next(e[n]);t.complete()})}(e);if(fc(e))return function Ry(e){return new $(t=>{e.then(n=>{t.closed||(t.next(n),t.complete())},n=>t.error(n)).then(null,A)})}(e);if(hc(e))return bc(e);if(vc(e))return function Ny(e){return new $(t=>{for(const n of e)if(t.next(n),t.closed)return;t.complete()})}(e);if(_c(e))return function Oy(e){return bc(yc(e))}(e)}throw gc(e)}function bc(e){return new $(t=>{(function Py(e,t){var n,r,o,c;return function ac(e,t,n,r){return new(n||(n=Promise))(function(c,f){function g(C){try{_(r.next(C))}catch(E){f(E)}}function y(C){try{_(r.throw(C))}catch(E){f(E)}}function _(C){C.done?c(C.value):function o(c){return c instanceof n?c:new n(function(f){f(c)})}(C.value).then(g,y)}_((r=r.apply(e,t||[])).next())})}(this,void 0,void 0,function*(){try{for(n=cc(e);!(r=yield n.next()).done;)if(t.next(r.value),t.closed)return}catch(f){o={error:f}}finally{try{r&&!r.done&&(c=n.return)&&(yield c.call(n))}finally{if(o)throw o.error}}t.complete()})})(e,t).catch(n=>t.error(n))})}function Cn(e,t,n,r=0,o=!1){const c=t.schedule(function(){n(),o?e.add(this.schedule(null,r)):this.unsubscribe()},r);if(e.add(c),!o)return c}function Cc(e,t,n=1/0){return u(t)?Cc((r,o)=>function ay(e,t){return it((n,r)=>{let o=0;n.subscribe(Nn(r,c=>{r.next(e.call(t,c,o++))}))})}((c,f)=>t(r,c,o,f))(nn(e(r,o))),n):("number"==typeof t&&(n=t),it((r,o)=>function Ly(e,t,n,r,o,c,f,g){const y=[];let _=0,C=0,E=!1;const D=()=>{E&&!y.length&&!_&&t.complete()},I=x=>_<r?T(x):y.push(x),T=x=>{c&&t.next(x),_++;let P=!1;nn(n(x,C++)).subscribe(Nn(t,F=>{o?.(F),c?I(F):t.next(F)},()=>{P=!0},void 0,()=>{if(P)try{for(_--;y.length&&_<r;){const F=y.shift();f?Cn(t,f,()=>T(F)):T(F)}D()}catch(F){t.error(F)}}))};return e.subscribe(Nn(t,I,()=>{E=!0,D()})),()=>{g?.()}}(r,o,e,n)))}const wc=new $(e=>e.complete());function Bs(e){return e[e.length-1]}function Ec(e){return function By(e){return e&&u(e.schedule)}(Bs(e))?e.pop():void 0}function Sc(e,t=0){return it((n,r)=>{n.subscribe(Nn(r,o=>Cn(r,e,()=>r.next(o),t),()=>Cn(r,e,()=>r.complete(),t),o=>Cn(r,e,()=>r.error(o),t)))})}function Dc(e,t=0){return it((n,r)=>{r.add(e.schedule(()=>n.subscribe(r),t))})}function Ic(e,t){if(!e)throw new Error("Iterable cannot be null");return new $(n=>{Cn(n,t,()=>{const r=e[Symbol.asyncIterator]();Cn(n,t,()=>{r.next().then(o=>{o.done?n.complete():n.next(o.value)})},0,!0)})})}function Mc(e,t){return t?function qy(e,t){if(null!=e){if(pc(e))return function Uy(e,t){return nn(e).pipe(Dc(t),Sc(t))}(e,t);if(dc(e))return function $y(e,t){return new $(n=>{let r=0;return t.schedule(function(){r===e.length?n.complete():(n.next(e[r++]),n.closed||this.schedule())})})}(e,t);if(fc(e))return function Vy(e,t){return nn(e).pipe(Dc(t),Sc(t))}(e,t);if(hc(e))return Ic(e,t);if(vc(e))return function zy(e,t){return new $(n=>{let r;return Cn(n,t,()=>{r=e[mc](),Cn(n,t,()=>{let o,c;try{({value:o,done:c}=r.next())}catch(f){return void n.error(f)}c?n.complete():n.next(o)},0,!0)}),()=>u(r?.return)&&r.return()})}(e,t);if(_c(e))return function Gy(e,t){return Ic(yc(e),t)}(e,t)}throw gc(e)}(e,t):nn(e)}function Wy(...e){const t=Ec(e),n=function Hy(e,t){return"number"==typeof Bs(e)?e.pop():t}(e,1/0),r=e;return r.length?1===r.length?nn(r[0]):function Fy(e=1/0){return Cc(H,e)}(n)(Mc(r,t)):wc}class Yy extends qe{constructor(t){super(),this._value=t}get value(){return this.getValue()}_subscribe(t){const n=super._subscribe(t);return!n.closed&&t.next(this._value),n}getValue(){const{hasError:t,thrownError:n,_value:r}=this;if(t)throw n;return this._throwIfClosed(),r}next(t){super.next(this._value=t)}}function Tc(e={}){const{connector:t=(()=>new qe),resetOnError:n=!0,resetOnComplete:r=!0,resetOnRefCountZero:o=!0}=e;return c=>{let f,g,y,_=0,C=!1,E=!1;const D=()=>{g?.unsubscribe(),g=void 0},I=()=>{D(),f=y=void 0,C=E=!1},T=()=>{const x=f;I(),x?.unsubscribe()};return it((x,P)=>{_++,!E&&!C&&D();const F=y=y??t();P.add(()=>{_--,0===_&&!E&&!C&&(g=Hs(T,o))}),F.subscribe(P),!f&&_>0&&(f=new xe({next:R=>F.next(R),error:R=>{E=!0,D(),g=Hs(I,n,R),F.error(R)},complete:()=>{C=!0,D(),g=Hs(I,r),F.complete()}}),nn(x).subscribe(f))})(c)}}function Hs(e,t,...n){if(!0===t)return void e();if(!1===t)return;const r=new xe({next:()=>{r.unsubscribe(),e()}});return nn(t(...n)).subscribe(r)}function Jy(e,t){return e===t}function _e(e){for(let t in e)if(e[t]===_e)return t;throw Error("Could not find renamed property on target object.")}function We(e){if("string"==typeof e)return e;if(Array.isArray(e))return"["+e.map(We).join(", ")+"]";if(null==e)return""+e;if(e.overriddenName)return`${e.overriddenName}`;if(e.name)return`${e.name}`;const t=e.toString();if(null==t)return""+t;const n=t.indexOf("\n");return-1===n?t:t.substring(0,n)}function Us(e,t){return null==e||""===e?null===t?"":t:null==t||""===t?e:e+" "+t}const Xy=_e({__forward_ref__:_e});function Vs(e){return e.__forward_ref__=Vs,e.toString=function(){return We(this())},e}function Q(e){return function $s(e){return"function"==typeof e&&e.hasOwnProperty(Xy)&&e.__forward_ref__===Vs}(e)?e():e}function zs(e){return e&&!!e.\u0275providers}class V extends Error{constructor(t,n){super(function Yi(e,t){return`NG0${Math.abs(e)}${t?": "+t:""}`}(t,n)),this.code=t}}function ye(e){return"function"==typeof e?e.name||e.toString():"object"==typeof e&&null!=e&&"function"==typeof e.type?e.type.name||e.type.toString():function X(e){return"string"==typeof e?e:null==e?"":String(e)}(e)}function Gs(e,t){throw new V(-201,!1)}function Mt(e,t){null==e&&function Y(e,t,n,r){throw new Error(`ASSERTION ERROR: ${e}`+(null==r?"":` [Expected=> ${n} ${r} ${t} <=Actual]`))}(t,e,null,"!=")}function Ee(e){return{token:e.token,providedIn:e.providedIn||null,factory:e.factory,value:void 0}}function Wn(e){return{providers:e.providers||[],imports:e.imports||[]}}function Ki(e){return Ac(e,Qi)||Ac(e,xc)}function Ac(e,t){return e.hasOwnProperty(t)?e[t]:null}function Zi(e){return e&&(e.hasOwnProperty(qs)||e.hasOwnProperty(a0))?e[qs]:null}const Qi=_e({\u0275prov:_e}),qs=_e({\u0275inj:_e}),xc=_e({ngInjectableDef:_e}),a0=_e({ngInjectorDef:_e});var ue=function(e){return e[e.Default=0]="Default",e[e.Host=1]="Host",e[e.Self=2]="Self",e[e.SkipSelf=4]="SkipSelf",e[e.Optional=8]="Optional",e}(ue||{});let Ws;function pt(e){const t=Ws;return Ws=e,t}function Nc(e,t,n){const r=Ki(e);return r&&"root"==r.providedIn?void 0===r.value?r.value=r.factory():r.value:n&ue.Optional?null:void 0!==t?t:void Gs(We(e))}const De=globalThis,zr={},Js="__NG_DI_FLAG__",Ji="ngTempTokenPath",c0=/\n/gm,Pc="__source";let Yn;function wn(e){const t=Yn;return Yn=e,t}function p0(e,t=ue.Default){if(void 0===Yn)throw new V(-203,!1);return null===Yn?Nc(e,void 0,t):Yn.get(e,t&ue.Optional?null:void 0,t)}function ce(e,t=ue.Default){return(function Rc(){return Ws}()||p0)(Q(e),t)}function Ie(e,t=ue.Default){return ce(e,Xi(t))}function Xi(e){return typeof e>"u"||"number"==typeof e?e:0|(e.optional&&8)|(e.host&&1)|(e.self&&2)|(e.skipSelf&&4)}function Xs(e){const t=[];for(let n=0;n<e.length;n++){const r=Q(e[n]);if(Array.isArray(r)){if(0===r.length)throw new V(900,!1);let o,c=ue.Default;for(let f=0;f<r.length;f++){const g=r[f],y=h0(g);"number"==typeof y?-1===y?o=g.token:c|=y:o=g}t.push(ce(o,c))}else t.push(ce(r))}return t}function h0(e){return e[Js]}function rn(e){return{toString:e}.toString()}var eo=function(e){return e[e.OnPush=0]="OnPush",e[e.Default=1]="Default",e}(eo||{}),Ot=function(e){return e[e.Emulated=0]="Emulated",e[e.None=2]="None",e[e.ShadowDom=3]="ShadowDom",e}(Ot||{});const zt={},pe=[],to=_e({\u0275cmp:_e}),ea=_e({\u0275dir:_e}),ta=_e({\u0275pipe:_e}),Fc=_e({\u0275mod:_e}),on=_e({\u0275fac:_e}),qr=_e({__NG_ELEMENT_ID__:_e}),jc=_e({__NG_ENV_ID__:_e});function Bc(e,t,n){let r=e.length;for(;;){const o=e.indexOf(t,n);if(-1===o)return o;if(0===o||e.charCodeAt(o-1)<=32){const c=t.length;if(o+c===r||e.charCodeAt(o+c)<=32)return o}n=o+1}}function na(e,t,n){let r=0;for(;r<n.length;){const o=n[r];if("number"==typeof o){if(0!==o)break;r++;const c=n[r++],f=n[r++],g=n[r++];e.setAttribute(t,f,g,c)}else{const c=o,f=n[++r];Uc(c)?e.setProperty(t,c,f):e.setAttribute(t,c,f),r++}}return r}function Hc(e){return 3===e||4===e||6===e}function Uc(e){return 64===e.charCodeAt(0)}function Wr(e,t){if(null!==t&&0!==t.length)if(null===e||0===e.length)e=t.slice();else{let n=-1;for(let r=0;r<t.length;r++){const o=t[r];"number"==typeof o?n=o:0===n||Vc(e,n,o,null,-1===n||2===n?t[++r]:null)}}return e}function Vc(e,t,n,r,o){let c=0,f=e.length;if(-1===t)f=-1;else for(;c<e.length;){const g=e[c++];if("number"==typeof g){if(g===t){f=-1;break}if(g>t){f=c-1;break}}}for(;c<e.length;){const g=e[c];if("number"==typeof g)break;if(g===n){if(null===r)return void(null!==o&&(e[c+1]=o));if(r===e[c+1])return void(e[c+2]=o)}c++,null!==r&&c++,null!==o&&c++}-1!==f&&(e.splice(f,0,t),c=f+1),e.splice(c++,0,n),null!==r&&e.splice(c++,0,r),null!==o&&e.splice(c++,0,o)}const $c="ng-template";function v0(e,t,n){let r=0,o=!0;for(;r<e.length;){let c=e[r++];if("string"==typeof c&&o){const f=e[r++];if(n&&"class"===c&&-1!==Bc(f.toLowerCase(),t,0))return!0}else{if(1===c){for(;r<e.length&&"string"==typeof(c=e[r++]);)if(c.toLowerCase()===t)return!0;return!1}"number"==typeof c&&(o=!1)}}return!1}function zc(e){return 4===e.type&&e.value!==$c}function y0(e,t,n){return t===(4!==e.type||n?e.value:$c)}function _0(e,t,n){let r=4;const o=e.attrs||[],c=function w0(e){for(let t=0;t<e.length;t++)if(Hc(e[t]))return t;return e.length}(o);let f=!1;for(let g=0;g<t.length;g++){const y=t[g];if("number"!=typeof y){if(!f)if(4&r){if(r=2|1&r,""!==y&&!y0(e,y,n)||""===y&&1===t.length){if(Pt(r))return!1;f=!0}}else{const _=8&r?y:t[++g];if(8&r&&null!==e.attrs){if(!v0(e.attrs,_,n)){if(Pt(r))return!1;f=!0}continue}const E=b0(8&r?"class":y,o,zc(e),n);if(-1===E){if(Pt(r))return!1;f=!0;continue}if(""!==_){let D;D=E>c?"":o[E+1].toLowerCase();const I=8&r?D:null;if(I&&-1!==Bc(I,_,0)||2&r&&_!==D){if(Pt(r))return!1;f=!0}}}}else{if(!f&&!Pt(r)&&!Pt(y))return!1;if(f&&Pt(y))continue;f=!1,r=y|1&r}}return Pt(r)||f}function Pt(e){return 0==(1&e)}function b0(e,t,n,r){if(null===t)return-1;let o=0;if(r||!n){let c=!1;for(;o<t.length;){const f=t[o];if(f===e)return o;if(3===f||6===f)c=!0;else{if(1===f||2===f){let g=t[++o];for(;"string"==typeof g;)g=t[++o];continue}if(4===f)break;if(0===f){o+=4;continue}}o+=c?1:2}return-1}return function E0(e,t){let n=e.indexOf(4);if(n>-1)for(n++;n<e.length;){const r=e[n];if("number"==typeof r)return-1;if(r===t)return n;n++}return-1}(t,e)}function Gc(e,t,n=!1){for(let r=0;r<t.length;r++)if(_0(e,t[r],n))return!0;return!1}function qc(e,t){return e?":not("+t.trim()+")":t}function D0(e){let t=e[0],n=1,r=2,o="",c=!1;for(;n<e.length;){let f=e[n];if("string"==typeof f)if(2&r){const g=e[++n];o+="["+f+(g.length>0?'="'+g+'"':"")+"]"}else 8&r?o+="."+f:4&r&&(o+=" "+f);else""!==o&&!Pt(f)&&(t+=qc(c,o),o=""),r=f,c=c||!Pt(r);n++}return""!==o&&(t+=qc(c,o)),t}function Wc(e){return rn(()=>{const t=function Kc(e){const t={};return{type:e.type,providersResolver:null,factory:null,hostBindings:e.hostBindings||null,hostVars:e.hostVars||0,hostAttrs:e.hostAttrs||null,contentQueries:e.contentQueries||null,declaredInputs:t,inputTransforms:null,inputConfig:e.inputs||zt,exportAs:e.exportAs||null,standalone:!0===e.standalone,signals:!0===e.signals,selectors:e.selectors||pe,viewQuery:e.viewQuery||null,features:e.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:Yc(e.inputs,t),outputs:Yc(e.outputs)}}(e),n={...t,decls:e.decls,vars:e.vars,template:e.template,consts:e.consts||null,ngContentSelectors:e.ngContentSelectors,onPush:e.changeDetection===eo.OnPush,directiveDefs:null,pipeDefs:null,dependencies:t.standalone&&e.dependencies||null,getStandaloneInjector:null,signals:e.signals??!1,data:e.data||{},encapsulation:e.encapsulation||Ot.Emulated,styles:e.styles||pe,_:null,schemas:e.schemas||null,tView:null,id:""};!function Zc(e){e.features?.forEach(t=>t(e))}(n);const r=e.dependencies;return n.directiveDefs=no(r,!1),n.pipeDefs=no(r,!0),n.id=function N0(e){let t=0;const n=[e.selectors,e.ngContentSelectors,e.hostVars,e.hostAttrs,e.consts,e.vars,e.decls,e.encapsulation,e.standalone,e.signals,e.exportAs,JSON.stringify(e.inputs),JSON.stringify(e.outputs),Object.getOwnPropertyNames(e.type.prototype),!!e.contentQueries,!!e.viewQuery].join("|");for(const o of n)t=Math.imul(31,t)+o.charCodeAt(0)<<0;return t+=2147483648,"c"+t}(n),n})}function k0(e){return de(e)||Qe(e)}function A0(e){return null!==e}function Yr(e){return rn(()=>({type:e.type,bootstrap:e.bootstrap||pe,declarations:e.declarations||pe,imports:e.imports||pe,exports:e.exports||pe,transitiveCompileScopes:null,schemas:e.schemas||null,id:e.id||null}))}function Yc(e,t){if(null==e)return zt;const n={};for(const r in e)if(e.hasOwnProperty(r)){let o=e[r],c=o;Array.isArray(o)&&(c=o[1],o=o[0]),n[o]=r,t&&(t[o]=c)}return n}function de(e){return e[to]||null}function Qe(e){return e[ea]||null}function ot(e){return e[ta]||null}function no(e,t){if(!e)return null;const n=t?ot:k0;return()=>("function"==typeof e?e():e).map(r=>n(r)).filter(A0)}const Fe=0,U=1,ie=2,Ne=3,Lt=4,Zr=5,tt=6,Kn=7,He=8,En=9,Zn=10,ee=11,Qr=12,Qc=13,Qn=14,Ue=15,Jr=16,Jn=17,Gt=18,Xr=19,Jc=20,Sn=21,sn=22,ei=23,ti=24,ae=25,ra=1,Xc=2,qt=7,Xn=9,Je=11;function gt(e){return Array.isArray(e)&&"object"==typeof e[ra]}function st(e){return Array.isArray(e)&&!0===e[ra]}function ia(e){return 0!=(4&e.flags)}function Pn(e){return e.componentOffset>-1}function Ft(e){return!!e.template}function oa(e){return 0!=(512&e[ie])}function Ln(e,t){return e.hasOwnProperty(on)?e[on]:null}let Xe=null,oo=!1;function kt(e){const t=Xe;return Xe=e,t}const nd={version:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{}};function id(e){if(!ri(e)||e.dirty){if(!e.producerMustRecompute(e)&&!ad(e))return void(e.dirty=!1);e.producerRecomputeValue(e),e.dirty=!1}}function sd(e){e.dirty=!0,function od(e){if(void 0===e.liveConsumerNode)return;const t=oo;oo=!0;try{for(const n of e.liveConsumerNode)n.dirty||sd(n)}finally{oo=t}}(e),e.consumerMarkedDirty?.(e)}function aa(e){return e&&(e.nextProducerIndex=0),kt(e)}function la(e,t){if(kt(t),e&&void 0!==e.producerNode&&void 0!==e.producerIndexOfThis&&void 0!==e.producerLastReadVersion){if(ri(e))for(let n=e.nextProducerIndex;n<e.producerNode.length;n++)so(e.producerNode[n],e.producerIndexOfThis[n]);for(;e.producerNode.length>e.nextProducerIndex;)e.producerNode.pop(),e.producerLastReadVersion.pop(),e.producerIndexOfThis.pop()}}function ad(e){er(e);for(let t=0;t<e.producerNode.length;t++){const n=e.producerNode[t],r=e.producerLastReadVersion[t];if(r!==n.version||(id(n),r!==n.version))return!0}return!1}function ld(e){if(er(e),ri(e))for(let t=0;t<e.producerNode.length;t++)so(e.producerNode[t],e.producerIndexOfThis[t]);e.producerNode.length=e.producerLastReadVersion.length=e.producerIndexOfThis.length=0,e.liveConsumerNode&&(e.liveConsumerNode.length=e.liveConsumerIndexOfThis.length=0)}function so(e,t){if(function cd(e){e.liveConsumerNode??=[],e.liveConsumerIndexOfThis??=[]}(e),er(e),1===e.liveConsumerNode.length)for(let r=0;r<e.producerNode.length;r++)so(e.producerNode[r],e.producerIndexOfThis[r]);const n=e.liveConsumerNode.length-1;if(e.liveConsumerNode[t]=e.liveConsumerNode[n],e.liveConsumerIndexOfThis[t]=e.liveConsumerIndexOfThis[n],e.liveConsumerNode.length--,e.liveConsumerIndexOfThis.length--,t<e.liveConsumerNode.length){const r=e.liveConsumerIndexOfThis[t],o=e.liveConsumerNode[t];er(o),o.producerIndexOfThis[r]=t}}function ri(e){return e.consumerIsAlwaysLive||(e?.liveConsumerNode?.length??0)>0}function er(e){e.producerNode??=[],e.producerIndexOfThis??=[],e.producerLastReadVersion??=[]}let dd=null;const gd=()=>{},q0=(()=>({...nd,consumerIsAlwaysLive:!0,consumerAllowSignalWrites:!1,consumerMarkedDirty:e=>{e.schedule(e.ref)},hasRun:!1,cleanupFn:gd}))();class W0{constructor(t,n,r){this.previousValue=t,this.currentValue=n,this.firstChange=r}isFirstChange(){return this.firstChange}}function md(e){return e.type.prototype.ngOnChanges&&(e.setInput=K0),Y0}function Y0(){const e=yd(this),t=e?.current;if(t){const n=e.previous;if(n===zt)e.previous=t;else for(let r in t)n[r]=t[r];e.current=null,this.ngOnChanges(t)}}function K0(e,t,n,r){const o=this.declaredInputs[n],c=yd(e)||function Z0(e,t){return e[vd]=t}(e,{previous:zt,current:null}),f=c.current||(c.current={}),g=c.previous,y=g[o];f[o]=new W0(y&&y.currentValue,t,g===zt),e[r]=t}const vd="__ngSimpleChanges__";function yd(e){return e[vd]||null}const Wt=function(e,t,n){};function Me(e){for(;Array.isArray(e);)e=e[Fe];return e}function mt(e,t){return Me(t[e.index])}function Et(e,t){const n=t[e];return gt(n)?n:n[Fe]}function In(e,t){return null==t?null:e[t]}function wd(e){e[Jn]=0}function n_(e){1024&e[ie]||(e[ie]|=1024,Sd(e,1))}function Ed(e){1024&e[ie]&&(e[ie]&=-1025,Sd(e,-1))}function Sd(e,t){let n=e[Ne];if(null===n)return;n[Zr]+=t;let r=n;for(n=n[Ne];null!==n&&(1===t&&1===r[Zr]||-1===t&&0===r[Zr]);)n[Zr]+=t,r=n,n=n[Ne]}const K={lFrame:Pd(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function Md(){return K.bindingsEnabled}function O(){return K.lFrame.lView}function fe(){return K.lFrame.tView}function et(){let e=Td();for(;null!==e&&64===e.type;)e=e.parent;return e}function Td(){return K.lFrame.currentTNode}function Yt(e,t){const n=K.lFrame;n.currentTNode=e,n.isParent=t}function pa(){return K.lFrame.isParent}function m_(e,t){const n=K.lFrame;n.bindingIndex=n.bindingRootIndex=e,ga(t)}function ga(e){K.lFrame.currentDirectiveIndex=e}function va(e){K.lFrame.currentQueryIndex=e}function y_(e){const t=e[U];return 2===t.type?t.declTNode:1===t.type?e[tt]:null}function Nd(e,t,n){if(n&ue.SkipSelf){let o=t,c=e;for(;!(o=o.parent,null!==o||n&ue.Host||(o=y_(c),null===o||(c=c[Qn],10&o.type))););if(null===o)return!1;t=o,e=c}const r=K.lFrame=Od();return r.currentTNode=t,r.lView=e,!0}function ya(e){const t=Od(),n=e[U];K.lFrame=t,t.currentTNode=n.firstChild,t.lView=e,t.tView=n,t.contextLView=e,t.bindingIndex=n.bindingStartIndex,t.inI18n=!1}function Od(){const e=K.lFrame,t=null===e?null:e.child;return null===t?Pd(e):t}function Pd(e){const t={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:e,child:null,inI18n:!1};return null!==e&&(e.child=t),t}function Ld(){const e=K.lFrame;return K.lFrame=e.parent,e.currentTNode=null,e.lView=null,e}const Fd=Ld;function _a(){const e=Ld();e.isParent=!0,e.tView=null,e.selectedIndex=-1,e.contextLView=null,e.elementDepthCount=0,e.currentDirectiveIndex=-1,e.currentNamespace=null,e.bindingRootIndex=-1,e.bindingIndex=-1,e.currentQueryIndex=0}function Fn(e){K.lFrame.selectedIndex=e}let Bd=!0;function uo(){return Bd}function Mn(e){Bd=e}function co(e,t){for(let n=t.directiveStart,r=t.directiveEnd;n<r;n++){const c=e.data[n].type.prototype,{ngAfterContentInit:f,ngAfterContentChecked:g,ngAfterViewInit:y,ngAfterViewChecked:_,ngOnDestroy:C}=c;f&&(e.contentHooks??=[]).push(-n,f),g&&((e.contentHooks??=[]).push(n,g),(e.contentCheckHooks??=[]).push(n,g)),y&&(e.viewHooks??=[]).push(-n,y),_&&((e.viewHooks??=[]).push(n,_),(e.viewCheckHooks??=[]).push(n,_)),null!=C&&(e.destroyHooks??=[]).push(n,C)}}function fo(e,t,n){Hd(e,t,3,n)}function po(e,t,n,r){(3&e[ie])===n&&Hd(e,t,n,r)}function ba(e,t){let n=e[ie];(3&n)===t&&(n&=8191,n+=1,e[ie]=n)}function Hd(e,t,n,r){const c=r??-1,f=t.length-1;let g=0;for(let y=void 0!==r?65535&e[Jn]:0;y<f;y++)if("number"==typeof t[y+1]){if(g=t[y],null!=r&&g>=r)break}else t[y]<0&&(e[Jn]+=65536),(g<c||-1==c)&&(I_(e,n,t,y),e[Jn]=(4294901760&e[Jn])+y+2),y++}function Ud(e,t){Wt(4,e,t);const n=kt(null);try{t.call(e)}finally{kt(n),Wt(5,e,t)}}function I_(e,t,n,r){const o=n[r]<0,c=n[r+1],g=e[o?-n[r]:n[r]];o?e[ie]>>13<e[Jn]>>16&&(3&e[ie])===t&&(e[ie]+=8192,Ud(g,c)):Ud(g,c)}const ir=-1;class oi{constructor(t,n,r){this.factory=t,this.resolving=!1,this.canSeeViewProviders=n,this.injectImpl=r}}function si(e){return 32767&e}function ai(e,t){let n=function A_(e){return e>>16}(e),r=t;for(;n>0;)r=r[Qn],n--;return r}let Ea=!0;function ho(e){const t=Ea;return Ea=e,t}const Vd=255,$d=5;let x_=0;const Kt={};function go(e,t){const n=zd(e,t);if(-1!==n)return n;const r=t[U];r.firstCreatePass&&(e.injectorIndex=t.length,Sa(r.data,e),Sa(t,null),Sa(r.blueprint,null));const o=mo(e,t),c=e.injectorIndex;if(function wa(e){return e!==ir}(o)){const f=si(o),g=ai(o,t),y=g[U].data;for(let _=0;_<8;_++)t[c+_]=g[f+_]|y[f+_]}return t[c+8]=o,c}function Sa(e,t){e.push(0,0,0,0,0,0,0,0,t)}function zd(e,t){return-1===e.injectorIndex||e.parent&&e.parent.injectorIndex===e.injectorIndex||null===t[e.injectorIndex+8]?-1:e.injectorIndex}function mo(e,t){if(e.parent&&-1!==e.parent.injectorIndex)return e.parent.injectorIndex;let n=0,r=null,o=t;for(;null!==o;){if(r=Qd(o),null===r)return ir;if(n++,o=o[Qn],-1!==r.injectorIndex)return r.injectorIndex|n<<16}return ir}function Da(e,t,n){!function R_(e,t,n){let r;"string"==typeof n?r=n.charCodeAt(0)||0:n.hasOwnProperty(qr)&&(r=n[qr]),null==r&&(r=n[qr]=x_++);const o=r&Vd;t.data[e+(o>>$d)]|=1<<o}(e,t,n)}function Gd(e,t,n){if(n&ue.Optional||void 0!==e)return e;Gs()}function qd(e,t,n,r){if(n&ue.Optional&&void 0===r&&(r=null),!(n&(ue.Self|ue.Host))){const o=e[En],c=pt(void 0);try{return o?o.get(t,r,n&ue.Optional):Nc(t,r,n&ue.Optional)}finally{pt(c)}}return Gd(r,0,n)}function Wd(e,t,n,r=ue.Default,o){if(null!==e){if(2048&t[ie]&&!(r&ue.Self)){const f=function B_(e,t,n,r,o){let c=e,f=t;for(;null!==c&&null!==f&&2048&f[ie]&&!(512&f[ie]);){const g=Yd(c,f,n,r|ue.Self,Kt);if(g!==Kt)return g;let y=c.parent;if(!y){const _=f[Jc];if(_){const C=_.get(n,Kt,r);if(C!==Kt)return C}y=Qd(f),f=f[Qn]}c=y}return o}(e,t,n,r,Kt);if(f!==Kt)return f}const c=Yd(e,t,n,r,Kt);if(c!==Kt)return c}return qd(t,n,r,o)}function Yd(e,t,n,r,o){const c=function P_(e){if("string"==typeof e)return e.charCodeAt(0)||0;const t=e.hasOwnProperty(qr)?e[qr]:void 0;return"number"==typeof t?t>=0?t&Vd:F_:t}(n);if("function"==typeof c){if(!Nd(t,e,r))return r&ue.Host?Gd(o,0,r):qd(t,n,r,o);try{let f;if(f=c(r),null!=f||r&ue.Optional)return f;Gs()}finally{Fd()}}else if("number"==typeof c){let f=null,g=zd(e,t),y=ir,_=r&ue.Host?t[Ue][tt]:null;for((-1===g||r&ue.SkipSelf)&&(y=-1===g?mo(e,t):t[g+8],y!==ir&&Zd(r,!1)?(f=t[U],g=si(y),t=ai(y,t)):g=-1);-1!==g;){const C=t[U];if(Kd(c,g,C.data)){const E=O_(g,t,n,f,r,_);if(E!==Kt)return E}y=t[g+8],y!==ir&&Zd(r,t[U].data[g+8]===_)&&Kd(c,g,t)?(f=C,g=si(y),t=ai(y,t)):g=-1}}return o}function O_(e,t,n,r,o,c){const f=t[U],g=f.data[e+8],C=function vo(e,t,n,r,o){const c=e.providerIndexes,f=t.data,g=1048575&c,y=e.directiveStart,C=c>>20,D=o?g+C:e.directiveEnd;for(let I=r?g:g+C;I<D;I++){const T=f[I];if(I<y&&n===T||I>=y&&T.type===n)return I}if(o){const I=f[y];if(I&&Ft(I)&&I.type===n)return y}return null}(g,f,n,null==r?Pn(g)&&Ea:r!=f&&0!=(3&g.type),o&ue.Host&&c===g);return null!==C?jn(t,f,C,g):Kt}function jn(e,t,n,r){let o=e[n];const c=t.data;if(function M_(e){return e instanceof oi}(o)){const f=o;f.resolving&&function e0(e,t){const n=t?`. Dependency path: ${t.join(" > ")} > ${e}`:"";throw new V(-200,`Circular dependency in DI detected for ${e}${n}`)}(ye(c[n]));const g=ho(f.canSeeViewProviders);f.resolving=!0;const _=f.injectImpl?pt(f.injectImpl):null;Nd(e,r,ue.Default);try{o=e[n]=f.factory(void 0,c,e,r),t.firstCreatePass&&n>=r.directiveStart&&function D_(e,t,n){const{ngOnChanges:r,ngOnInit:o,ngDoCheck:c}=t.type.prototype;if(r){const f=md(t);(n.preOrderHooks??=[]).push(e,f),(n.preOrderCheckHooks??=[]).push(e,f)}o&&(n.preOrderHooks??=[]).push(0-e,o),c&&((n.preOrderHooks??=[]).push(e,c),(n.preOrderCheckHooks??=[]).push(e,c))}(n,c[n],t)}finally{null!==_&&pt(_),ho(g),f.resolving=!1,Fd()}}return o}function Kd(e,t,n){return!!(n[t+(e>>$d)]&1<<e)}function Zd(e,t){return!(e&ue.Self||e&ue.Host&&t)}class ut{constructor(t,n){this._tNode=t,this._lView=n}get(t,n,r){return Wd(this._tNode,this._lView,t,Xi(r),n)}}function F_(){return new ut(et(),O())}function Qd(e){const t=e[U],n=t.type;return 2===n?t.declTNode:1===n?e[tt]:null}function cr(e,t){e.forEach(n=>Array.isArray(n)?cr(n,t):t(n))}function yo(e,t){return t>=e.length-1?e.pop():e.splice(t,1)[0]}var Tn=function(e){return e[e.Important=1]="Important",e[e.DashCase=2]="DashCase",e}(Tn||{});const La=new Map;let mb=0;const ja="__ngContext__";function nt(e,t){gt(t)?(e[ja]=t[Xr],function yb(e){La.set(e[Xr],e)}(t)):e[ja]=t}let Ba;function Ha(e,t){return Ba(e,t)}function pi(e){const t=e[Ne];return st(t)?t[Ne]:t}function Cf(e){return Ef(e[Qr])}function wf(e){return Ef(e[Lt])}function Ef(e){for(;null!==e&&!st(e);)e=e[Lt];return e}function gr(e,t,n,r,o){if(null!=r){let c,f=!1;st(r)?c=r:gt(r)&&(f=!0,r=r[Fe]);const g=Me(r);0===e&&null!==n?null==o?Mf(t,n,g):Bn(t,n,g,o||null,!0):1===e&&null!==n?Bn(t,n,g,o||null,!0):2===e?function xo(e,t,n){const r=function ko(e,t){return e.parentNode(t)}(e,t);r&&function Fb(e,t,n,r){e.removeChild(t,n,r)}(e,r,t,n)}(t,g,f):3===e&&t.destroyNode(g),null!=c&&function Hb(e,t,n,r,o){const c=n[qt];c!==Me(n)&&gr(t,e,r,c,o);for(let g=Je;g<n.length;g++){const y=n[g];gi(y[U],y,e,t,r,c)}}(t,e,c,n,o)}}function Mo(e,t,n){return e.createElement(t,n)}function Df(e,t){const n=e[Xn],r=n.indexOf(t);Ed(t),n.splice(r,1)}function $a(e,t){if(!(256&t[ie])){t[ie]&=-129,t[ie]|=256,function Lb(e,t){let n;if(null!=e&&null!=(n=e.destroyHooks))for(let r=0;r<n.length;r+=2){const o=t[n[r]];if(!(o instanceof oi)){const c=n[r+1];if(Array.isArray(c))for(let f=0;f<c.length;f+=2){const g=o[c[f]],y=c[f+1];Wt(4,g,y);try{y.call(g)}finally{Wt(5,g,y)}}else{Wt(4,o,c);try{c.call(o)}finally{Wt(5,o,c)}}}}}(e,t),function Pb(e,t){const n=e.cleanup,r=t[Kn];if(null!==n)for(let c=0;c<n.length-1;c+=2)if("string"==typeof n[c]){const f=n[c+3];f>=0?r[f]():r[-f].unsubscribe(),c+=2}else n[c].call(r[n[c+1]]);null!==r&&(t[Kn]=null);const o=t[Sn];if(null!==o){t[Sn]=null;for(let c=0;c<o.length;c++)(0,o[c])()}}(e,t),1===t[U].type&&t[ee].destroy();const n=t[Jr];if(null!==n&&st(t[Ne])){n!==t[Ne]&&Df(n,t);const r=t[Gt];null!==r&&r.detachView(e)}!function _b(e){La.delete(e[Xr])}(t)}}function za(e,t,n){return function If(e,t,n){let r=t;for(;null!==r&&40&r.type;)r=(t=r).parent;if(null===r)return n[Fe];{const{componentOffset:o}=r;if(o>-1){const{encapsulation:c}=e.data[r.directiveStart+o];if(c===Ot.None||c===Ot.Emulated)return null}return mt(r,n)}}(e,t.parent,n)}function Bn(e,t,n,r,o){e.insertBefore(t,n,r,o)}function Mf(e,t,n){e.appendChild(t,n)}function Tf(e,t,n,r,o){null!==r?Bn(e,t,n,r,o):Mf(e,t,n)}let Ga,Ka,xf=function Af(e,t,n){return 40&e.type?mt(e,n):null};function Ao(e,t,n,r){const o=za(e,r,t),c=t[ee],g=function kf(e,t,n){return xf(e,t,n)}(r.parent||t[tt],r,t);if(null!=o)if(Array.isArray(n))for(let y=0;y<n.length;y++)Tf(c,o,n[y],g,!1);else Tf(c,o,n,g,!1);void 0!==Ga&&Ga(c,r,t,n,o)}function Nf(e,t){return null!==t?e[Ue][tt].projection[t.projection]:null}function Wa(e,t,n,r,o,c,f){for(;null!=n;){const g=r[n.index],y=n.type;if(f&&0===t&&(g&&nt(Me(g),r),n.flags|=2),32!=(32&n.flags))if(8&y)Wa(e,t,n.child,r,o,c,!1),gr(t,e,o,g,c);else if(32&y){const _=Ha(n,r);let C;for(;C=_();)gr(t,e,o,C,c);gr(t,e,o,g,c)}else 16&y?Pf(e,t,r,n,o,c):gr(t,e,o,g,c);n=f?n.projectionNext:n.next}}function gi(e,t,n,r,o,c){Wa(n,r,e.firstChild,t,o,c,!1)}function Pf(e,t,n,r,o,c){const f=n[Ue],y=f[tt].projection[r.projection];if(Array.isArray(y))for(let _=0;_<y.length;_++)gr(t,e,o,y[_],c);else{let _=y;const C=f[Ne];(function So(e){return 128==(128&e.flags)})(r)&&(_.flags|=128),Wa(e,t,_,C,o,c,!0)}}function Lf(e,t,n){""===n?e.removeAttribute(t,"class"):e.setAttribute(t,"class",n)}function Ff(e,t,n){const{mergedAttrs:r,classes:o,styles:c}=n;null!==r&&na(e,t,r),null!==o&&Lf(e,t,o),null!==c&&function Vb(e,t,n){e.setAttribute(t,"style",n)}(e,t,c)}class ne{constructor(t,n){this._desc=t,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof n?this.__NG_ELEMENT_ID__=n:void 0!==n&&(this.\u0275prov=Ee({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}const Po=new ne("ENVIRONMENT_INITIALIZER"),Zf=new ne("INJECTOR",-1),Qf=new ne("INJECTOR_DEF_TYPES");class tl{get(t,n=zr){if(n===zr){const r=new Error(`NullInjectorError: No provider for ${We(t)}!`);throw r.name="NullInjectorError",r}return n}}function mC(...e){return{\u0275providers:Xf(0,e),\u0275fromNgModule:!0}}function Xf(e,...t){const n=[],r=new Set;let o;const c=f=>{n.push(f)};return cr(t,f=>{const g=f;Lo(g,c,[],r)&&(o||=[],o.push(g))}),void 0!==o&&ep(o,c),n}function ep(e,t){for(let n=0;n<e.length;n++){const{ngModule:r,providers:o}=e[n];nl(o,c=>{t(c,r)})}}function Lo(e,t,n,r){if(!(e=Q(e)))return!1;let o=null,c=Zi(e);const f=!c&&de(e);if(c||f){if(f&&!f.standalone)return!1;o=e}else{const y=e.ngModule;if(c=Zi(y),!c)return!1;o=y}const g=r.has(o);if(f){if(g)return!1;if(r.add(o),f.dependencies){const y="function"==typeof f.dependencies?f.dependencies():f.dependencies;for(const _ of y)Lo(_,t,n,r)}}else{if(!c)return!1;{if(null!=c.imports&&!g){let _;r.add(o);try{cr(c.imports,C=>{Lo(C,t,n,r)&&(_||=[],_.push(C))})}finally{}void 0!==_&&ep(_,t)}if(!g){const _=Ln(o)||(()=>new o);t({provide:o,useFactory:_,deps:pe},o),t({provide:Qf,useValue:o,multi:!0},o),t({provide:Po,useValue:()=>ce(o),multi:!0},o)}const y=c.providers;if(null!=y&&!g){const _=e;nl(y,C=>{t(C,_)})}}}return o!==e&&void 0!==e.providers}function nl(e,t){for(let n of e)zs(n)&&(n=n.\u0275providers),Array.isArray(n)?nl(n,t):t(n)}const vC=_e({provide:String,useValue:_e});function rl(e){return null!==e&&"object"==typeof e&&vC in e}function Hn(e){return"function"==typeof e}const il=new ne("Set Injector scope."),Fo={},_C={};let ol;function jo(){return void 0===ol&&(ol=new tl),ol}class cn{}class Bo extends cn{get destroyed(){return this._destroyed}constructor(t,n,r,o){super(),this.parent=n,this.source=r,this.scopes=o,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,al(t,f=>this.processProvider(f)),this.records.set(Zf,_r(void 0,this)),o.has("environment")&&this.records.set(cn,_r(void 0,this));const c=this.records.get(il);null!=c&&"string"==typeof c.value&&this.scopes.add(c.value),this.injectorDefTypes=new Set(this.get(Qf.multi,pe,ue.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const n of this._ngOnDestroyHooks)n.ngOnDestroy();const t=this._onDestroyHooks;this._onDestroyHooks=[];for(const n of t)n()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear()}}onDestroy(t){return this.assertNotDestroyed(),this._onDestroyHooks.push(t),()=>this.removeOnDestroy(t)}runInContext(t){this.assertNotDestroyed();const n=wn(this),r=pt(void 0);try{return t()}finally{wn(n),pt(r)}}get(t,n=zr,r=ue.Default){if(this.assertNotDestroyed(),t.hasOwnProperty(jc))return t[jc](this);r=Xi(r);const c=wn(this),f=pt(void 0);try{if(!(r&ue.SkipSelf)){let y=this.records.get(t);if(void 0===y){const _=function SC(e){return"function"==typeof e||"object"==typeof e&&e instanceof ne}(t)&&Ki(t);y=_&&this.injectableDefInScope(_)?_r(sl(t),Fo):null,this.records.set(t,y)}if(null!=y)return this.hydrate(t,y)}return(r&ue.Self?jo():this.parent).get(t,n=r&ue.Optional&&n===zr?null:n)}catch(g){if("NullInjectorError"===g.name){if((g[Ji]=g[Ji]||[]).unshift(We(t)),c)throw g;return function g0(e,t,n,r){const o=e[Ji];throw t[Pc]&&o.unshift(t[Pc]),e.message=function m0(e,t,n,r=null){e=e&&"\n"===e.charAt(0)&&"\u0275"==e.charAt(1)?e.slice(2):e;let o=We(t);if(Array.isArray(t))o=t.map(We).join(" -> ");else if("object"==typeof t){let c=[];for(let f in t)if(t.hasOwnProperty(f)){let g=t[f];c.push(f+":"+("string"==typeof g?JSON.stringify(g):We(g)))}o=`{${c.join(", ")}}`}return`${n}${r?"("+r+")":""}[${o}]: ${e.replace(c0,"\n  ")}`}("\n"+e.message,o,n,r),e.ngTokenPath=o,e[Ji]=null,e}(g,t,"R3InjectorError",this.source)}throw g}finally{pt(f),wn(c)}}resolveInjectorInitializers(){const t=wn(this),n=pt(void 0);try{const o=this.get(Po.multi,pe,ue.Self);for(const c of o)c()}finally{wn(t),pt(n)}}toString(){const t=[],n=this.records;for(const r of n.keys())t.push(We(r));return`R3Injector[${t.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new V(205,!1)}processProvider(t){let n=Hn(t=Q(t))?t:Q(t&&t.provide);const r=function CC(e){return rl(e)?_r(void 0,e.useValue):_r(function rp(e,t,n){let r;if(Hn(e)){const o=Q(e);return Ln(o)||sl(o)}if(rl(e))r=()=>Q(e.useValue);else if(function np(e){return!(!e||!e.useFactory)}(e))r=()=>e.useFactory(...Xs(e.deps||[]));else if(function tp(e){return!(!e||!e.useExisting)}(e))r=()=>ce(Q(e.useExisting));else{const o=Q(e&&(e.useClass||e.provide));if(!function wC(e){return!!e.deps}(e))return Ln(o)||sl(o);r=()=>new o(...Xs(e.deps))}return r}(e),Fo)}(t);if(Hn(t)||!0!==t.multi)this.records.get(n);else{let o=this.records.get(n);o||(o=_r(void 0,Fo,!0),o.factory=()=>Xs(o.multi),this.records.set(n,o)),n=t,o.multi.push(t)}this.records.set(n,r)}hydrate(t,n){return n.value===Fo&&(n.value=_C,n.value=n.factory()),"object"==typeof n.value&&n.value&&function EC(e){return null!==e&&"object"==typeof e&&"function"==typeof e.ngOnDestroy}(n.value)&&this._ngOnDestroyHooks.add(n.value),n.value}injectableDefInScope(t){if(!t.providedIn)return!1;const n=Q(t.providedIn);return"string"==typeof n?"any"===n||this.scopes.has(n):this.injectorDefTypes.has(n)}removeOnDestroy(t){const n=this._onDestroyHooks.indexOf(t);-1!==n&&this._onDestroyHooks.splice(n,1)}}function sl(e){const t=Ki(e),n=null!==t?t.factory:Ln(e);if(null!==n)return n;if(e instanceof ne)throw new V(204,!1);if(e instanceof Function)return function bC(e){const t=e.length;if(t>0)throw function ci(e,t){const n=[];for(let r=0;r<e;r++)n.push(t);return n}(t,"?"),new V(204,!1);const n=function s0(e){return e&&(e[Qi]||e[xc])||null}(e);return null!==n?()=>n.factory(e):()=>new e}(e);throw new V(204,!1)}function _r(e,t,n=!1){return{factory:e,value:t,multi:n?[]:void 0}}function al(e,t){for(const n of e)Array.isArray(n)?al(n,t):n&&zs(n)?al(n.\u0275providers,t):t(n)}const Ho=new ne("AppId",{providedIn:"root",factory:()=>DC}),DC="ng",ip=new ne("Platform Initializer"),br=new ne("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),op=new ne("CSP nonce",{providedIn:"root",factory:()=>function vr(){if(void 0!==Ka)return Ka;if(typeof document<"u")return document;throw new V(210,!1)}().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});let sp=(e,t,n)=>null;function gl(e,t,n=!1){return sp(e,t,n)}class PC{}class up{}class FC{resolveComponentFactory(t){throw function LC(e){const t=Error(`No component factory found for ${We(e)}.`);return t.ngComponent=e,t}(t)}}let qo=(()=>{class e{static#e=this.NULL=new FC}return e})();function jC(){return Er(et(),O())}function Er(e,t){return new Sr(mt(e,t))}let Sr=(()=>{class e{constructor(n){this.nativeElement=n}static#e=this.__NG_ELEMENT_ID__=jC}return e})();class dp{}let UC=(()=>{class e{static#e=this.\u0275prov=Ee({token:e,providedIn:"root",factory:()=>null})}return e})();class yl{constructor(t){this.full=t,this.major=t.split(".")[0],this.minor=t.split(".")[1],this.patch=t.split(".").slice(2).join(".")}}const VC=new yl("16.2.7"),_l={};function mp(e,t=null,n=null,r){const o=vp(e,t,n,r);return o.resolveInjectorInitializers(),o}function vp(e,t=null,n=null,r,o=new Set){const c=[n||pe,mC(e)];return r=r||("object"==typeof e?void 0:We(e)),new Bo(c,t||jo(),r||null,o)}let Zt=(()=>{class e{static#e=this.THROW_IF_NOT_FOUND=zr;static#t=this.NULL=new tl;static create(n,r){if(Array.isArray(n))return mp({name:""},r,n,"");{const o=n.name??"";return mp({name:o},n.parent,n.providers,o)}}static#n=this.\u0275prov=Ee({token:e,providedIn:"any",factory:()=>ce(Zf)});static#r=this.__NG_ELEMENT_ID__=-1}return e})();function Cl(e){return e.ngOriginalError}class dn{constructor(){this._console=console}handleError(t){const n=this._findOriginalError(t);this._console.error("ERROR",t),n&&this._console.error("ORIGINAL ERROR",n)}_findOriginalError(t){let n=t&&Cl(t);for(;n&&Cl(n);)n=Cl(n);return n||null}}function El(e){return t=>{setTimeout(e,void 0,t)}}const fn=class KC extends qe{constructor(t=!1){super(),this.__isAsync=t}emit(t){super.next(t)}subscribe(t,n,r){let o=t,c=n||(()=>null),f=r;if(t&&"object"==typeof t){const y=t;o=y.next?.bind(y),c=y.error?.bind(y),f=y.complete?.bind(y)}this.__isAsync&&(c=El(c),o&&(o=El(o)),f&&(f=El(f)));const g=super.subscribe({next:o,error:c,complete:f});return t instanceof m&&t.add(g),g}};function _p(...e){}class je{constructor({enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:n=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new fn(!1),this.onMicrotaskEmpty=new fn(!1),this.onStable=new fn(!1),this.onError=new fn(!1),typeof Zone>"u")throw new V(908,!1);Zone.assertZonePatched();const o=this;o._nesting=0,o._outer=o._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(o._inner=o._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(o._inner=o._inner.fork(Zone.longStackTraceZoneSpec)),o.shouldCoalesceEventChangeDetection=!r&&n,o.shouldCoalesceRunChangeDetection=r,o.lastRequestAnimationFrameId=-1,o.nativeRequestAnimationFrame=function ZC(){const e="function"==typeof De.requestAnimationFrame;let t=De[e?"requestAnimationFrame":"setTimeout"],n=De[e?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&t&&n){const r=t[Zone.__symbol__("OriginalDelegate")];r&&(t=r);const o=n[Zone.__symbol__("OriginalDelegate")];o&&(n=o)}return{nativeRequestAnimationFrame:t,nativeCancelAnimationFrame:n}}().nativeRequestAnimationFrame,function XC(e){const t=()=>{!function JC(e){e.isCheckStableRunning||-1!==e.lastRequestAnimationFrameId||(e.lastRequestAnimationFrameId=e.nativeRequestAnimationFrame.call(De,()=>{e.fakeTopEventTask||(e.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{e.lastRequestAnimationFrameId=-1,Dl(e),e.isCheckStableRunning=!0,Sl(e),e.isCheckStableRunning=!1},void 0,()=>{},()=>{})),e.fakeTopEventTask.invoke()}),Dl(e))}(e)};e._inner=e._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(n,r,o,c,f,g)=>{if(function t1(e){return!(!Array.isArray(e)||1!==e.length)&&!0===e[0].data?.__ignore_ng_zone__}(g))return n.invokeTask(o,c,f,g);try{return bp(e),n.invokeTask(o,c,f,g)}finally{(e.shouldCoalesceEventChangeDetection&&"eventTask"===c.type||e.shouldCoalesceRunChangeDetection)&&t(),Cp(e)}},onInvoke:(n,r,o,c,f,g,y)=>{try{return bp(e),n.invoke(o,c,f,g,y)}finally{e.shouldCoalesceRunChangeDetection&&t(),Cp(e)}},onHasTask:(n,r,o,c)=>{n.hasTask(o,c),r===o&&("microTask"==c.change?(e._hasPendingMicrotasks=c.microTask,Dl(e),Sl(e)):"macroTask"==c.change&&(e.hasPendingMacrotasks=c.macroTask))},onHandleError:(n,r,o,c)=>(n.handleError(o,c),e.runOutsideAngular(()=>e.onError.emit(c)),!1)})}(o)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!je.isInAngularZone())throw new V(909,!1)}static assertNotInAngularZone(){if(je.isInAngularZone())throw new V(909,!1)}run(t,n,r){return this._inner.run(t,n,r)}runTask(t,n,r,o){const c=this._inner,f=c.scheduleEventTask("NgZoneEvent: "+o,t,QC,_p,_p);try{return c.runTask(f,n,r)}finally{c.cancelTask(f)}}runGuarded(t,n,r){return this._inner.runGuarded(t,n,r)}runOutsideAngular(t){return this._outer.run(t)}}const QC={};function Sl(e){if(0==e._nesting&&!e.hasPendingMicrotasks&&!e.isStable)try{e._nesting++,e.onMicrotaskEmpty.emit(null)}finally{if(e._nesting--,!e.hasPendingMicrotasks)try{e.runOutsideAngular(()=>e.onStable.emit(null))}finally{e.isStable=!0}}}function Dl(e){e.hasPendingMicrotasks=!!(e._hasPendingMicrotasks||(e.shouldCoalesceEventChangeDetection||e.shouldCoalesceRunChangeDetection)&&-1!==e.lastRequestAnimationFrameId)}function bp(e){e._nesting++,e.isStable&&(e.isStable=!1,e.onUnstable.emit(null))}function Cp(e){e._nesting--,Sl(e)}class e1{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new fn,this.onMicrotaskEmpty=new fn,this.onStable=new fn,this.onError=new fn}run(t,n,r){return t.apply(n,r)}runGuarded(t,n,r){return t.apply(n,r)}runOutsideAngular(t){return t()}runTask(t,n,r,o){return t.apply(n,r)}}const wp=new ne("",{providedIn:"root",factory:Ep});function Ep(){const e=Ie(je);let t=!0;return Wy(new $(o=>{t=e.isStable&&!e.hasPendingMacrotasks&&!e.hasPendingMicrotasks,e.runOutsideAngular(()=>{o.next(t),o.complete()})}),new $(o=>{let c;e.runOutsideAngular(()=>{c=e.onStable.subscribe(()=>{je.assertNotInAngularZone(),queueMicrotask(()=>{!t&&!e.hasPendingMacrotasks&&!e.hasPendingMicrotasks&&(t=!0,o.next(!0))})})});const f=e.onUnstable.subscribe(()=>{je.assertInAngularZone(),t&&(t=!1,e.runOutsideAngular(()=>{o.next(!1)}))});return()=>{c.unsubscribe(),f.unsubscribe()}}).pipe(Tc()))}let Il=(()=>{class e{constructor(){this.renderDepth=0,this.handler=null}begin(){this.handler?.validateBegin(),this.renderDepth++}end(){this.renderDepth--,0===this.renderDepth&&this.handler?.execute()}ngOnDestroy(){this.handler?.destroy(),this.handler=null}static#e=this.\u0275prov=Ee({token:e,providedIn:"root",factory:()=>new e})}return e})();function Ci(e){for(;e;){e[ie]|=64;const t=pi(e);if(oa(e)&&!t)return e;e=t}return null}const Tp=new ne("",{providedIn:"root",factory:()=>!1});let Yo=null;function Rp(e,t){return e[t]??Pp()}function Np(e,t){const n=Pp();n.producerNode?.length&&(e[t]=Yo,n.lView=e,Yo=Op())}const d1={...nd,consumerIsAlwaysLive:!0,consumerMarkedDirty:e=>{Ci(e.lView)},lView:null};function Op(){return Object.create(d1)}function Pp(){return Yo??=Op(),Yo}const re={};function se(e,t=ue.Default){const n=O();return null===n?ce(e,t):Wd(et(),n,Q(e),t)}function Ko(e,t,n,r,o,c,f,g,y,_,C){const E=t.blueprint.slice();return E[Fe]=o,E[ie]=140|r,(null!==_||e&&2048&e[ie])&&(E[ie]|=2048),wd(E),E[Ne]=E[Qn]=e,E[He]=n,E[Zn]=f||e&&e[Zn],E[ee]=g||e&&e[ee],E[En]=y||e&&e[En]||null,E[tt]=c,E[Xr]=function vb(){return mb++}(),E[sn]=C,E[Jc]=_,E[Ue]=2==t.type?e[Ue]:E,E}function Mr(e,t,n,r,o){let c=e.data[t];if(null===c)c=function Ml(e,t,n,r,o){const c=Td(),f=pa(),y=e.data[t]=function C1(e,t,n,r,o,c){let f=t?t.injectorIndex:-1,g=0;return function nr(){return null!==K.skipHydrationRootTNode}()&&(g|=128),{type:n,index:r,insertBeforeIndex:null,injectorIndex:f,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:g,providerIndexes:0,value:o,attrs:c,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:t,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,f?c:c&&c.parent,n,t,r,o);return null===e.firstChild&&(e.firstChild=y),null!==c&&(f?null==c.child&&null!==y.parent&&(c.child=y):null===c.next&&(c.next=y,y.prev=c)),y}(e,t,n,r,o),function g_(){return K.lFrame.inI18n}()&&(c.flags|=32);else if(64&c.type){c.type=n,c.value=r,c.attrs=o;const f=function ii(){const e=K.lFrame,t=e.currentTNode;return e.isParent?t:t.parent}();c.injectorIndex=null===f?-1:f.injectorIndex}return Yt(c,!0),c}function wi(e,t,n,r){if(0===n)return-1;const o=t.length;for(let c=0;c<n;c++)t.push(r),e.blueprint.push(r),e.data.push(null);return o}function Fp(e,t,n,r,o){const c=Rp(t,ei),f=function lt(){return K.lFrame.selectedIndex}(),g=2&r;try{Fn(-1),g&&t.length>ae&&function Lp(e,t,n,r){if(!r)if(3==(3&t[ie])){const c=e.preOrderCheckHooks;null!==c&&fo(t,c,n)}else{const c=e.preOrderHooks;null!==c&&po(t,c,0,n)}Fn(n)}(e,t,ae,!1),Wt(g?2:0,o);const _=g?c:null,C=aa(_);try{null!==_&&(_.dirty=!1),n(r,o)}finally{la(_,C)}}finally{g&&null===t[ei]&&Np(t,ei),Fn(f),Wt(g?3:1,o)}}function Tl(e,t,n){if(ia(t)){const r=kt(null);try{const c=t.directiveEnd;for(let f=t.directiveStart;f<c;f++){const g=e.data[f];g.contentQueries&&g.contentQueries(1,n[f],f)}}finally{kt(r)}}}function jp(e){const t=e.tView;return null===t||t.incompleteFirstPass?e.tView=xl(1,null,e.template,e.decls,e.vars,e.directiveDefs,e.pipeDefs,e.viewQuery,e.schemas,e.consts,e.id):t}function xl(e,t,n,r,o,c,f,g,y,_,C){const E=ae+r,D=E+o,I=function g1(e,t){const n=[];for(let r=0;r<t;r++)n.push(r<e?null:re);return n}(E,D),T="function"==typeof _?_():_;return I[U]={type:e,blueprint:I,template:n,queries:null,viewQuery:g,declTNode:t,data:I.slice().fill(null,E),bindingStartIndex:E,expandoStartIndex:D,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof c?c():c,pipeRegistry:"function"==typeof f?f():f,firstChild:null,schemas:y,consts:T,incompleteFirstPass:!1,ssrId:C}}let Bp=e=>null;function Hp(e,t,n,r){for(let o in e)if(e.hasOwnProperty(o)){n=null===n?{}:n;const c=e[o];null===r?Up(n,t,o,c):r.hasOwnProperty(o)&&Up(n,t,r[o],c)}return n}function Up(e,t,n,r){e.hasOwnProperty(n)?e[n].push(t,r):e[n]=[t,r]}function Vp(e,t,n,r,o,c){for(let _=0;_<r.length;_++)Da(go(n,t),e,r[_].type);!function N1(e,t,n){e.flags|=1,e.directiveStart=t,e.directiveEnd=t+n,e.providerIndexes=t}(n,e.data.length,r.length);for(let _=0;_<r.length;_++){const C=r[_];C.providersResolver&&C.providersResolver(C)}let f=!1,g=!1,y=wi(e,t,r.length,null);for(let _=0;_<r.length;_++){const C=r[_];n.mergedAttrs=Wr(n.mergedAttrs,C.hostAttrs),O1(e,n,t,y,C),R1(y,C,o),null!==C.contentQueries&&(n.flags|=4),(null!==C.hostBindings||null!==C.hostAttrs||0!==C.hostVars)&&(n.flags|=64);const E=C.type.prototype;!f&&(E.ngOnChanges||E.ngOnInit||E.ngDoCheck)&&((e.preOrderHooks??=[]).push(n.index),f=!0),!g&&(E.ngOnChanges||E.ngDoCheck)&&((e.preOrderCheckHooks??=[]).push(n.index),g=!0),y++}!function w1(e,t,n){const o=t.directiveEnd,c=e.data,f=t.attrs,g=[];let y=null,_=null;for(let C=t.directiveStart;C<o;C++){const E=c[C],D=n?n.get(E):null,T=D?D.outputs:null;y=Hp(E.inputs,C,y,D?D.inputs:null),_=Hp(E.outputs,C,_,T);const x=null===y||null===f||zc(t)?null:F1(y,C,f);g.push(x)}null!==y&&(y.hasOwnProperty("class")&&(t.flags|=8),y.hasOwnProperty("style")&&(t.flags|=16)),t.initialInputs=g,t.inputs=y,t.outputs=_}(e,n,c)}function $p(e,t,n){const r=n.directiveStart,o=n.directiveEnd,c=n.index,f=function v_(){return K.lFrame.currentDirectiveIndex}();try{Fn(c);for(let g=r;g<o;g++){const y=e.data[g],_=t[g];ga(g),(null!==y.hostBindings||0!==y.hostVars||null!==y.hostAttrs)&&k1(y,_)}}finally{Fn(-1),ga(f)}}function k1(e,t){null!==e.hostBindings&&e.hostBindings(1,t)}function Nl(e,t,n){t.componentOffset=n,(e.components??=[]).push(t.index)}function R1(e,t,n){if(n){if(t.exportAs)for(let r=0;r<t.exportAs.length;r++)n[t.exportAs[r]]=e;Ft(t)&&(n[""]=e)}}function O1(e,t,n,r,o){e.data[r]=o;const c=o.factory||(o.factory=Ln(o.type)),f=new oi(c,Ft(o),se);e.blueprint[r]=f,n[r]=f,function I1(e,t,n,r,o){const c=o.hostBindings;if(c){let f=e.hostBindingOpCodes;null===f&&(f=e.hostBindingOpCodes=[]);const g=~t.index;(function M1(e){let t=e.length;for(;t>0;){const n=e[--t];if("number"==typeof n&&n<0)return n}return 0})(f)!=g&&f.push(g),f.push(n,r,c)}}(e,t,r,wi(e,n,o.hostVars,re),o)}function L1(e,t,n,r,o,c){const f=c[t];if(null!==f)for(let g=0;g<f.length;)zp(r,n,f[g++],f[g++],f[g++])}function zp(e,t,n,r,o){const c=kt(null);try{const f=e.inputTransforms;null!==f&&f.hasOwnProperty(r)&&(o=f[r].call(t,o)),null!==e.setInput?e.setInput(t,o,n,r):t[r]=o}finally{kt(c)}}function F1(e,t,n){let r=null,o=0;for(;o<n.length;){const c=n[o];if(0!==c)if(5!==c){if("number"==typeof c)break;if(e.hasOwnProperty(c)){null===r&&(r=[]);const f=e[c];for(let g=0;g<f.length;g+=2)if(f[g]===t){r.push(c,f[g+1],n[o+1]);break}}o+=2}else o+=2;else o+=4}return r}function qp(e,t){const n=e.contentQueries;if(null!==n)for(let r=0;r<n.length;r+=2){const c=n[r+1];if(-1!==c){const f=e.data[c];va(n[r]),f.contentQueries(2,t[c],c)}}}function Zo(e,t){return e[Qr]?e[Qc][Lt]=t:e[Qr]=t,e[Qc]=t,t}function Pl(e,t,n){va(0);const r=kt(null);try{t(e,n)}finally{kt(r)}}function Ll(e,t,n,r,o){for(let c=0;c<n.length;){const f=n[c++],g=n[c++];zp(e.data[f],t[f],r,g,o)}}function j1(e,t){const n=Et(t,e),r=n[U];!function B1(e,t){for(let n=t.length;n<e.blueprint.length;n++)t.push(e.blueprint[n])}(r,n);const o=n[Fe];null!==o&&null===n[sn]&&(n[sn]=gl(o,n[En])),Fl(r,n,n[He])}function Fl(e,t,n){ya(t);try{const r=e.viewQuery;null!==r&&Pl(1,r,n);const o=e.template;null!==o&&Fp(e,t,o,1,n),e.firstCreatePass&&(e.firstCreatePass=!1),e.staticContentQueries&&qp(e,t),e.staticViewQueries&&Pl(2,e.viewQuery,n);const c=e.components;null!==c&&function H1(e,t){for(let n=0;n<t.length;n++)j1(e,t[n])}(t,c)}catch(r){throw e.firstCreatePass&&(e.incompleteFirstPass=!0,e.firstCreatePass=!1),r}finally{t[ie]&=-5,_a()}}let Qp=(()=>{class e{constructor(){this.all=new Set,this.queue=new Map}create(n,r,o){const c=typeof Zone>"u"?null:Zone.current,f=function G0(e,t,n){const r=Object.create(q0);n&&(r.consumerAllowSignalWrites=!0),r.fn=e,r.schedule=t;const o=f=>{r.cleanupFn=f};return r.ref={notify:()=>sd(r),run:()=>{if(r.dirty=!1,r.hasRun&&!ad(r))return;r.hasRun=!0;const f=aa(r);try{r.cleanupFn(),r.cleanupFn=gd,r.fn(o)}finally{la(r,f)}},cleanup:()=>r.cleanupFn()},r.ref}(n,_=>{this.all.has(_)&&this.queue.set(_,c)},o);let g;this.all.add(f),f.notify();const y=()=>{f.cleanup(),g?.(),this.all.delete(f),this.queue.delete(f)};return g=r?.onDestroy(y),{destroy:y}}flush(){if(0!==this.queue.size)for(const[n,r]of this.queue)this.queue.delete(n),r?r.run(()=>n.run()):n.run()}get isQueueEmpty(){return 0===this.queue.size}static#e=this.\u0275prov=Ee({token:e,providedIn:"root",factory:()=>new e})}return e})();function Qo(e,t,n){let r=n?e.styles:null,o=n?e.classes:null,c=0;if(null!==t)for(let f=0;f<t.length;f++){const g=t[f];"number"==typeof g?c=g:1==c?o=Us(o,g):2==c&&(r=Us(r,g+": "+t[++f]+";"))}n?e.styles=r:e.stylesWithoutHost=r,n?e.classes=o:e.classesWithoutHost=o}function Ei(e,t,n,r,o=!1){for(;null!==n;){const c=t[n.index];null!==c&&r.push(Me(c)),st(c)&&Jp(c,r);const f=n.type;if(8&f)Ei(e,t,n.child,r);else if(32&f){const g=Ha(n,t);let y;for(;y=g();)r.push(y)}else if(16&f){const g=Nf(t,n);if(Array.isArray(g))r.push(...g);else{const y=pi(t[Ue]);Ei(y[U],y,g,r,!0)}}n=o?n.projectionNext:n.next}return r}function Jp(e,t){for(let n=Je;n<e.length;n++){const r=e[n],o=r[U].firstChild;null!==o&&Ei(r[U],r,o,t)}e[qt]!==e[Fe]&&t.push(e[qt])}function Jo(e,t,n,r=!0){const o=t[Zn],c=o.rendererFactory,f=o.afterRenderEventManager;c.begin?.(),f?.begin();try{Xp(e,t,e.template,n)}catch(y){throw r&&function Zp(e,t){const n=e[En],r=n?n.get(dn,null):null;r&&r.handleError(t)}(t,y),y}finally{c.end?.(),o.effectManager?.flush(),f?.end()}}function Xp(e,t,n,r){const o=t[ie];if(256!=(256&o)){t[Zn].effectManager?.flush(),ya(t);try{wd(t),function Ad(e){return K.lFrame.bindingIndex=e}(e.bindingStartIndex),null!==n&&Fp(e,t,n,2,r);const f=3==(3&o);if(f){const _=e.preOrderCheckHooks;null!==_&&fo(t,_,null)}else{const _=e.preOrderHooks;null!==_&&po(t,_,0,null),ba(t,0)}if(function $1(e){for(let t=Cf(e);null!==t;t=wf(t)){if(!t[Xc])continue;const n=t[Xn];for(let r=0;r<n.length;r++){n_(n[r])}}}(t),eh(t,2),null!==e.contentQueries&&qp(e,t),f){const _=e.contentCheckHooks;null!==_&&fo(t,_)}else{const _=e.contentHooks;null!==_&&po(t,_,1),ba(t,1)}!function h1(e,t){const n=e.hostBindingOpCodes;if(null===n)return;const r=Rp(t,ti);try{for(let o=0;o<n.length;o++){const c=n[o];if(c<0)Fn(~c);else{const f=c,g=n[++o],y=n[++o];m_(g,f),r.dirty=!1;const _=aa(r);try{y(2,t[f])}finally{la(r,_)}}}}finally{null===t[ti]&&Np(t,ti),Fn(-1)}}(e,t);const g=e.components;null!==g&&nh(t,g,0);const y=e.viewQuery;if(null!==y&&Pl(2,y,r),f){const _=e.viewCheckHooks;null!==_&&fo(t,_)}else{const _=e.viewHooks;null!==_&&po(t,_,2),ba(t,2)}!0===e.firstUpdatePass&&(e.firstUpdatePass=!1),t[ie]&=-73,Ed(t)}finally{_a()}}}function eh(e,t){for(let n=Cf(e);null!==n;n=wf(n))for(let r=Je;r<n.length;r++)th(n[r],t)}function z1(e,t,n){th(Et(t,e),n)}function th(e,t){if(!function e_(e){return 128==(128&e[ie])}(e))return;const n=e[U],r=e[ie];if(80&r&&0===t||1024&r||2===t)Xp(n,e,n.template,e[He]);else if(e[Zr]>0){eh(e,1);const o=n.components;null!==o&&nh(e,o,1)}}function nh(e,t,n){for(let r=0;r<t.length;r++)z1(e,t[r],n)}class Si{get rootNodes(){const t=this._lView,n=t[U];return Ei(n,t,n.firstChild,[])}constructor(t,n){this._lView=t,this._cdRefInjectingView=n,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[He]}set context(t){this._lView[He]=t}get destroyed(){return 256==(256&this._lView[ie])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const t=this._lView[Ne];if(st(t)){const n=t[8],r=n?n.indexOf(this):-1;r>-1&&(function To(e,t){if(e.length<=Je)return;const n=Je+t,r=e[n];if(r){const o=r[Jr];null!==o&&o!==e&&Df(o,r),t>0&&(e[n-1][Lt]=r[Lt]);const c=yo(e,Je+t);!function kb(e,t){gi(e,t,t[ee],2,null,null),t[Fe]=null,t[tt]=null}(r[U],r);const f=c[Gt];null!==f&&f.detachView(c[U]),r[Ne]=null,r[Lt]=null,r[ie]&=-129}return r}(t,r),yo(n,r))}this._attachedToViewContainer=!1}!function Va(e,t){if(!(256&t[ie])){const n=t[ee];t[ei]&&ld(t[ei]),t[ti]&&ld(t[ti]),n.destroyNode&&gi(e,t,n,3,null,null),function Rb(e){let t=e[Qr];if(!t)return $a(e[U],e);for(;t;){let n=null;if(gt(t))n=t[Qr];else{const r=t[Je];r&&(n=r)}if(!n){for(;t&&!t[Lt]&&t!==e;)gt(t)&&$a(t[U],t),t=t[Ne];null===t&&(t=e),gt(t)&&$a(t[U],t),n=t&&t[Lt]}t=n}}(t)}}(this._lView[U],this._lView)}onDestroy(t){!function Dd(e,t){if(256==(256&e[ie]))throw new V(911,!1);null===e[Sn]&&(e[Sn]=[]),e[Sn].push(t)}(this._lView,t)}markForCheck(){Ci(this._cdRefInjectingView||this._lView)}detach(){this._lView[ie]&=-129}reattach(){this._lView[ie]|=128}detectChanges(){Jo(this._lView[U],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new V(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function xb(e,t){gi(e,t,t[ee],2,null,null)}(this._lView[U],this._lView)}attachToAppRef(t){if(this._attachedToViewContainer)throw new V(902,!1);this._appRef=t}}class G1 extends Si{constructor(t){super(t),this._view=t}detectChanges(){const t=this._view;Jo(t[U],t,t[He],!1)}checkNoChanges(){}get context(){return null}}class rh extends qo{constructor(t){super(),this.ngModule=t}resolveComponentFactory(t){const n=de(t);return new Di(n,this.ngModule)}}function ih(e){const t=[];for(let n in e)e.hasOwnProperty(n)&&t.push({propName:e[n],templateName:n});return t}class W1{constructor(t,n){this.injector=t,this.parentInjector=n}get(t,n,r){r=Xi(r);const o=this.injector.get(t,_l,r);return o!==_l||n===_l?o:this.parentInjector.get(t,n,r)}}class Di extends up{get inputs(){const t=this.componentDef,n=t.inputTransforms,r=ih(t.inputs);if(null!==n)for(const o of r)n.hasOwnProperty(o.propName)&&(o.transform=n[o.propName]);return r}get outputs(){return ih(this.componentDef.outputs)}constructor(t,n){super(),this.componentDef=t,this.ngModule=n,this.componentType=t.type,this.selector=function I0(e){return e.map(D0).join(",")}(t.selectors),this.ngContentSelectors=t.ngContentSelectors?t.ngContentSelectors:[],this.isBoundToModule=!!n}create(t,n,r,o){let c=(o=o||this.ngModule)instanceof cn?o:o?.injector;c&&null!==this.componentDef.getStandaloneInjector&&(c=this.componentDef.getStandaloneInjector(c)||c);const f=c?new W1(t,c):t,g=f.get(dp,null);if(null===g)throw new V(407,!1);const E={rendererFactory:g,sanitizer:f.get(UC,null),effectManager:f.get(Qp,null),afterRenderEventManager:f.get(Il,null)},D=g.createRenderer(null,this.componentDef),I=this.componentDef.selectors[0][0]||"div",T=r?function m1(e,t,n,r){const c=r.get(Tp,!1)||n===Ot.ShadowDom,f=e.selectRootElement(t,c);return function v1(e){Bp(e)}(f),f}(D,r,this.componentDef.encapsulation,f):Mo(D,I,function q1(e){const t=e.toLowerCase();return"svg"===t?"svg":"math"===t?"math":null}(I)),F=this.componentDef.signals?4608:this.componentDef.onPush?576:528;let R=null;null!==T&&(R=gl(T,f,!0));const q=xl(0,null,null,1,0,null,null,null,null,null,null),Z=Ko(null,q,null,F,null,null,E,D,f,null,R);let le,bt;ya(Z);try{const _n=this.componentDef;let $r,sc=null;_n.findHostDirectiveDefs?($r=[],sc=new Map,_n.findHostDirectiveDefs(_n,$r,sc),$r.push(_n)):$r=[_n];const Vk=function K1(e,t){const n=e[U],r=ae;return e[r]=t,Mr(n,r,2,"#host",null)}(Z,T),$k=function Z1(e,t,n,r,o,c,f){const g=o[U];!function Q1(e,t,n,r){for(const o of e)t.mergedAttrs=Wr(t.mergedAttrs,o.hostAttrs);null!==t.mergedAttrs&&(Qo(t,t.mergedAttrs,!0),null!==n&&Ff(r,n,t))}(r,e,t,f);let y=null;null!==t&&(y=gl(t,o[En]));const _=c.rendererFactory.createRenderer(t,n);let C=16;n.signals?C=4096:n.onPush&&(C=64);const E=Ko(o,jp(n),null,C,o[e.index],e,c,_,null,null,y);return g.firstCreatePass&&Nl(g,e,r.length-1),Zo(o,E),o[e.index]=E}(Vk,T,_n,$r,Z,E,D);bt=function Cd(e,t){return e.data[t]}(q,ae),T&&function X1(e,t,n,r){if(r)na(e,n,["ng-version",VC.full]);else{const{attrs:o,classes:c}=function M0(e){const t=[],n=[];let r=1,o=2;for(;r<e.length;){let c=e[r];if("string"==typeof c)2===o?""!==c&&t.push(c,e[++r]):8===o&&n.push(c);else{if(!Pt(o))break;o=c}r++}return{attrs:t,classes:n}}(t.selectors[0]);o&&na(e,n,o),c&&c.length>0&&Lf(e,n,c.join(" "))}}(D,_n,T,r),void 0!==n&&function ew(e,t,n){const r=e.projection=[];for(let o=0;o<t.length;o++){const c=n[o];r.push(null!=c?Array.from(c):null)}}(bt,this.ngContentSelectors,n),le=function J1(e,t,n,r,o,c){const f=et(),g=o[U],y=mt(f,o);Vp(g,o,f,n,null,r);for(let C=0;C<n.length;C++)nt(jn(o,g,f.directiveStart+C,f),o);$p(g,o,f),y&&nt(y,o);const _=jn(o,g,f.directiveStart+f.componentOffset,f);if(e[He]=o[He]=_,null!==c)for(const C of c)C(_,t);return Tl(g,f,e),_}($k,_n,$r,sc,Z,[tw]),Fl(q,Z,null)}finally{_a()}return new Y1(this.componentType,le,Er(bt,Z),Z,bt)}}class Y1 extends PC{constructor(t,n,r,o,c){super(),this.location=r,this._rootLView=o,this._tNode=c,this.previousInputValues=null,this.instance=n,this.hostView=this.changeDetectorRef=new G1(o),this.componentType=t}setInput(t,n){const r=this._tNode.inputs;let o;if(null!==r&&(o=r[t])){if(this.previousInputValues??=new Map,this.previousInputValues.has(t)&&Object.is(this.previousInputValues.get(t),n))return;const c=this._rootLView;Ll(c[U],c,o,t,n),this.previousInputValues.set(t,n),Ci(Et(this._tNode.index,c))}}get injector(){return new ut(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(t){this.hostView.onDestroy(t)}}function tw(){const e=et();co(O()[U],e)}function zl(e,t,n,r,o){const f=o?"class":"style";Ll(e,n,t.inputs[f],f,r)}function os(e,t,n,r){const o=O(),c=fe(),f=ae+e,g=o[ee],y=c.firstCreatePass?function Fw(e,t,n,r,o,c){const f=t.consts,y=Mr(t,e,2,r,In(f,o));return function Rl(e,t,n,r){if(Md()){const o=null===r?null:{"":-1},c=function A1(e,t){const n=e.directiveRegistry;let r=null,o=null;if(n)for(let c=0;c<n.length;c++){const f=n[c];if(Gc(t,f.selectors,!1))if(r||(r=[]),Ft(f))if(null!==f.findHostDirectiveDefs){const g=[];o=o||new Map,f.findHostDirectiveDefs(f,g,o),r.unshift(...g,f),Nl(e,t,g.length)}else r.unshift(f),Nl(e,t,0);else o=o||new Map,f.findHostDirectiveDefs?.(f,r,o),r.push(f)}return null===r?null:[r,o]}(e,n);let f,g;null===c?f=g=null:[f,g]=c,null!==f&&Vp(e,t,n,f,o,g),o&&function x1(e,t,n){if(t){const r=e.localNames=[];for(let o=0;o<t.length;o+=2){const c=n[t[o+1]];if(null==c)throw new V(-301,!1);r.push(t[o],c)}}}(n,r,o)}n.mergedAttrs=Wr(n.mergedAttrs,n.attrs)}(t,n,y,In(f,c)),null!==y.attrs&&Qo(y,y.attrs,!1),null!==y.mergedAttrs&&Qo(y,y.mergedAttrs,!0),null!==t.queries&&t.queries.elementStart(t,y),y}(f,c,o,t,n,r):c.data[f],_=Ih(c,o,y,g,t,e);o[f]=_;const C=function io(e){return 1==(1&e.flags)}(y);return Yt(y,!0),Ff(g,_,y),32!=(32&y.flags)&&uo()&&Ao(c,o,_,y),0===function i_(){return K.lFrame.elementDepthCount}()&&nt(_,o),function o_(){K.lFrame.elementDepthCount++}(),C&&(function kl(e,t,n){Md()&&(function T1(e,t,n,r){const o=n.directiveStart,c=n.directiveEnd;Pn(n)&&function P1(e,t,n){const r=mt(t,e),o=jp(n);let f=16;n.signals?f=4096:n.onPush&&(f=64);const g=Zo(e,Ko(e,o,null,f,r,t,null,e[Zn].rendererFactory.createRenderer(r,n),null,null,null));e[t.index]=g}(t,n,e.data[o+n.componentOffset]),e.firstCreatePass||go(n,t),nt(r,t);const f=n.initialInputs;for(let g=o;g<c;g++){const y=e.data[g],_=jn(t,e,g,n);nt(_,t),null!==f&&L1(0,g-o,_,y,0,f),Ft(y)&&(Et(n.index,t)[He]=jn(t,e,g,n))}}(e,t,n,mt(n,t)),64==(64&n.flags)&&$p(e,t,n))}(c,o,y),Tl(c,y,o)),null!==r&&function Al(e,t,n=mt){const r=t.localNames;if(null!==r){let o=t.index+1;for(let c=0;c<r.length;c+=2){const f=r[c+1],g=-1===f?n(t,e):e[f];e[o++]=g}}}(o,y),os}function Ai(){let e=et();pa()?function ha(){K.lFrame.isParent=!1}():(e=e.parent,Yt(e,!1));const t=e;(function a_(e){return K.skipHydrationRootTNode===e})(t)&&function d_(){K.skipHydrationRootTNode=null}(),function s_(){K.lFrame.elementDepthCount--}();const n=fe();return n.firstCreatePass&&(co(n,e),ia(e)&&n.queries.elementEnd(e)),null!=t.classesWithoutHost&&function T_(e){return 0!=(8&e.flags)}(t)&&zl(n,t,O(),t.classesWithoutHost,!0),null!=t.stylesWithoutHost&&function k_(e){return 0!=(16&e.flags)}(t)&&zl(n,t,O(),t.stylesWithoutHost,!1),Ai}function Gl(e,t,n,r){return os(e,t,n,r),Ai(),Gl}let Ih=(e,t,n,r,o,c)=>(Mn(!0),Mo(r,o,function jd(){return K.lFrame.currentNamespace}()));function Yl(e){return!!e&&"function"==typeof e.then}function kh(e){return!!e&&"function"==typeof e.subscribe}let sg=(e,t,n,r,o)=>(Mn(!0),function Io(e,t){return e.createText(t)}(t[ee],r));const Br="en-US";let kg=Br;class zn{}class BS{}class au extends zn{constructor(t,n,r){super(),this._parent=n,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new rh(this);const o=function wt(e,t){const n=e[Fc]||null;if(!n&&!0===t)throw new Error(`Type ${We(e)} does not have '\u0275mod' property.`);return n}(t);this._bootstrapComponents=function pn(e){return e instanceof Function?e():e}(o.bootstrap),this._r3Injector=vp(t,n,[{provide:zn,useValue:this},{provide:qo,useValue:this.componentFactoryResolver},...r],We(t),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(t)}get injector(){return this._r3Injector}destroy(){const t=this._r3Injector;!t.destroyed&&t.destroy(),this.destroyCbs.forEach(n=>n()),this.destroyCbs=null}onDestroy(t){this.destroyCbs.push(t)}}class lu extends BS{constructor(t){super(),this.moduleType=t}create(t){return new au(this.moduleType,t,[])}}Symbol;const uI=new ne("Application Initializer");let Cu=(()=>{class e{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((n,r)=>{this.resolve=n,this.reject=r}),this.appInits=Ie(uI,{optional:!0})??[]}runInitializers(){if(this.initialized)return;const n=[];for(const o of this.appInits){const c=o();if(Yl(c))n.push(c);else if(kh(c)){const f=new Promise((g,y)=>{c.subscribe({complete:g,error:y})});n.push(f)}}const r=()=>{this.done=!0,this.resolve()};Promise.all(n).then(()=>{r()}).catch(o=>{this.reject(o)}),0===n.length&&r(),this.initialized=!0}static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275prov=Ee({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const mn=new ne("LocaleId",{providedIn:"root",factory:()=>Ie(mn,ue.Optional|ue.SkipSelf)||function dI(){return typeof $localize<"u"&&$localize.locale||Br}()});let hI=(()=>{class e{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new Yy(!1)}add(){this.hasPendingTasks.next(!0);const n=this.taskId++;return this.pendingTasks.add(n),n}remove(n){this.pendingTasks.delete(n),0===this.pendingTasks.size&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks.next(!1)}static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275prov=Ee({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const Wm=new ne(""),ms=new ne("");let Iu,Su=(()=>{class e{constructor(n,r,o){this._ngZone=n,this.registry=r,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,Iu||(function PI(e){Iu=e}(o),o.addToWindow(r)),this._watchAngularEvents(),n.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{je.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;0!==this._callbacks.length;){let n=this._callbacks.pop();clearTimeout(n.timeoutId),n.doneCb(this._didWork)}this._didWork=!1});else{let n=this.getPendingTasks();this._callbacks=this._callbacks.filter(r=>!r.updateCb||!r.updateCb(n)||(clearTimeout(r.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(n=>({source:n.source,creationLocation:n.creationLocation,data:n.data})):[]}addCallback(n,r,o){let c=-1;r&&r>0&&(c=setTimeout(()=>{this._callbacks=this._callbacks.filter(f=>f.timeoutId!==c),n(this._didWork,this.getPendingTasks())},r)),this._callbacks.push({doneCb:n,timeoutId:c,updateCb:o})}whenStable(n,r,o){if(o&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(n,r,o),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(n){this.registry.registerApplication(n,this)}unregisterApplication(n){this.registry.unregisterApplication(n)}findProviders(n,r,o){return[]}static#e=this.\u0275fac=function(r){return new(r||e)(ce(je),ce(Du),ce(ms))};static#t=this.\u0275prov=Ee({token:e,factory:e.\u0275fac})}return e})(),Du=(()=>{class e{constructor(){this._applications=new Map}registerApplication(n,r){this._applications.set(n,r)}unregisterApplication(n){this._applications.delete(n)}unregisterAllApplications(){this._applications.clear()}getTestability(n){return this._applications.get(n)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(n,r=!0){return Iu?.findTestabilityInTree(this,n,r)??null}static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275prov=Ee({token:e,factory:e.\u0275fac,providedIn:"platform"})}return e})(),xn=null;const Ym=new ne("AllowMultipleToken"),Mu=new ne("PlatformDestroyListeners"),Km=new ne("appBootstrapListener");function Jm(e,t,n=[]){const r=`Platform: ${t}`,o=new ne(r);return(c=[])=>{let f=Tu();if(!f||f.injector.get(Ym,!1)){const g=[...n,...c,{provide:o,useValue:!0}];e?e(g):function jI(e){if(xn&&!xn.get(Ym,!1))throw new V(400,!1);(function Zm(){!function H0(e){dd=e}(()=>{throw new V(600,!1)})})(),xn=e;const t=e.get(ev);(function Qm(e){e.get(ip,null)?.forEach(n=>n())})(e)}(function Xm(e=[],t){return Zt.create({name:t,providers:[{provide:il,useValue:"platform"},{provide:Mu,useValue:new Set([()=>xn=null])},...e]})}(g,r))}return function HI(e){const t=Tu();if(!t)throw new V(401,!1);return t}()}}function Tu(){return xn?.get(ev)??null}let ev=(()=>{class e{constructor(n){this._injector=n,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(n,r){const o=function UI(e="zone.js",t){return"noop"===e?new e1:"zone.js"===e?new je(t):e}(r?.ngZone,function tv(e){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:e?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:e?.runCoalescing??!1}}({eventCoalescing:r?.ngZoneEventCoalescing,runCoalescing:r?.ngZoneRunCoalescing}));return o.run(()=>{const c=function US(e,t,n){return new au(e,t,n)}(n.moduleType,this.injector,function sv(e){return[{provide:je,useFactory:e},{provide:Po,multi:!0,useFactory:()=>{const t=Ie($I,{optional:!0});return()=>t.initialize()}},{provide:ov,useFactory:VI},{provide:wp,useFactory:Ep}]}(()=>o)),f=c.injector.get(dn,null);return o.runOutsideAngular(()=>{const g=o.onError.subscribe({next:y=>{f.handleError(y)}});c.onDestroy(()=>{vs(this._modules,c),g.unsubscribe()})}),function nv(e,t,n){try{const r=n();return Yl(r)?r.catch(o=>{throw t.runOutsideAngular(()=>e.handleError(o)),o}):r}catch(r){throw t.runOutsideAngular(()=>e.handleError(r)),r}}(f,o,()=>{const g=c.injector.get(Cu);return g.runInitializers(),g.donePromise.then(()=>(function Ag(e){Mt(e,"Expected localeId to be defined"),"string"==typeof e&&(kg=e.toLowerCase().replace(/_/g,"-"))}(c.injector.get(mn,Br)||Br),this._moduleDoBootstrap(c),c))})})}bootstrapModule(n,r=[]){const o=rv({},r);return function LI(e,t,n){const r=new lu(n);return Promise.resolve(r)}(0,0,n).then(c=>this.bootstrapModuleFactory(c,o))}_moduleDoBootstrap(n){const r=n.injector.get(Ui);if(n._bootstrapComponents.length>0)n._bootstrapComponents.forEach(o=>r.bootstrap(o));else{if(!n.instance.ngDoBootstrap)throw new V(-403,!1);n.instance.ngDoBootstrap(r)}this._modules.push(n)}onDestroy(n){this._destroyListeners.push(n)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new V(404,!1);this._modules.slice().forEach(r=>r.destroy()),this._destroyListeners.forEach(r=>r());const n=this._injector.get(Mu,null);n&&(n.forEach(r=>r()),n.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}static#e=this.\u0275fac=function(r){return new(r||e)(ce(Zt))};static#t=this.\u0275prov=Ee({token:e,factory:e.\u0275fac,providedIn:"platform"})}return e})();function rv(e,t){return Array.isArray(t)?t.reduce(rv,e):{...e,...t}}let Ui=(()=>{class e{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=Ie(ov),this.zoneIsStable=Ie(wp),this.componentTypes=[],this.components=[],this.isStable=Ie(hI).hasPendingTasks.pipe(function Zy(e,t){return it((n,r)=>{let o=null,c=0,f=!1;const g=()=>f&&!o&&r.complete();n.subscribe(Nn(r,y=>{o?.unsubscribe();let _=0;const C=c++;nn(e(y,C)).subscribe(o=Nn(r,E=>r.next(t?t(y,E,C,_++):E),()=>{o=null,g()}))},()=>{f=!0,g()}))})}(n=>n?function Ky(...e){return Mc(e,Ec(e))}(!1):this.zoneIsStable),function Qy(e,t=H){return e=e??Jy,it((n,r)=>{let o,c=!0;n.subscribe(Nn(r,f=>{const g=t(f);(c||!e(o,g))&&(c=!1,o=g,r.next(f))}))})}(),Tc()),this._injector=Ie(cn)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(n,r){const o=n instanceof up;if(!this._injector.get(Cu).done)throw!o&&function Kr(e){const t=de(e)||Qe(e)||ot(e);return null!==t&&t.standalone}(n),new V(405,!1);let f;f=o?n:this._injector.get(qo).resolveComponentFactory(n),this.componentTypes.push(f.componentType);const g=function FI(e){return e.isBoundToModule}(f)?void 0:this._injector.get(zn),_=f.create(Zt.NULL,[],r||f.selector,g),C=_.location.nativeElement,E=_.injector.get(Wm,null);return E?.registerApplication(C),_.onDestroy(()=>{this.detachView(_.hostView),vs(this.components,_),E?.unregisterApplication(C)}),this._loadComponent(_),_}tick(){if(this._runningTick)throw new V(101,!1);try{this._runningTick=!0;for(let n of this._views)n.detectChanges()}catch(n){this.internalErrorHandler(n)}finally{this._runningTick=!1}}attachView(n){const r=n;this._views.push(r),r.attachToAppRef(this)}detachView(n){const r=n;vs(this._views,r),r.detachFromAppRef()}_loadComponent(n){this.attachView(n.hostView),this.tick(),this.components.push(n);const r=this._injector.get(Km,[]);r.push(...this._bootstrapListeners),r.forEach(o=>o(n))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(n=>n()),this._views.slice().forEach(n=>n.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(n){return this._destroyListeners.push(n),()=>vs(this._destroyListeners,n)}destroy(){if(this._destroyed)throw new V(406,!1);const n=this._injector;n.destroy&&!n.destroyed&&n.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275prov=Ee({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function vs(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}const ov=new ne("",{providedIn:"root",factory:()=>Ie(dn).handleError.bind(void 0)});function VI(){const e=Ie(je),t=Ie(dn);return n=>e.runOutsideAngular(()=>t.handleError(n))}let $I=(()=>{class e{constructor(){this.zone=Ie(je),this.applicationRef=Ie(Ui)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275prov=Ee({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const sM=Jm(null,"core",[]);let aM=(()=>{class e{constructor(n){}static#e=this.\u0275fac=function(r){return new(r||e)(ce(Ui))};static#t=this.\u0275mod=Yr({type:e});static#n=this.\u0275inj=Wn({})}return e})(),Ou=null;function Pu(){return Ou}class bM{}const qn=new ne("DocumentToken");let FT=(()=>{class e{static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275mod=Yr({type:e});static#n=this.\u0275inj=Wn({})}return e})();function Bv(e){return"server"===e}class dk extends bM{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class Ju extends dk{static makeCurrent(){!function _M(e){Ou||(Ou=e)}(new Ju)}onAndCancel(t,n,r){return t.addEventListener(n,r),()=>{t.removeEventListener(n,r)}}dispatchEvent(t,n){t.dispatchEvent(n)}remove(t){t.parentNode&&t.parentNode.removeChild(t)}createElement(t,n){return(n=n||this.getDefaultDocument()).createElement(t)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}isShadowRoot(t){return t instanceof DocumentFragment}getGlobalEventTarget(t,n){return"window"===n?window:"document"===n?t:"body"===n?t.body:null}getBaseHref(t){const n=function fk(){return qi=qi||document.querySelector("base"),qi?qi.getAttribute("href"):null}();return null==n?null:function pk(e){Os=Os||document.createElement("a"),Os.setAttribute("href",e);const t=Os.pathname;return"/"===t.charAt(0)?t:`/${t}`}(n)}resetBaseElement(){qi=null}getUserAgent(){return window.navigator.userAgent}getCookie(t){return function sT(e,t){t=encodeURIComponent(t);for(const n of e.split(";")){const r=n.indexOf("="),[o,c]=-1==r?[n,""]:[n.slice(0,r),n.slice(r+1)];if(o.trim()===t)return decodeURIComponent(c)}return null}(document.cookie,t)}}let Os,qi=null,gk=(()=>{class e{build(){return new XMLHttpRequest}static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275prov=Ee({token:e,factory:e.\u0275fac})}return e})();const Xu=new ne("EventManagerPlugins");let zv=(()=>{class e{constructor(n,r){this._zone=r,this._eventNameToPlugin=new Map,n.forEach(o=>{o.manager=this}),this._plugins=n.slice().reverse()}addEventListener(n,r,o){return this._findPluginFor(r).addEventListener(n,r,o)}getZone(){return this._zone}_findPluginFor(n){let r=this._eventNameToPlugin.get(n);if(r)return r;if(r=this._plugins.find(c=>c.supports(n)),!r)throw new V(5101,!1);return this._eventNameToPlugin.set(n,r),r}static#e=this.\u0275fac=function(r){return new(r||e)(ce(Xu),ce(je))};static#t=this.\u0275prov=Ee({token:e,factory:e.\u0275fac})}return e})();class Gv{constructor(t){this._doc=t}}const ec="ng-app-id";let qv=(()=>{class e{constructor(n,r,o,c={}){this.doc=n,this.appId=r,this.nonce=o,this.platformId=c,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=Bv(c),this.resetHostNodes()}addStyles(n){for(const r of n)1===this.changeUsageCount(r,1)&&this.onStyleAdded(r)}removeStyles(n){for(const r of n)this.changeUsageCount(r,-1)<=0&&this.onStyleRemoved(r)}ngOnDestroy(){const n=this.styleNodesInDOM;n&&(n.forEach(r=>r.remove()),n.clear());for(const r of this.getAllStyles())this.onStyleRemoved(r);this.resetHostNodes()}addHost(n){this.hostNodes.add(n);for(const r of this.getAllStyles())this.addStyleToHost(n,r)}removeHost(n){this.hostNodes.delete(n)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(n){for(const r of this.hostNodes)this.addStyleToHost(r,n)}onStyleRemoved(n){const r=this.styleRef;r.get(n)?.elements?.forEach(o=>o.remove()),r.delete(n)}collectServerRenderedStyles(){const n=this.doc.head?.querySelectorAll(`style[${ec}="${this.appId}"]`);if(n?.length){const r=new Map;return n.forEach(o=>{null!=o.textContent&&r.set(o.textContent,o)}),r}return null}changeUsageCount(n,r){const o=this.styleRef;if(o.has(n)){const c=o.get(n);return c.usage+=r,c.usage}return o.set(n,{usage:r,elements:[]}),r}getStyleElement(n,r){const o=this.styleNodesInDOM,c=o?.get(r);if(c?.parentNode===n)return o.delete(r),c.removeAttribute(ec),c;{const f=this.doc.createElement("style");return this.nonce&&f.setAttribute("nonce",this.nonce),f.textContent=r,this.platformIsServer&&f.setAttribute(ec,this.appId),f}}addStyleToHost(n,r){const o=this.getStyleElement(n,r);n.appendChild(o);const c=this.styleRef,f=c.get(r)?.elements;f?f.push(o):c.set(r,{elements:[o],usage:1})}resetHostNodes(){const n=this.hostNodes;n.clear(),n.add(this.doc.head)}static#e=this.\u0275fac=function(r){return new(r||e)(ce(qn),ce(Ho),ce(op,8),ce(br))};static#t=this.\u0275prov=Ee({token:e,factory:e.\u0275fac})}return e})();const tc={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},nc=/%COMP%/g,_k=new ne("RemoveStylesOnCompDestroy",{providedIn:"root",factory:()=>!1});function Yv(e,t){return t.map(n=>n.replace(nc,e))}let Kv=(()=>{class e{constructor(n,r,o,c,f,g,y,_=null){this.eventManager=n,this.sharedStylesHost=r,this.appId=o,this.removeStylesOnCompDestroy=c,this.doc=f,this.platformId=g,this.ngZone=y,this.nonce=_,this.rendererByCompId=new Map,this.platformIsServer=Bv(g),this.defaultRenderer=new rc(n,f,y,this.platformIsServer)}createRenderer(n,r){if(!n||!r)return this.defaultRenderer;this.platformIsServer&&r.encapsulation===Ot.ShadowDom&&(r={...r,encapsulation:Ot.Emulated});const o=this.getOrCreateRenderer(n,r);return o instanceof Qv?o.applyToHost(n):o instanceof ic&&o.applyStyles(),o}getOrCreateRenderer(n,r){const o=this.rendererByCompId;let c=o.get(r.id);if(!c){const f=this.doc,g=this.ngZone,y=this.eventManager,_=this.sharedStylesHost,C=this.removeStylesOnCompDestroy,E=this.platformIsServer;switch(r.encapsulation){case Ot.Emulated:c=new Qv(y,_,r,this.appId,C,f,g,E);break;case Ot.ShadowDom:return new Ek(y,_,n,r,f,g,this.nonce,E);default:c=new ic(y,_,r,C,f,g,E)}o.set(r.id,c)}return c}ngOnDestroy(){this.rendererByCompId.clear()}static#e=this.\u0275fac=function(r){return new(r||e)(ce(zv),ce(qv),ce(Ho),ce(_k),ce(qn),ce(br),ce(je),ce(op))};static#t=this.\u0275prov=Ee({token:e,factory:e.\u0275fac})}return e})();class rc{constructor(t,n,r,o){this.eventManager=t,this.doc=n,this.ngZone=r,this.platformIsServer=o,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(t,n){return n?this.doc.createElementNS(tc[n]||n,t):this.doc.createElement(t)}createComment(t){return this.doc.createComment(t)}createText(t){return this.doc.createTextNode(t)}appendChild(t,n){(Zv(t)?t.content:t).appendChild(n)}insertBefore(t,n,r){t&&(Zv(t)?t.content:t).insertBefore(n,r)}removeChild(t,n){t&&t.removeChild(n)}selectRootElement(t,n){let r="string"==typeof t?this.doc.querySelector(t):t;if(!r)throw new V(-5104,!1);return n||(r.textContent=""),r}parentNode(t){return t.parentNode}nextSibling(t){return t.nextSibling}setAttribute(t,n,r,o){if(o){n=o+":"+n;const c=tc[o];c?t.setAttributeNS(c,n,r):t.setAttribute(n,r)}else t.setAttribute(n,r)}removeAttribute(t,n,r){if(r){const o=tc[r];o?t.removeAttributeNS(o,n):t.removeAttribute(`${r}:${n}`)}else t.removeAttribute(n)}addClass(t,n){t.classList.add(n)}removeClass(t,n){t.classList.remove(n)}setStyle(t,n,r,o){o&(Tn.DashCase|Tn.Important)?t.style.setProperty(n,r,o&Tn.Important?"important":""):t.style[n]=r}removeStyle(t,n,r){r&Tn.DashCase?t.style.removeProperty(n):t.style[n]=""}setProperty(t,n,r){t[n]=r}setValue(t,n){t.nodeValue=n}listen(t,n,r){if("string"==typeof t&&!(t=Pu().getGlobalEventTarget(this.doc,t)))throw new Error(`Unsupported event target ${t} for event ${n}`);return this.eventManager.addEventListener(t,n,this.decoratePreventDefault(r))}decoratePreventDefault(t){return n=>{if("__ngUnwrap__"===n)return t;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>t(n)):t(n))&&n.preventDefault()}}}function Zv(e){return"TEMPLATE"===e.tagName&&void 0!==e.content}class Ek extends rc{constructor(t,n,r,o,c,f,g,y){super(t,c,f,y),this.sharedStylesHost=n,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const _=Yv(o.id,o.styles);for(const C of _){const E=document.createElement("style");g&&E.setAttribute("nonce",g),E.textContent=C,this.shadowRoot.appendChild(E)}}nodeOrShadowRoot(t){return t===this.hostEl?this.shadowRoot:t}appendChild(t,n){return super.appendChild(this.nodeOrShadowRoot(t),n)}insertBefore(t,n,r){return super.insertBefore(this.nodeOrShadowRoot(t),n,r)}removeChild(t,n){return super.removeChild(this.nodeOrShadowRoot(t),n)}parentNode(t){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(t)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class ic extends rc{constructor(t,n,r,o,c,f,g,y){super(t,c,f,g),this.sharedStylesHost=n,this.removeStylesOnCompDestroy=o,this.styles=y?Yv(y,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}}class Qv extends ic{constructor(t,n,r,o,c,f,g,y){const _=o+"-"+r.id;super(t,n,r,c,f,g,y,_),this.contentAttr=function bk(e){return"_ngcontent-%COMP%".replace(nc,e)}(_),this.hostAttr=function Ck(e){return"_nghost-%COMP%".replace(nc,e)}(_)}applyToHost(t){this.applyStyles(),this.setAttribute(t,this.hostAttr,"")}createElement(t,n){const r=super.createElement(t,n);return super.setAttribute(r,this.contentAttr,""),r}}let Sk=(()=>{class e extends Gv{constructor(n){super(n)}supports(n){return!0}addEventListener(n,r,o){return n.addEventListener(r,o,!1),()=>this.removeEventListener(n,r,o)}removeEventListener(n,r,o){return n.removeEventListener(r,o)}static#e=this.\u0275fac=function(r){return new(r||e)(ce(qn))};static#t=this.\u0275prov=Ee({token:e,factory:e.\u0275fac})}return e})();const Jv=["alt","control","meta","shift"],Dk={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Ik={alt:e=>e.altKey,control:e=>e.ctrlKey,meta:e=>e.metaKey,shift:e=>e.shiftKey};let Mk=(()=>{class e extends Gv{constructor(n){super(n)}supports(n){return null!=e.parseEventName(n)}addEventListener(n,r,o){const c=e.parseEventName(r),f=e.eventCallback(c.fullKey,o,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Pu().onAndCancel(n,c.domEventName,f))}static parseEventName(n){const r=n.toLowerCase().split("."),o=r.shift();if(0===r.length||"keydown"!==o&&"keyup"!==o)return null;const c=e._normalizeKey(r.pop());let f="",g=r.indexOf("code");if(g>-1&&(r.splice(g,1),f="code."),Jv.forEach(_=>{const C=r.indexOf(_);C>-1&&(r.splice(C,1),f+=_+".")}),f+=c,0!=r.length||0===c.length)return null;const y={};return y.domEventName=o,y.fullKey=f,y}static matchEventFullKeyCode(n,r){let o=Dk[n.key]||n.key,c="";return r.indexOf("code.")>-1&&(o=n.code,c="code."),!(null==o||!o)&&(o=o.toLowerCase()," "===o?o="space":"."===o&&(o="dot"),Jv.forEach(f=>{f!==o&&(0,Ik[f])(n)&&(c+=f+".")}),c+=o,c===r)}static eventCallback(n,r,o){return c=>{e.matchEventFullKeyCode(c,n)&&o.runGuarded(()=>r(c))}}static _normalizeKey(n){return"esc"===n?"escape":n}static#e=this.\u0275fac=function(r){return new(r||e)(ce(qn))};static#t=this.\u0275prov=Ee({token:e,factory:e.\u0275fac})}return e})();const xk=Jm(sM,"browser",[{provide:br,useValue:"browser"},{provide:ip,useValue:function Tk(){Ju.makeCurrent()},multi:!0},{provide:qn,useFactory:function Ak(){return function qb(e){Ka=e}(document),document},deps:[]}]),Rk=new ne(""),ty=[{provide:ms,useClass:class hk{addToWindow(t){De.getAngularTestability=(r,o=!0)=>{const c=t.findTestabilityInTree(r,o);if(null==c)throw new V(5103,!1);return c},De.getAllAngularTestabilities=()=>t.getAllTestabilities(),De.getAllAngularRootElements=()=>t.getAllRootElements(),De.frameworkStabilizers||(De.frameworkStabilizers=[]),De.frameworkStabilizers.push(r=>{const o=De.getAllAngularTestabilities();let c=o.length,f=!1;const g=function(y){f=f||y,c--,0==c&&r(f)};o.forEach(y=>{y.whenStable(g)})})}findTestabilityInTree(t,n,r){return null==n?null:t.getTestability(n)??(r?Pu().isShadowRoot(n)?this.findTestabilityInTree(t,n.host,!0):this.findTestabilityInTree(t,n.parentElement,!0):null)}},deps:[]},{provide:Wm,useClass:Su,deps:[je,Du,ms]},{provide:Su,useClass:Su,deps:[je,Du,ms]}],ny=[{provide:il,useValue:"root"},{provide:dn,useFactory:function kk(){return new dn},deps:[]},{provide:Xu,useClass:Sk,multi:!0,deps:[qn,je,br]},{provide:Xu,useClass:Mk,multi:!0,deps:[qn]},Kv,qv,zv,{provide:dp,useExisting:Kv},{provide:class VT{},useClass:gk,deps:[]},[]];let Nk=(()=>{class e{constructor(n){}static withServerTransition(n){return{ngModule:e,providers:[{provide:Ho,useValue:n.appId}]}}static#e=this.\u0275fac=function(r){return new(r||e)(ce(Rk,12))};static#t=this.\u0275mod=Yr({type:e});static#n=this.\u0275inj=Wn({providers:[...ny,...ty],imports:[FT,aM]})}return e})();typeof window<"u"&&window,s(809);let Hk=(()=>{class e{constructor(){this.title="angular-app",this.initialMessages=[{role:"ai",text:"How can i help you today?"}]}static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275cmp=Wc({type:e,selectors:[["app-root"]],decls:4,vars:0,consts:[["containerStyle",'{\n\t\t\t"borderRadius": "10px",\n\t\t\t"width": "96vw",\n\t\t\t"height": "calc(100vh - 70px)",\n\t\t\t"paddingTop": "10px",\n\t\t\t"background":\n      "linear-gradient(90deg, rgb(239, 242, 247) 0%, 7.60286%, rgb(237, 240, 249) 15.2057%, 20.7513%, rgb(235, 239, 248) 26.297%, 27.6386%, rgb(235, 239, 248) 28.9803%, 38.2826%, rgb(231, 237, 249) 47.585%, 48.1216%, rgb(230, 236, 250) 48.6583%, 53.1306%, rgb(228, 236, 249) 57.6029%, 61.5385%, rgb(227, 234, 250) 65.4741%, 68.7835%, rgb(222, 234, 250) 72.093%, 75.7603%, rgb(219, 230, 248) 79.4275%, 82.8265%, rgb(216, 229, 248) 86.2254%, 87.8354%, rgb(213, 228, 249) 89.4454%, 91.8605%, rgb(210, 226, 249) 94.2755%, 95.4383%, rgb(209, 225, 248) 96.6011%, 98.3005%, rgb(208, 224, 247) 100%)"\n\t\t}',"textInput",'{\n\t\t\t"styles": {\n\t\t\t"container": {\n\t\t\t\t"borderRadius": "20px",\n\t\t\t\t"border": "unset",\n\t\t\t\t"width": "78%",\n\t\t\t\t"marginLeft": "-15px",\n\t\t\t\t"boxShadow": "0px 0.3px 0.9px rgba(0, 0, 0, 0.12), 0px 1.6px 3.6px rgba(0, 0, 0, 0.16)"\n\t\t\t},\n\t\t\t"text": {"padding": "10px", "paddingLeft": "15px", "paddingRight": "34px"}\n\t\t\t},\n\t\t\t"placeholder": {"text": "Ask me anything...", "style": {"color": "#606060"}}\n\t\t}',"messageStyles",'{\n\t\t\t"default": {\n\t\t\t"shared": {\n\t\t\t\t"bubble": {\n\t\t\t\t"backgroundColor": "unset",\n\t\t\t\t"marginTop": "10px",\n\t\t\t\t"marginBottom": "10px",\n\t\t\t\t"boxShadow": "0px 0.3px 0.9px rgba(0, 0, 0, 0.12), 0px 1.6px 3.6px rgba(0, 0, 0, 0.16)"\n\t\t\t\t}\n\t\t\t},\n\t\t\t"user": {\n\t\t\t\t"bubble": {\n\t\t\t\t"background": "linear-gradient(130deg, #2870EA 20%, #1B4AEF 77.5%)"\n\t\t\t\t}\n\t\t\t},\n\t\t\t"ai": {"bubble": {"background": "rgba(255,255,255,0.7)"}}\n\t\t\t}\n\t\t}',"avatars",'{\n\t\t\t"default": {\n\t\t\t\t"styles": {"position": "right", "container": {"marginLeft": "12px", "marginRight": "5px"}}\n\t\t\t\t},\n\t\t\t"ai": {"src": "path-to-icon.png", "styles": {"position": "left", "avatar": {"paddingTop": "6px"}}}\n\t\t}',"speechToText",'{\n\t\t\t"button": {\n\t\t\t"default": {\n\t\t\t\t"container": {"default": {"bottom": "1em", "right": "0.6em", "borderRadius": "20px", "width": "1.9em", "height": "1.9em"}},\n\t\t\t\t"svg": {"styles": {"default": {"bottom": "0.35em", "left": "0.35em"}}}\n\t\t\t},\n\t\t\t"position": "inside-right"\n\t\t\t}\n\t\t}',"submitButtonStyles",'{\n\t\t\t"position": "outside-right",\n\t\t\t"submit": {\n\t\t\t"container": {\n\t\t\t\t"default": {"bottom": "0.75em", "borderRadius": "25px", "padding": "5px", "backgroundColor": "unset"},\n\t\t\t\t"hover": {"backgroundColor": "#b0deff4f"},\n\t\t\t\t"click": {"backgroundColor": "#b0deffb5"}\n\t\t\t},\n\t\t\t"svg": {\n\t\t\t\t"content": "<?xml version=\\"1.0\\" encoding=\\"utf-8\\"?> <svg viewBox=\\"0 0 24 24\\" xmlns=\\"http://www.w3.org/2000/svg\\"><path d=\\"m21.426 11.095-17-8A.999.999 0 0 0 3.03 4.242L4.969 12 3.03 19.758a.998.998 0 0 0 1.396 1.147l17-8a1 1 0 0 0 0-1.81zM5.481 18.197l.839-3.357L12 12 6.32 9.16l-.839-3.357L18.651 12l-13.17 6.197z\\"/></svg>",\n\t\t\t\t"styles": {\n\t\t\t\t"default": {\n\t\t\t\t\t"width": "1.5em",\n\t\t\t\t\t"filter":\n\t\t\t\t\t"brightness(0) saturate(100%) invert(10%) sepia(86%) saturate(6044%) hue-rotate(205deg) brightness(100%) contrast(100%)"\n\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t},\n\t\t\t"loading": {\n\t\t\t"container": {\n\t\t\t\t"default": {"backgroundColor": "unset"}\n\t\t\t},\n\t\t\t"svg": {\n\t\t\t\t"styles": {\n\t\t\t\t"default": {\n\t\t\t\t\t"filter":\n\t\t\t\t\t"brightness(0) saturate(100%) invert(72%) sepia(0%) saturate(3044%) hue-rotate(322deg) brightness(100%) contrast(96%)"\n\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t},\n\t\t\t"stop": {\n\t\t\t"container": {\n\t\t\t\t"default": {"backgroundColor": "unset"}\n\t\t\t}\n\t\t\t}\n\t\t}',"initialMessages",'[\n\t\t\t{"text": "Hey, how are you?", "role": "user"},\n\t\t\t{"text": "I am doing great, how about you?", "role": "ai"},\n\t\t\t{"text": "What is the meaning of life?", "role": "user"},\n\t\t\t{"text": "This completely depends on the person.", "role": "ai"}\n\t\t]',"demo","true","stream","true"]],template:function(r,o){1&r&&(os(0,"div")(1,"h1"),function og(e,t=""){const n=O(),r=fe(),o=e+ae,c=r.firstCreatePass?Mr(r,o,1,t,null):r.data[o],f=sg(r,n,c,t,e);n[o]=f,uo()&&Ao(r,n,f,c),Yt(c,!1)}(2,"Deep Chat"),Ai(),Gl(3,"deep-chat",0),Ai())},styles:["div[_ngcontent-%COMP%]{text-align:center}deep-chat[_ngcontent-%COMP%]{display:flex;justify-content:center}"]})}return e})(),Uk=(()=>{class e{static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275mod=Yr({type:e,bootstrap:[Hk]});static#n=this.\u0275inj=Wn({imports:[Nk]})}return e})();xk().bootstrapModule(Uk).catch(e=>console.error(e))},809:(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{function _toConsumableArray(a){return _arrayWithoutHoles(a)||_iterableToArray(a)||_unsupportedIterableToArray(a)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray(a){if(typeof Symbol<"u"&&null!=a[Symbol.iterator]||null!=a["@@iterator"])return Array.from(a)}function _arrayWithoutHoles(a){if(Array.isArray(a))return _arrayLikeToArray(a)}function _createForOfIteratorHelper(a,h){var s=typeof Symbol<"u"&&a[Symbol.iterator]||a["@@iterator"];if(!s){if(Array.isArray(a)||(s=_unsupportedIterableToArray(a))||h&&a&&"number"==typeof a.length){s&&(a=s);var u=0,l=function(){};return{s:l,n:function(){return u>=a.length?{done:!0}:{done:!1,value:a[u++]}},e:function(b){throw b},f:l}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var m,d=!0,p=!1;return{s:function(){s=s.call(a)},n:function(){var b=s.next();return d=b.done,b},e:function(b){p=!0,m=b},f:function(){try{!d&&null!=s.return&&s.return()}finally{if(p)throw m}}}}function _unsupportedIterableToArray(a,h){if(a){if("string"==typeof a)return _arrayLikeToArray(a,h);var s=Object.prototype.toString.call(a).slice(8,-1);if("Object"===s&&a.constructor&&(s=a.constructor.name),"Map"===s||"Set"===s)return Array.from(a);if("Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return _arrayLikeToArray(a,h)}}function _arrayLikeToArray(a,h){(null==h||h>a.length)&&(h=a.length);for(var s=0,u=new Array(h);s<h;s++)u[s]=a[s];return u}function _wrapNativeSuper(a){var h="function"==typeof Map?new Map:void 0;return _wrapNativeSuper=function(u){if(null===u||!_isNativeFunction(u))return u;if("function"!=typeof u)throw new TypeError("Super expression must either be null or a function");if(typeof h<"u"){if(h.has(u))return h.get(u);h.set(u,l)}function l(){return _construct(u,arguments,_getPrototypeOf(this).constructor)}return l.prototype=Object.create(u.prototype,{constructor:{value:l,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(l,u)},_wrapNativeSuper(a)}function _construct(a,h,s){return(_construct=_isNativeReflectConstruct()?Reflect.construct.bind():function(l,d,p){var m=[null];m.push.apply(m,d);var b=new(Function.bind.apply(l,m));return p&&_setPrototypeOf(b,p.prototype),b}).apply(null,arguments)}function _isNativeFunction(a){return-1!==Function.toString.call(a).indexOf("[native code]")}function _inherits(a,h){if("function"!=typeof h&&null!==h)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(h&&h.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),h&&_setPrototypeOf(a,h)}function _setPrototypeOf(a,h){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(u,l){return u.__proto__=l,u})(a,h)}function _createSuper(a){var h=_isNativeReflectConstruct();return function(){var l,u=_getPrototypeOf(a);if(h){var d=_getPrototypeOf(this).constructor;l=Reflect.construct(u,arguments,d)}else l=u.apply(this,arguments);return _possibleConstructorReturn(this,l)}}function _possibleConstructorReturn(a,h){if(h&&("object"===_typeof(h)||"function"==typeof h))return h;if(void 0!==h)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(a)}function _assertThisInitialized(a){if(void 0===a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function _isNativeReflectConstruct(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf(a){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(s){return s.__proto__||Object.getPrototypeOf(s)})(a)}function _regeneratorRuntime(){_regeneratorRuntime=function(){return h};var a,h={},s=Object.prototype,u=s.hasOwnProperty,l=Object.defineProperty||function(H,L,j){H[L]=j.value},d="function"==typeof Symbol?Symbol:{},p=d.iterator||"@@iterator",m=d.asyncIterator||"@@asyncIterator",v=d.toStringTag||"@@toStringTag";function b(H,L,j){return Object.defineProperty(H,L,{value:j,enumerable:!0,configurable:!0,writable:!0}),H[L]}try{b({},"")}catch{b=function(j,$,J){return j[$]=J}}function w(H,L,j,$){var W=Object.create((L&&L.prototype instanceof z?L:z).prototype),Pe=new $e($||[]);return l(W,"_invoke",{value:xe(H,j,Pe)}),W}function S(H,L,j){try{return{type:"normal",arg:H.call(L,j)}}catch($){return{type:"throw",arg:$}}}h.wrap=w;var M="suspendedStart",A="suspendedYield",k="executing",N="completed",B={};function z(){}function G(){}function te(){}var be={};b(be,p,function(){return this});var me=Object.getPrototypeOf,oe=me&&me(me(Re([])));oe&&oe!==s&&u.call(oe,p)&&(be=oe);var we=te.prototype=z.prototype=Object.create(be);function Ge(H){["next","throw","return"].forEach(function(L){b(H,L,function(j){return this._invoke(L,j)})})}function ve(H,L){function j(J,W,Pe,Ze){var qe=S(H[J],H,W);if("throw"!==qe.type){var Vt=qe.arg,$t=Vt.value;return $t&&"object"==_typeof($t)&&u.call($t,"__await")?L.resolve($t.__await).then(function(it){j("next",it,Pe,Ze)},function(it){j("throw",it,Pe,Ze)}):L.resolve($t).then(function(it){Vt.value=it,Pe(Vt)},function(it){return j("throw",it,Pe,Ze)})}Ze(qe.arg)}var $;l(this,"_invoke",{value:function(W,Pe){function Ze(){return new L(function(qe,Vt){j(W,Pe,qe,Vt)})}return $=$?$.then(Ze,Ze):Ze()}})}function xe(H,L,j){var $=M;return function(J,W){if($===k)throw new Error("Generator is already running");if($===N){if("throw"===J)throw W;return{value:a,done:!0}}for(j.method=J,j.arg=W;;){var Pe=j.delegate;if(Pe){var Ze=Oe(Pe,j);if(Ze){if(Ze===B)continue;return Ze}}if("next"===j.method)j.sent=j._sent=j.arg;else if("throw"===j.method){if($===M)throw $=N,j.arg;j.dispatchException(j.arg)}else"return"===j.method&&j.abrupt("return",j.arg);$=k;var qe=S(H,L,j);if("normal"===qe.type){if($=j.done?N:A,qe.arg===B)continue;return{value:qe.arg,done:j.done}}"throw"===qe.type&&($=N,j.method="throw",j.arg=qe.arg)}}}function Oe(H,L){var j=L.method,$=H.iterator[j];if($===a)return L.delegate=null,"throw"===j&&H.iterator.return&&(L.method="return",L.arg=a,Oe(H,L),"throw"===L.method)||"return"!==j&&(L.method="throw",L.arg=new TypeError("The iterator does not provide a '"+j+"' method")),B;var J=S($,H.iterator,L.arg);if("throw"===J.type)return L.method="throw",L.arg=J.arg,L.delegate=null,B;var W=J.arg;return W?W.done?(L[H.resultName]=W.value,L.next=H.nextLoc,"return"!==L.method&&(L.method="next",L.arg=a),L.delegate=null,B):W:(L.method="throw",L.arg=new TypeError("iterator result is not an object"),L.delegate=null,B)}function Ce(H){var L={tryLoc:H[0]};1 in H&&(L.catchLoc=H[1]),2 in H&&(L.finallyLoc=H[2],L.afterLoc=H[3]),this.tryEntries.push(L)}function Ae(H){var L=H.completion||{};L.type="normal",delete L.arg,H.completion=L}function $e(H){this.tryEntries=[{tryLoc:"root"}],H.forEach(Ce,this),this.reset(!0)}function Re(H){if(H||""===H){var L=H[p];if(L)return L.call(H);if("function"==typeof H.next)return H;if(!isNaN(H.length)){var j=-1,$=function J(){for(;++j<H.length;)if(u.call(H,j))return J.value=H[j],J.done=!1,J;return J.value=a,J.done=!0,J};return $.next=$}}throw new TypeError(_typeof(H)+" is not iterable")}return G.prototype=te,l(we,"constructor",{value:te,configurable:!0}),l(te,"constructor",{value:G,configurable:!0}),G.displayName=b(te,v,"GeneratorFunction"),h.isGeneratorFunction=function(H){var L="function"==typeof H&&H.constructor;return!!L&&(L===G||"GeneratorFunction"===(L.displayName||L.name))},h.mark=function(H){return Object.setPrototypeOf?Object.setPrototypeOf(H,te):(H.__proto__=te,b(H,v,"GeneratorFunction")),H.prototype=Object.create(we),H},h.awrap=function(H){return{__await:H}},Ge(ve.prototype),b(ve.prototype,m,function(){return this}),h.AsyncIterator=ve,h.async=function(H,L,j,$,J){void 0===J&&(J=Promise);var W=new ve(w(H,L,j,$),J);return h.isGeneratorFunction(L)?W:W.next().then(function(Pe){return Pe.done?Pe.value:W.next()})},Ge(we),b(we,v,"Generator"),b(we,p,function(){return this}),b(we,"toString",function(){return"[object Generator]"}),h.keys=function(H){var L=Object(H),j=[];for(var $ in L)j.push($);return j.reverse(),function J(){for(;j.length;){var W=j.pop();if(W in L)return J.value=W,J.done=!1,J}return J.done=!0,J}},h.values=Re,$e.prototype={constructor:$e,reset:function(L){if(this.prev=0,this.next=0,this.sent=this._sent=a,this.done=!1,this.delegate=null,this.method="next",this.arg=a,this.tryEntries.forEach(Ae),!L)for(var j in this)"t"===j.charAt(0)&&u.call(this,j)&&!isNaN(+j.slice(1))&&(this[j]=a)},stop:function(){this.done=!0;var L=this.tryEntries[0].completion;if("throw"===L.type)throw L.arg;return this.rval},dispatchException:function(L){if(this.done)throw L;var j=this;function $(Vt,$t){return Pe.type="throw",Pe.arg=L,j.next=Vt,$t&&(j.method="next",j.arg=a),!!$t}for(var J=this.tryEntries.length-1;J>=0;--J){var W=this.tryEntries[J],Pe=W.completion;if("root"===W.tryLoc)return $("end");if(W.tryLoc<=this.prev){var Ze=u.call(W,"catchLoc"),qe=u.call(W,"finallyLoc");if(Ze&&qe){if(this.prev<W.catchLoc)return $(W.catchLoc,!0);if(this.prev<W.finallyLoc)return $(W.finallyLoc)}else if(Ze){if(this.prev<W.catchLoc)return $(W.catchLoc,!0)}else{if(!qe)throw new Error("try statement without catch or finally");if(this.prev<W.finallyLoc)return $(W.finallyLoc)}}}},abrupt:function(L,j){for(var $=this.tryEntries.length-1;$>=0;--$){var J=this.tryEntries[$];if(J.tryLoc<=this.prev&&u.call(J,"finallyLoc")&&this.prev<J.finallyLoc){var W=J;break}}W&&("break"===L||"continue"===L)&&W.tryLoc<=j&&j<=W.finallyLoc&&(W=null);var Pe=W?W.completion:{};return Pe.type=L,Pe.arg=j,W?(this.method="next",this.next=W.finallyLoc,B):this.complete(Pe)},complete:function(L,j){if("throw"===L.type)throw L.arg;return"break"===L.type||"continue"===L.type?this.next=L.arg:"return"===L.type?(this.rval=this.arg=L.arg,this.method="return",this.next="end"):"normal"===L.type&&j&&(this.next=j),B},finish:function(L){for(var j=this.tryEntries.length-1;j>=0;--j){var $=this.tryEntries[j];if($.finallyLoc===L)return this.complete($.completion,$.afterLoc),Ae($),B}},catch:function(L){for(var j=this.tryEntries.length-1;j>=0;--j){var $=this.tryEntries[j];if($.tryLoc===L){var J=$.completion;if("throw"===J.type){var W=J.arg;Ae($)}return W}}throw new Error("illegal catch attempt")},delegateYield:function(L,j,$){return this.delegate={iterator:Re(L),resultName:j,nextLoc:$},"next"===this.method&&(this.arg=a),B}},h}function asyncGeneratorStep(a,h,s,u,l,d,p){try{var m=a[d](p),v=m.value}catch(b){return void s(b)}m.done?h(v):Promise.resolve(v).then(u,l)}function _asyncToGenerator(a){return function(){var h=this,s=arguments;return new Promise(function(u,l){var d=a.apply(h,s);function p(v){asyncGeneratorStep(d,u,l,p,m,"next",v)}function m(v){asyncGeneratorStep(d,u,l,p,m,"throw",v)}p(void 0)})}}function ownKeys(a,h){var s=Object.keys(a);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(a);h&&(u=u.filter(function(l){return Object.getOwnPropertyDescriptor(a,l).enumerable})),s.push.apply(s,u)}return s}function _objectSpread(a){for(var h=1;h<arguments.length;h++){var s=null!=arguments[h]?arguments[h]:{};h%2?ownKeys(Object(s),!0).forEach(function(u){_defineProperty(a,u,s[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(s)):ownKeys(Object(s)).forEach(function(u){Object.defineProperty(a,u,Object.getOwnPropertyDescriptor(s,u))})}return a}function _defineProperty(a,h,s){return(h=_toPropertyKey(h))in a?Object.defineProperty(a,h,{value:s,enumerable:!0,configurable:!0,writable:!0}):a[h]=s,a}function _typeof(a){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(h){return typeof h}:function(h){return h&&"function"==typeof Symbol&&h.constructor===Symbol&&h!==Symbol.prototype?"symbol":typeof h})(a)}function _classCallCheck(a,h){if(!(a instanceof h))throw new TypeError("Cannot call a class as a function")}function _defineProperties(a,h){for(var s=0;s<h.length;s++){var u=h[s];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(a,_toPropertyKey(u.key),u)}}function _createClass(a,h,s){return h&&_defineProperties(a.prototype,h),s&&_defineProperties(a,s),Object.defineProperty(a,"prototype",{writable:!1}),a}function _toPropertyKey(a){var h=_toPrimitive(a,"string");return"symbol"===_typeof(h)?h:String(h)}function _toPrimitive(a,h){if("object"!==_typeof(a)||null===a)return a;var s=a[Symbol.toPrimitive];if(void 0!==s){var u=s.call(a,h||"default");if("object"!==_typeof(u))return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===h?String:Number)(a)}var ErrorView=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"render",value:function(s,u){var l=document.createElement("div");l.id="error-view",l.innerText=u,s.replaceChildren(l)}}]),a}(),ValidateKeyPropertyView=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"onLoad",value:function(s){s.innerHTML='<div id="large-loading-ring"></div>'}},{key:"createElements",value:function(){var s=document.createElement("div");return s.id="validate-property-key-view",s}},{key:"render",value:function(s,u,l){var d=a.createElements(),p={onSuccess:u,onFail:ErrorView.render.bind(this,s,"Your 'key' has failed authentication"),onLoad:a.onLoad.bind(this,d)};l.key&&l.verifyKey(l.key,p),s.replaceChildren(d)}}]),a}(),WebComponentStyleUtils=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"apply",value:function(s,u){if(u)try{a.applyStyleSheet(s,u)}catch{a.addStyleElement(s,u)}}},{key:"applyStyleSheet",value:function(s,u){var l=new CSSStyleSheet;l.replaceSync(s),u.adoptedStyleSheets.push(l)}},{key:"addStyleElement",value:function(s,u){var l=document.createElement("style");l.innerHTML=s,u.appendChild(l)}}]),a}(),KEYBOARD_KEY=function(a){return a.ESCAPE="Escape",a.ENTER="Enter",a.TAB="Tab",a.ARROW_UP="ArrowUp",a.ARROW_DOWN="ArrowDown",a.ARROW_RIGHT="ArrowRight",a.ARROW_LEFT="ArrowLeft",a.BACKSPACE="Backspace",a.DELETE="Delete",a.META="Meta",a.CONTROL="Control",a}(KEYBOARD_KEY||{}),StyleUtils=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"unsetStyle",value:function(s,u){var l=Object.keys(u).reduce(function(d,p){return d[p]="",d},{});Object.assign(s.style,l)}},{key:"unsetActivityCSSMouseStates",value:function(s,u){u.click&&a.unsetStyle(s,u.click),u.hover&&a.unsetStyle(s,u.hover)}},{key:"unsetAllCSSMouseStates",value:function(s,u){a.unsetActivityCSSMouseStates(s,u),u.default&&a.unsetStyle(s,u.default)}},{key:"generateStateful",value:function(s,u,l){var d=s.default||{},p=Object.assign(JSON.parse(JSON.stringify(_objectSpread(_objectSpread({},d),u))),s?.hover);return{default:d,hover:p,click:Object.assign(JSON.parse(JSON.stringify(_objectSpread(_objectSpread({},p),l))),s?.click)}}}]),a}(),Browser$1=_createClass(function a(){_classCallCheck(this,a)});Browser$1.IS_SAFARI=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),Browser$1.IS_CHROMIUM=window.chrome;var PasteUtils=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"sanitizePastedTextContent",value:function(s){var u,l;s.preventDefault();var d=null==(u=s.clipboardData)?void 0:u.getData("text/plain");null==(l=document.execCommand)||l.call(document,"insertHTML",!1,d)}}]),a}(),_InputLimit=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"add",value:function(s,u){s.addEventListener("keydown",a.onKeyDown.bind(this,u)),s.oninput=a.onInput.bind(this,u)}},{key:"onKeyDown",value:function(s,u){var l=u.target.textContent;l&&l.length>=s&&!a.PERMITTED_KEYS.has(u.key)&&!a.isKeyCombinationPermitted(u)&&u.preventDefault()}},{key:"isKeyCombinationPermitted",value:function(s){return"a"===s.key&&(s.ctrlKey||s.metaKey)}},{key:"onInput",value:function(s,u){var l=u.target,d=l.textContent;d&&d.length>s&&(l.textContent=d.substring(0,s),FocusUtils.focusEndOfInput(l))}}]),a}();_InputLimit.PERMITTED_KEYS=new Set([KEYBOARD_KEY.BACKSPACE,KEYBOARD_KEY.DELETE,KEYBOARD_KEY.ARROW_RIGHT,KEYBOARD_KEY.ARROW_LEFT,KEYBOARD_KEY.ARROW_DOWN,KEYBOARD_KEY.ARROW_UP,KEYBOARD_KEY.META,KEYBOARD_KEY.CONTROL,KEYBOARD_KEY.ENTER]);var InputLimit=_InputLimit,_TextInputEl=function(){function a(h,s){_classCallCheck(this,a);var u,l=a.processConfig(h,s);this.elementRef=a.createContainerElement(null==(u=l?.styles)?void 0:u.container),this.inputElementRef=this.createInputElement(l),this._config=l,this.elementRef.appendChild(this.inputElementRef),null!=s&&s.characterLimit&&InputLimit.add(this.inputElementRef,s?.characterLimit)}return _createClass(a,[{key:"createInputElement",value:function(s){var u,l,d,p=document.createElement("div");return p.id=a.TEXT_INPUT_ID,p.classList.add("text-input-styling","text-input-placeholder"),p.innerText=(null==(u=s?.placeholder)?void 0:u.text)||"Ask me anything!",Browser$1.IS_CHROMIUM&&a.preventAutomaticScrollUpOnNewLine(p),"boolean"==typeof s?.disabled&&!0===s.disabled?(p.contentEditable="false",p.classList.add("text-input-disabled")):(p.contentEditable="true",this.addEventListeners(p,s)),Object.assign(p.style,null==(l=s?.styles)?void 0:l.text),Object.assign(p.style,null==(d=s?.placeholder)?void 0:d.style),p}},{key:"removeTextIfPlaceholder",value:function(){var s,u,l,d;this.inputElementRef.classList.contains("text-input-placeholder")&&!this.inputElementRef.classList.contains("text-input-disabled")&&(null!=(s=this._config.placeholder)&&s.style&&(StyleUtils.unsetStyle(this.inputElementRef,null==(u=this._config.placeholder)?void 0:u.style),Object.assign(this.inputElementRef.style,null==(d=null==(l=this._config)?void 0:l.styles)?void 0:d.text)),a.clear(this.inputElementRef),this.inputElementRef.classList.remove("text-input-placeholder"))}},{key:"addEventListeners",value:function(s,u){var l,d,p;s.onfocus=this.onFocus.bind(this,null==(l=u?.styles)?void 0:l.focus),null!=(d=u?.styles)&&d.focus&&(s.onblur=this.onBlur.bind(this,u.styles.focus,null==(p=u?.styles)?void 0:p.container)),s.addEventListener("keydown",this.onKeydown.bind(this)),s.onpaste=PasteUtils.sanitizePastedTextContent}},{key:"onFocus",value:function(s){var u=this;Browser$1.IS_SAFARI?setTimeout(function(){u.removeTextIfPlaceholder()}):this.removeTextIfPlaceholder(),Object.assign(this.elementRef.style,s)}},{key:"onBlur",value:function(s,u){StyleUtils.unsetStyle(this.elementRef,s),u&&Object.assign(this.elementRef.style,u)}},{key:"onKeydown",value:function(s){var u;s.key===KEYBOARD_KEY.ENTER&&!s.ctrlKey&&!s.shiftKey&&(s.preventDefault(),null==(u=this.submit)||u.call(this))}}],[{key:"processConfig",value:function(s,u){var l,d,p,m,v;return null!==(l=u)&&void 0!==l||(u={}),null!==(d=u.disabled)&&void 0!==d||(u.disabled=s.isTextInputDisabled),null!==(p=u.placeholder)&&void 0!==p||(u.placeholder={}),null!==(m=(v=u.placeholder).text)&&void 0!==m||(v.text=s.textInputPlaceholderText),u}},{key:"preventAutomaticScrollUpOnNewLine",value:function(s){var u;s.addEventListener("keydown",function(){u=window.scrollY}),s.addEventListener("input",function(){u!==window.scrollY&&window.scrollTo({top:u})})}},{key:"clear",value:function(s){var u=window.scrollY;s.classList.contains("text-input-disabled")||(s.textContent=""),Browser$1.IS_CHROMIUM&&window.scrollTo({top:u})}},{key:"toggleEditability",value:function(s,u){s.contentEditable=u?"true":"false"}},{key:"createContainerElement",value:function(s){var u=document.createElement("div");return u.id="text-input-container",Object.assign(u.style,s),u}}]),a}();_TextInputEl.TEXT_INPUT_ID="text-input";var TextInputEl=_TextInputEl,FocusUtils=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"focusEndOfInput",value:function(s){var u=document.createRange();u.selectNodeContents(s),u.collapse(!1);var l=window.getSelection();l?.removeAllRanges(),l?.addRange(u)}},{key:"focusFromParentElement",value:function(s){var u=s.querySelector("#".concat(TextInputEl.TEXT_INPUT_ID));u&&a.focusEndOfInput(u)}}]),a}();function capitalizeFirstLetter(a){return a.charAt(0).toUpperCase()+a.slice(1)}function getInterceptorMessage(a){return a&&JSON.stringify(a)}function getInvalidResponseMessage(a,h,s,u){var l="\n".concat(capitalizeFirstLetter(h)," message: ").concat(JSON.stringify(a)," \n"),d=s?"".concat(capitalizeFirstLetter(h)," message after interceptor: ").concat(getInterceptorMessage(u)," \n"):"";return"".concat(l+d,"Make sure the ").concat(h," message is using the Response format: https://deepchat.dev/docs/connect/#Response \n You can also augment it using the responseInterceptor property: https://deepchat.dev/docs/interceptors#responseInterceptor")}var ErrorMessages={INVALID_KEY:"Invalid API Key",CONNECTION_FAILED:"Failed to connect",INVALID_RESPONSE:getInvalidResponseMessage,INVALID_STREAM_RESPONSE:"Make sure the events are using the Response format: https://deepchat.dev/docs/connect/#Response \nYou can also augment them using the responseInterceptor property: https://deepchat.dev/docs/interceptors#responseInterceptor"};function getBytes(a,h){return _getBytes.apply(this,arguments)}function _getBytes(){return(_getBytes=_asyncToGenerator(_regeneratorRuntime().mark(function a(h,s){var u,l;return _regeneratorRuntime().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:u=h.getReader();case 1:return p.next=3,u.read();case 3:if((l=p.sent).done){p.next=7;break}s(l.value);case 5:p.next=1;break;case 7:case"end":return p.stop()}},a)}))).apply(this,arguments)}function getLines(a){var h,s,u,l=!1;return function(d){void 0===h?(h=d,s=0,u=-1):h=concat(h,d);for(var p=h.length,m=0;s<p;){l&&(10===h[s]&&(m=++s),l=!1);for(var v=-1;s<p&&-1===v;++s)switch(h[s]){case 58:-1===u&&(u=s-m);break;case 13:l=!0;case 10:v=s}if(-1===v)break;a(h.subarray(m,v),u),m=s,u=-1}m===p?h=void 0:0!==m&&(h=h.subarray(m),s-=m)}}function getMessages(a,h,s){var u=newMessage(),l=new TextDecoder;return function(d,p){if(0===d.length)s?.(u),u=newMessage();else if(p>0){var m=l.decode(d.subarray(0,p)),b=l.decode(d.subarray(p+(32===d[p+1]?2:1)));switch(m){case"data":u.data=u.data?u.data+"\n"+b:b;break;case"event":u.event=b;break;case"id":a(u.id=b);break;case"retry":var w=parseInt(b,10);isNaN(w)||h(u.retry=w)}}}}function concat(a,h){var s=new Uint8Array(a.length+h.length);return s.set(a),s.set(h,a.length),s}function newMessage(){return{data:"",event:"",id:"",retry:void 0}}var __rest=globalThis&&globalThis.__rest||function(a,h){var s={};for(var u in a)Object.prototype.hasOwnProperty.call(a,u)&&h.indexOf(u)<0&&(s[u]=a[u]);if(null!=a&&"function"==typeof Object.getOwnPropertySymbols){var l=0;for(u=Object.getOwnPropertySymbols(a);l<u.length;l++)h.indexOf(u[l])<0&&Object.prototype.propertyIsEnumerable.call(a,u[l])&&(s[u[l]]=a[u[l]])}return s},EventStreamContentType="text/event-stream",DefaultRetryInterval=1e3,LastEventId="last-event-id";function fetchEventSource(a,h){var s=h.signal,u=h.headers,l=h.onopen,d=h.onmessage,p=h.onclose,m=h.onerror,v=h.openWhenHidden,b=h.fetch,w=__rest(h,["signal","headers","onopen","onmessage","onclose","onerror","openWhenHidden","fetch"]);return new Promise(function(S,M){var k,A=Object.assign({},u);function N(){k.abort(),document.hidden||me()}A.accept||(A.accept=EventStreamContentType),v||document.addEventListener("visibilitychange",N);var B=DefaultRetryInterval,z=0;function G(){document.removeEventListener("visibilitychange",N),window.clearTimeout(z),k.abort()}s?.addEventListener("abort",function(){G(),S()});var te=b??window.fetch,be=l??defaultOnOpen;function me(){return oe.apply(this,arguments)}function oe(){return(oe=_asyncToGenerator(_regeneratorRuntime().mark(function we(){var Ge,ve,xe;return _regeneratorRuntime().wrap(function(Ce){for(;;)switch(Ce.prev=Ce.next){case 0:return k=new AbortController,Ce.prev=1,Ce.next=4,te(a,Object.assign(Object.assign({},w),{headers:A,signal:k.signal}));case 4:return ve=Ce.sent,Ce.next=7,be(ve);case 7:return Ce.next=9,getBytes(ve.body,getLines(getMessages(function(Ae){Ae?A[LastEventId]=Ae:delete A[LastEventId]},function(Ae){B=Ae},d)));case 9:p?.(),G(),S(),Ce.next=17;break;case 14:if(Ce.prev=14,Ce.t0=Ce.catch(1),!k.signal.aborted)try{xe=null!==(Ge=m?.(Ce.t0))&&void 0!==Ge?Ge:B,window.clearTimeout(z),z=window.setTimeout(me,xe)}catch(Ae){G(),M(Ae)}case 17:case"end":return Ce.stop()}},we,null,[[1,14]])}))).apply(this,arguments)}me()})}function defaultOnOpen(a){var h=a.headers.get("content-type");if(null==h||!h.startsWith(EventStreamContentType))throw new Error("Expected content-type to be ".concat(EventStreamContentType,", Actual: ").concat(h))}var _RequestUtils=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"temporarilyRemoveHeader",value:(h=_asyncToGenerator(_regeneratorRuntime().mark(function u(l,d,p){var m;return _regeneratorRuntime().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:if(null!=l&&l.headers){b.next=2;break}throw new Error("Request settings have not been set up");case 2:return m=l.headers[a.CONTENT_TYPE],delete l.headers[a.CONTENT_TYPE],b.next=6,d(p);case 6:l.headers[a.CONTENT_TYPE]=m;case 7:case"end":return b.stop()}},u)})),function s(u,l,d){return h.apply(this,arguments)})},{key:"displayError",value:function(s,u){var l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Service error, please try again.";if(console.error(u),"object"==_typeof(u))return 0===Object.keys(u).length?s.addNewErrorMessage("service",l):s.addNewErrorMessage("service",JSON.stringify(u));s.addNewErrorMessage("service",u)}},{key:"processResponseByType",value:function(s){var u=s.headers.get("content-type");return null!=u&&u.includes("application/json")?s.json():null!=u&&u.includes("text/plain")||!u?s:s.blob()}},{key:"processRequestInterceptor",value:function(){var h=_asyncToGenerator(_regeneratorRuntime().mark(function u(l,d){var p,m,v;return _regeneratorRuntime().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return S.next=2,null==(p=l.requestInterceptor)?void 0:p.call(l,d);case 2:if(S.t0=S.sent,S.t0){S.next=5;break}S.t0=d;case 5:return S.abrupt("return",{body:(v=m=S.t0).body,headers:v.headers,error:m.error});case 9:case"end":return S.stop()}},u)}));return function s(u,l){return h.apply(this,arguments)}}()}]),a;var h}();_RequestUtils.CONTENT_TYPE="Content-Type";var RequestUtils=_RequestUtils,_Demo=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"generateResponseForOneMessage",value:function(s){if(s.file)return"image"===s.file.type?"That is a nice image!":"audio"===s.file.type?"I like the sound of that!":"gif"===s.file.type?"That is a nice gif!":"That is an interesting file!";if(s.text){if("?"===s.text.charAt(s.text.length-1))return"I'm sorry but I can't answer that question...";if(s.text.includes("updog"))return"What's updog?"}return"Hi there! This is a demo response!"}},{key:"generateResponse",value:function(s){for(var u=[],l=s.messages.length-1;l>=0&&"ai"!==s.messages[l].role;l-=1)u.push(s.messages[l]);if(1===u.length)return a.generateResponseForOneMessage(s.messages[s.messages.length-1]);var d=s.messages.findIndex(function(p){return p.text});return-1!==d&&u.splice(d,1),1===u.length?a.generateResponseForOneMessage(s.messages[s.messages.length-1]):"Wow, very cool files!"}},{key:"getCustomResponse",value:function(s,u){return"function"==typeof s?s(u):s}},{key:"getResponse",value:function(s){return s.customDemoResponse?a.getCustomResponse(s.customDemoResponse,s.messages[s.messages.length-1]):{text:a.generateResponse(s)}}},{key:"request",value:function(s,u,l){var d=a.getResponse(s);setTimeout(_asyncToGenerator(_regeneratorRuntime().mark(function p(){var m;return _regeneratorRuntime().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.next=2,l?.(d);case 2:if(b.t0=b.sent,b.t0){b.next=5;break}b.t0=d;case 5:(m=b.t0).error?s.addNewErrorMessage("service",m.error):s.addNewMessage(m,!0,!0),u();case 7:case"end":return b.stop()}},p)})),400)}},{key:"requestStream",value:function(s,u){setTimeout(function(){var l,d=null==(l=a.getResponse(s))?void 0:l.text;Stream.simulate(s,u,d)},400)}}]),a}();_Demo.URL="deep-chat-demo";var Demo=_Demo,Stream=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"request",value:(h=_asyncToGenerator(_regeneratorRuntime().mark(function u(l,d,p){var m,v,b,w,S,M,A,k,N,B,z,G,te,be,me,oe,we=arguments;return _regeneratorRuntime().wrap(function(ve){for(;;)switch(ve.prev=ve.next){case 0:return m=!(we.length>3&&void 0!==we[3])||we[3],A={body:d,headers:null==(v=l.requestSettings)?void 0:v.headers},ve.next=4,RequestUtils.processRequestInterceptor(l.deepChat,A);case 4:if(N=(k=ve.sent).body,B=k.headers,te=(G=l.streamHandlers).onOpen,be=G.onClose,me=G.abortStream,!(z=k.error)){ve.next=14;break}return ve.abrupt("return",a.onInterceptorError(p,z,be));case 14:if(null==(b=l.requestSettings)||!b.handler){ve.next=16;break}return ve.abrupt("return",CustomHandler.stream(l,N,p));case 16:if((null==(w=l.requestSettings)?void 0:w.url)!==Demo.URL){ve.next=18;break}return ve.abrupt("return",Demo.requestStream(p,l.streamHandlers));case 18:oe=null,fetchEventSource((null==(S=l.requestSettings)?void 0:S.url)||l.url||"",{method:(null==(M=l.requestSettings)?void 0:M.method)||"POST",headers:B,body:m?JSON.stringify(N):N,openWhenHidden:!0,onopen:function(Oe){return _asyncToGenerator(_regeneratorRuntime().mark(function Ce(){return _regeneratorRuntime().wrap(function($e){for(;;)switch($e.prev=$e.next){case 0:if(!Oe.ok){$e.next=2;break}return $e.abrupt("return",(oe=p.addNewStreamedMessage(),te()));case 2:return $e.next=4,RequestUtils.processResponseByType(Oe);case 4:throw $e.sent;case 5:case"end":return $e.stop()}},Ce)}))()},onmessage:function(Oe){var Ce;if(JSON.stringify(Oe.data)!==JSON.stringify("[DONE]")){var Ae=JSON.parse(Oe.data);null==(Ce=l.extractResultData)||Ce.call(l,Ae).then(function($e){void 0===$e?.text?console.error("Response data: ".concat(Oe.data," \n ").concat(ErrorMessages.INVALID_STREAM_RESPONSE)):oe&&p.updateStreamedMessage($e.text,oe)}).catch(function($e){return RequestUtils.displayError(p,$e)})}},onerror:function(Oe){throw be(),Oe},onclose:function(){p.finaliseStreamedMessage(),be()},signal:me.signal}).catch(function(xe){var Oe;null==(Oe=l.extractResultData)||Oe.call(l,xe).then(function(){RequestUtils.displayError(p,xe)}).catch(function(Ce){RequestUtils.displayError(p,Ce)})});case 20:case"end":return ve.stop()}},u)})),function s(u,l,d){return h.apply(this,arguments)})},{key:"onInterceptorError",value:function(s,u,l){s.addNewErrorMessage("service",u),l?.()}},{key:"simulate",value:function(s,u,l){var d=u,p=l?.split(" ")||[],m=s.addNewStreamedMessage();u.onOpen(),a.populateMessages(m,p,s,d)}},{key:"populateMessages",value:function(s,u,l,d){var p=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,m=u[p];if(m){l.updateStreamedMessage("".concat(m," "),s);var v=setTimeout(function(){a.populateMessages(s,u,l,d,p+1)},d.simulationInterim||70);d.abortStream.abort=function(){return a.abort(v,l,d.onClose)}}else l.finaliseStreamedMessage(),d.onClose()}},{key:"abort",value:function(s,u,l){clearTimeout(s),u.finaliseStreamedMessage(),l()}}]),a;var h}(),CustomHandler=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"request",value:(h=_asyncToGenerator(_regeneratorRuntime().mark(function u(l,d,p){var m,v,b,w,S;return _regeneratorRuntime().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:b=!0,w=function(){var k=_asyncToGenerator(_regeneratorRuntime().mark(function N(B){var z,G,te;return _regeneratorRuntime().wrap(function(me){for(;;)switch(me.prev=me.next){case 0:if(b){me.next=2;break}return me.abrupt("return");case 2:return b=!1,me.next=5,null==(G=(z=l.deepChat).responseInterceptor)?void 0:G.call(z,B);case 5:if(me.t0=me.sent,me.t0){me.next=8;break}me.t0=B;case 8:!(te=me.t0)||"object"!=_typeof(te)||"string"!=typeof te.error&&"string"!=typeof te.text?(console.error(ErrorMessages.INVALID_RESPONSE(B,"server",!!l.deepChat.responseInterceptor,te)),p.addNewErrorMessage("service","Error in server message"),l.completionsHandlers.onFinish()):"string"==typeof te.error?(console.error(te.error),p.addNewErrorMessage("service",te.error),l.completionsHandlers.onFinish()):l.deepChat.stream&&te.text?Stream.simulate(p,l.streamHandlers,te.text):(p.addNewMessage(te,!0,!0),l.completionsHandlers.onFinish());case 10:case"end":return me.stop()}},N)}));return function(B){return k.apply(this,arguments)}}(),S=a.generateOptionalSignals(),null==(v=(m=l.requestSettings).handler)||v.call(m,d,_objectSpread(_objectSpread({},S),{},{onResponse:w}));case 3:case"end":return A.stop()}},u)})),function s(u,l,d){return h.apply(this,arguments)})},{key:"stream",value:function(s,u,l){var d,p,m=!0,v=!1,b=null;s.streamHandlers.abortStream.abort=function(){l.finaliseStreamedMessage(),s.streamHandlers.onClose(),m=!1};var A=a.generateOptionalSignals();null==(p=(d=s.requestSettings).handler)||p.call(d,u,_objectSpread(_objectSpread({},A),{},{onOpen:function(){v||!m||(b=l.addNewStreamedMessage(),s.streamHandlers.onOpen(),v=!0)},onResponse:function(N){m&&(!N||"object"!=_typeof(N)||"string"!=typeof N.error&&"string"!=typeof N.text?console.error(ErrorMessages.INVALID_RESPONSE(N,"server",!1)):N.error?(console.error(N.error),l.finaliseStreamedMessage(),s.streamHandlers.onClose(),l.addNewErrorMessage("service",N.error),m=!1):N.text&&b&&l.updateStreamedMessage(N.text,b))},onClose:function(){m&&(l.finaliseStreamedMessage(),s.streamHandlers.onClose(),m=!1)},stopClicked:s.streamHandlers.stopClicked}))}},{key:"websocket",value:function(s,u){var l,d,p={isOpen:!1,newUserMessage:{listener:function(){}}};s.websocket=p;var b=function(){var S=_asyncToGenerator(_regeneratorRuntime().mark(function M(A){var k,N,B;return _regeneratorRuntime().wrap(function(G){for(;;)switch(G.prev=G.next){case 0:if(p.isOpen){G.next=2;break}return G.abrupt("return");case 2:return G.next=4,null==(N=(k=s.deepChat).responseInterceptor)?void 0:N.call(k,A);case 4:if(G.t0=G.sent,G.t0){G.next=7;break}G.t0=A;case 7:!(B=G.t0)||"object"!=_typeof(B)||"string"!=typeof B.error&&"string"!=typeof B.text?(console.error(ErrorMessages.INVALID_RESPONSE(A,"server",!!s.deepChat.responseInterceptor,B)),u.addNewErrorMessage("service","Error in server message")):"string"==typeof B.error?(console.error(B.error),u.isLastMessageError()||u.addNewErrorMessage("service",B.error)):s.deepChat.stream?Stream.simulate(u,s.streamHandlers,B.text):u.addNewMessage(B,!0,!0);case 9:case"end":return G.stop()}},M)}));return function(A){return S.apply(this,arguments)}}(),w=a.generateOptionalSignals();null==(d=(l=s.requestSettings).handler)||d.call(l,void 0,_objectSpread(_objectSpread({},w),{},{onOpen:function(){u.removeError(),p.isOpen=!0},onResponse:b,onClose:function(){p.isOpen=!1},newUserMessage:p.newUserMessage}))}},{key:"generateOptionalSignals",value:function(){return{onClose:function(){},onOpen:function(){},stopClicked:{listener:function(){}},newUserMessage:{listener:function(){}}}}}]),a;var h}(),HTTPRequest=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"request",value:(h=_asyncToGenerator(_regeneratorRuntime().mark(function u(l,d,p){var m,v,b,w,S,M,A,k,N,B,z,G,te,be=arguments;return _regeneratorRuntime().wrap(function(oe){for(;;)switch(oe.prev=oe.next){case 0:return m=!(be.length>3&&void 0!==be[3])||be[3],A={body:d,headers:null==(v=l.requestSettings)?void 0:v.headers},oe.next=4,RequestUtils.processRequestInterceptor(l.deepChat,A);case 4:if(N=(k=oe.sent).body,B=k.headers,G=l.completionsHandlers.onFinish,!(z=k.error)){oe.next=11;break}return oe.abrupt("return",a.onInterceptorError(p,z,G));case 11:if(null==(b=l.requestSettings)||!b.handler){oe.next=13;break}return oe.abrupt("return",CustomHandler.request(l,N,p));case 13:if((null==(w=l.requestSettings)?void 0:w.url)!==Demo.URL){oe.next=15;break}return oe.abrupt("return",Demo.request(p,G,l.deepChat.responseInterceptor));case 15:te=!0,fetch((null==(S=l.requestSettings)?void 0:S.url)||l.url||"",{method:(null==(M=l.requestSettings)?void 0:M.method)||"POST",headers:B,body:m?JSON.stringify(N):N}).then(function(we){return te=!!we.ok,we}).then(function(we){return RequestUtils.processResponseByType(we)}).then(function(){var we=_asyncToGenerator(_regeneratorRuntime().mark(function Ge(ve){var xe,Oe,Ce,Ae;return _regeneratorRuntime().wrap(function(Re){for(;;)switch(Re.prev=Re.next){case 0:if(l.extractResultData){Re.next=2;break}return Re.abrupt("return");case 2:return Re.next=4,null==(Oe=(xe=l.deepChat).responseInterceptor)?void 0:Oe.call(xe,ve);case 4:if(Re.t0=Re.sent,Re.t0){Re.next=7;break}Re.t0=ve;case 7:return Ce=Re.t0,Re.next=10,l.extractResultData(Ce);case 10:if(Ae=Re.sent,te){Re.next=13;break}throw ve;case 13:if(Ae&&"object"==_typeof(Ae)){Re.next=15;break}throw Error(ErrorMessages.INVALID_RESPONSE(ve,"response",!!l.deepChat.responseInterceptor,Ce));case 15:Ae.pollingInAnotherRequest||(l.deepChat.stream&&Ae.text?Stream.simulate(p,l.streamHandlers,Ae.text):(p.addNewMessage(Ae,!0,!0),G()));case 16:case"end":return Re.stop()}},Ge)}));return function(Ge){return we.apply(this,arguments)}}()).catch(function(we){RequestUtils.displayError(p,we),G()});case 17:case"end":return oe.stop()}},u)})),function s(u,l,d){return h.apply(this,arguments)})},{key:"executePollRequest",value:function(s,u,l,d){console.log("polling");var p=s.completionsHandlers.onFinish;fetch(u,l).then(function(m){return m.json()}).then(function(){var m=_asyncToGenerator(_regeneratorRuntime().mark(function v(b){var w,S,M;return _regeneratorRuntime().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:if(s.extractPollResultData){k.next=2;break}return k.abrupt("return");case 2:return k.t0=s,k.next=5,null==(S=(w=s.deepChat).responseInterceptor)?void 0:S.call(w,b);case 5:if(k.t1=k.sent,k.t1){k.next=8;break}k.t1=b;case 8:return k.t2=k.t1,k.next=11,k.t0.extractPollResultData.call(k.t0,k.t2);case 11:(M=k.sent).timeoutMS?setTimeout(function(){a.executePollRequest(s,u,l,d)},M.timeoutMS):(console.log("finished polling"),d.addNewMessage(M,!0,!0),p());case 13:case"end":return k.stop()}},v)}));return function(v){return m.apply(this,arguments)}}()).catch(function(m){RequestUtils.displayError(d,m),p()})}},{key:"poll",value:function(){var h=_asyncToGenerator(_regeneratorRuntime().mark(function u(l,d,p){var m,v,b,w,S,M,A,k,N,B,z,G,be=arguments;return _regeneratorRuntime().wrap(function(oe){for(;;)switch(oe.prev=oe.next){case 0:return m=!(be.length>3&&void 0!==be[3])||be[3],S={body:d,headers:null==(v=l.requestSettings)?void 0:v.headers},oe.next=4,RequestUtils.processRequestInterceptor(l.deepChat,S);case 4:if(A=(M=oe.sent).body,k=M.headers,!(N=M.error)){oe.next=10;break}return oe.abrupt("return",a.onInterceptorError(p,N));case 10:B=(null==(b=l.requestSettings)?void 0:b.url)||l.url||"",z=(null==(w=l.requestSettings)?void 0:w.method)||"POST",G=m?JSON.stringify(A):A,a.executePollRequest(l,B,{method:z,body:G,headers:k},p);case 12:case"end":return oe.stop()}},u)}));return function s(u,l,d){return h.apply(this,arguments)}}()},{key:"onInterceptorError",value:function(s,u,l){s.addNewErrorMessage("service",u),l?.()}},{key:"verifyKey",value:function(s,u,l,d,p,m,v,b,w){if(""===s)return m(ErrorMessages.INVALID_KEY);v(),fetch(u,{method:d,headers:l,body:w||null}).then(function(S){return RequestUtils.processResponseByType(S)}).then(function(S){b(S,s,p,m)}).catch(function(S){m(ErrorMessages.CONNECTION_FAILED),console.error(S)})}}]),a;var h}(),MessageLimitUtils=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"getCharacterLimitMessages",value:function(s,u){for(var l,d=0,p=s.length-1;p>=0;p-=1){var m=null==(l=s[p])?void 0:l.text;if(void 0!==m&&(d+=m.length)>u){s[p].text=m.substring(0,m.length-(d-u));break}}return s.slice(Math.max(p,0))}},{key:"getRequestMessages",value:function(s,u){for(var l,d=[],p=(null==(l=s.files)?void 0:l.length)||0,m=!!s.text,v=u.length-1;v>=0;v-=1){var b=u[v];if(d.push(b),b.file?p-=1:b.text&&(m=!1),0===p&&!m)break}return d}},{key:"getMaxMessages",value:function(s,u){return s.slice(Math.max(s.length-u,0))}},{key:"processMessages",value:function(s,u,l,d){return void 0!==l?l>0&&(u=a.getMaxMessages(u,l)):u=a.getRequestMessages(s,u),u=JSON.parse(JSON.stringify(u)),void 0===d?u:a.getCharacterLimitMessages(u,d)}}]),a}(),Websocket=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"setup",value:function(s){s.requestSettings.url!==Demo.URL&&(s.permittedErrorPrefixes=["Connection error","Error in server message"],s.websocket="pending")}},{key:"createConnection",value:function(s,u){if(document.body.contains(s.deepChat)){var l=s.requestSettings.websocket;if(l){if(s.requestSettings.handler)return CustomHandler.websocket(s,u);try{var p=new WebSocket(s.requestSettings.url||"","boolean"!=typeof l?l:void 0);s.websocket=p,s.websocket.onopen=function(){u.removeError(),s.websocket&&"object"==_typeof(s.websocket)&&a.assignListeners(s,p,u)},s.websocket.onerror=function(m){console.error(m),a.retryConnection(s,u)}}catch(m){console.error(m),a.retryConnection(s,u)}}}}},{key:"retryConnection",value:function(s,u){document.body.contains(s.deepChat)&&(s.websocket="pending",u.isLastMessageError()||u.addNewErrorMessage("service","Connection error"),setTimeout(function(){a.createConnection(s,u)},5e3))}},{key:"assignListeners",value:function(s,u,l){u.onmessage=function(){var d=_asyncToGenerator(_regeneratorRuntime().mark(function p(m){var v,b,w,S,M;return _regeneratorRuntime().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:if(!s.extractResultData){k.next=20;break}return k.prev=1,w=JSON.parse(m.data),k.next=5,null==(b=(v=s.deepChat).responseInterceptor)?void 0:b.call(v,w);case 5:if(k.t0=k.sent,k.t0){k.next=8;break}k.t0=w;case 8:return S=k.t0,k.next=11,s.extractResultData(S);case 11:if((M=k.sent)&&"object"==_typeof(M)){k.next=14;break}throw Error(ErrorMessages.INVALID_RESPONSE(w,"server",!!s.deepChat.responseInterceptor,S));case 14:s.deepChat.stream&&M.text?Stream.simulate(l,s.streamHandlers,M.text):l.addNewMessage(M,!0,!0),k.next=20;break;case 17:k.prev=17,k.t1=k.catch(1),RequestUtils.displayError(l,k.t1,"Error in server message");case 20:case"end":return k.stop()}},p,null,[[1,17]])}));return function(p){return d.apply(this,arguments)}}(),u.onclose=function(){console.error("Connection closed"),l.isLastMessageError()||l.addNewErrorMessage("service","Connection error"),a.createConnection(s,l)}}},{key:"sendWebsocket",value:(h=_asyncToGenerator(_regeneratorRuntime().mark(function u(l,d,p){var m,v,b,w,S,M,A,k,N,B=arguments;return _regeneratorRuntime().wrap(function(G){for(;;)switch(G.prev=G.next){case 0:if(m=!(B.length>3&&void 0!==B[3])||B[3],(w=l.websocket)&&"pending"!==w){G.next=4;break}return G.abrupt("return");case 4:return S={body:d,headers:null==(v=l.requestSettings)?void 0:v.headers},G.next=7,RequestUtils.processRequestInterceptor(l.deepChat,S);case 7:if(A=(M=G.sent).body,!(k=M.error)){G.next=12;break}return G.abrupt("return",p.addNewErrorMessage("service",k));case 12:if(a.isWebSocket(w)){G.next=14;break}return G.abrupt("return",w.newUserMessage.listener(A));case 14:if(N=m?JSON.stringify(A):A,(null==(b=l.requestSettings)?void 0:b.url)!==Demo.URL){G.next=17;break}return G.abrupt("return",Demo.request(p,l.completionsHandlers.onFinish,l.deepChat.responseInterceptor));case 17:void 0===w.readyState||w.readyState!==w.OPEN?(console.error("Connection is not open"),p.isLastMessageError()||p.addNewErrorMessage("service","Connection error")):w.send(JSON.stringify(N));case 18:case"end":return G.stop()}},u)})),function s(u,l,d){return h.apply(this,arguments)})},{key:"canSendMessage",value:function(s){return!s||"pending"!==s&&(a.isWebSocket(s)?void 0!==s.readyState&&s.readyState===s.OPEN:s.isOpen)}},{key:"isWebSocket",value:function(s){return void 0!==s.send}}]),a;var h}(),textarea;function decodeEntity(a){return(textarea=textarea||document.createElement("textarea")).innerHTML="&"+a+";",textarea.value}var hasOwn=Object.prototype.hasOwnProperty;function has(a,h){return!!a&&hasOwn.call(a,h)}function assign(a){return[].slice.call(arguments,1).forEach(function(s){if(s){if("object"!=_typeof(s))throw new TypeError(s+"must be object");Object.keys(s).forEach(function(u){a[u]=s[u]})}}),a}var UNESCAPE_MD_RE=/\\([\\!"#$%&'()*+,.\/:;<=>?@[\]^_`{|}~-])/g;function unescapeMd(a){return a.indexOf("\\")<0?a:a.replace(UNESCAPE_MD_RE,"$1")}function isValidEntityCode(a){return!(a>=55296&&a<=57343||a>=64976&&a<=65007||65535==(65535&a)||65534==(65535&a)||a>=0&&a<=8||11===a||a>=14&&a<=31||a>=127&&a<=159||a>1114111)}function fromCodePoint(a){return a>65535?(a-=65536,String.fromCharCode(55296+(a>>10),56320+(1023&a))):String.fromCharCode(a)}var NAMED_ENTITY_RE=/&([a-z#][a-z0-9]{1,31});/gi,DIGITAL_ENTITY_TEST_RE=/^#((?:x[a-f0-9]{1,8}|[0-9]{1,8}))/i;function replaceEntityPattern(a,h){var s=0,u=decodeEntity(h);return h!==u?u:35===h.charCodeAt(0)&&DIGITAL_ENTITY_TEST_RE.test(h)&&isValidEntityCode(s="x"===h[1].toLowerCase()?parseInt(h.slice(2),16):parseInt(h.slice(1),10))?fromCodePoint(s):a}function replaceEntities(a){return a.indexOf("&")<0?a:a.replace(NAMED_ENTITY_RE,replaceEntityPattern)}var HTML_ESCAPE_TEST_RE=/[&<>"]/,HTML_ESCAPE_REPLACE_RE=/[&<>"]/g,HTML_REPLACEMENTS={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"};function replaceUnsafeChar(a){return HTML_REPLACEMENTS[a]}function escapeHtml(a){return HTML_ESCAPE_TEST_RE.test(a)?a.replace(HTML_ESCAPE_REPLACE_RE,replaceUnsafeChar):a}var rules={};function nextToken(a,h){return++h>=a.length-2?h:"paragraph_open"===a[h].type&&a[h].tight&&"inline"===a[h+1].type&&0===a[h+1].content.length&&"paragraph_close"===a[h+2].type&&a[h+2].tight?nextToken(a,h+2):h}rules.blockquote_open=function(){return"<blockquote>\n"},rules.blockquote_close=function(a,h){return"</blockquote>"+getBreak(a,h)},rules.code=function(a,h){return a[h].block?"<pre><code>"+escapeHtml(a[h].content)+"</code></pre>"+getBreak(a,h):"<code>"+escapeHtml(a[h].content)+"</code>"},rules.fence=function(a,h,s,u,l){var b,w,d=a[h],p="",m=s.langPrefix;if(d.params){if(w=(b=d.params.split(/\s+/g)).join(" "),has(l.rules.fence_custom,b[0]))return l.rules.fence_custom[b[0]](a,h,s,u,l);p=' class="'+m+escapeHtml(replaceEntities(unescapeMd(w)))+'"'}return"<pre><code"+p+">"+(s.highlight&&s.highlight.apply(s.highlight,[d.content].concat(b))||escapeHtml(d.content))+"</code></pre>"+getBreak(a,h)},rules.fence_custom={},rules.heading_open=function(a,h){return"<h"+a[h].hLevel+">"},rules.heading_close=function(a,h){return"</h"+a[h].hLevel+">\n"},rules.hr=function(a,h,s){return(s.xhtmlOut?"<hr />":"<hr>")+getBreak(a,h)},rules.bullet_list_open=function(){return"<ul>\n"},rules.bullet_list_close=function(a,h){return"</ul>"+getBreak(a,h)},rules.list_item_open=function(){return"<li>"},rules.list_item_close=function(){return"</li>\n"},rules.ordered_list_open=function(a,h){var s=a[h];return"<ol"+(s.order>1?' start="'+s.order+'"':"")+">\n"},rules.ordered_list_close=function(a,h){return"</ol>"+getBreak(a,h)},rules.paragraph_open=function(a,h){return a[h].tight?"":"<p>"},rules.paragraph_close=function(a,h){return(a[h].tight?"":"</p>")+(a[h].tight&&h&&"inline"===a[h-1].type&&!a[h-1].content?"":getBreak(a,h))},rules.link_open=function(a,h,s){var u=a[h].title?' title="'+escapeHtml(replaceEntities(a[h].title))+'"':"",l=s.linkTarget?' target="'+s.linkTarget+'"':"";return'<a href="'+escapeHtml(a[h].href)+'"'+u+l+">"},rules.link_close=function(){return"</a>"},rules.image=function(a,h,s){var u=' src="'+escapeHtml(a[h].src)+'"',l=a[h].title?' title="'+escapeHtml(replaceEntities(a[h].title))+'"':"";return"<img"+u+' alt="'+(a[h].alt?escapeHtml(replaceEntities(unescapeMd(a[h].alt))):"")+'"'+l+(s.xhtmlOut?" /":"")+">"},rules.table_open=function(){return"<table>\n"},rules.table_close=function(){return"</table>\n"},rules.thead_open=function(){return"<thead>\n"},rules.thead_close=function(){return"</thead>\n"},rules.tbody_open=function(){return"<tbody>\n"},rules.tbody_close=function(){return"</tbody>\n"},rules.tr_open=function(){return"<tr>"},rules.tr_close=function(){return"</tr>\n"},rules.th_open=function(a,h){var s=a[h];return"<th"+(s.align?' style="text-align:'+s.align+'"':"")+">"},rules.th_close=function(){return"</th>"},rules.td_open=function(a,h){var s=a[h];return"<td"+(s.align?' style="text-align:'+s.align+'"':"")+">"},rules.td_close=function(){return"</td>"},rules.strong_open=function(){return"<strong>"},rules.strong_close=function(){return"</strong>"},rules.em_open=function(){return"<em>"},rules.em_close=function(){return"</em>"},rules.del_open=function(){return"<del>"},rules.del_close=function(){return"</del>"},rules.ins_open=function(){return"<ins>"},rules.ins_close=function(){return"</ins>"},rules.mark_open=function(){return"<mark>"},rules.mark_close=function(){return"</mark>"},rules.sub=function(a,h){return"<sub>"+escapeHtml(a[h].content)+"</sub>"},rules.sup=function(a,h){return"<sup>"+escapeHtml(a[h].content)+"</sup>"},rules.hardbreak=function(a,h,s){return s.xhtmlOut?"<br />\n":"<br>\n"},rules.softbreak=function(a,h,s){return s.breaks?s.xhtmlOut?"<br />\n":"<br>\n":"\n"},rules.text=function(a,h){return escapeHtml(a[h].content)},rules.htmlblock=function(a,h){return a[h].content},rules.htmltag=function(a,h){return a[h].content},rules.abbr_open=function(a,h){return'<abbr title="'+escapeHtml(replaceEntities(a[h].title))+'">'},rules.abbr_close=function(){return"</abbr>"},rules.footnote_ref=function(a,h){var s=Number(a[h].id+1).toString(),u="fnref"+s;return a[h].subId>0&&(u+=":"+a[h].subId),'<sup class="footnote-ref"><a href="#fn'+s+'" id="'+u+'">['+s+"]</a></sup>"},rules.footnote_block_open=function(a,h,s){return(s.xhtmlOut?'<hr class="footnotes-sep" />\n':'<hr class="footnotes-sep">\n')+'<section class="footnotes">\n<ol class="footnotes-list">\n'},rules.footnote_block_close=function(){return"</ol>\n</section>\n"},rules.footnote_open=function(a,h){return'<li id="fn'+Number(a[h].id+1).toString()+'"  class="footnote-item">'},rules.footnote_close=function(){return"</li>\n"},rules.footnote_anchor=function(a,h){var u="fnref"+Number(a[h].id+1).toString();return a[h].subId>0&&(u+=":"+a[h].subId),' <a href="#'+u+'" class="footnote-backref">\u21a9</a>'},rules.dl_open=function(){return"<dl>\n"},rules.dt_open=function(){return"<dt>"},rules.dd_open=function(){return"<dd>"},rules.dl_close=function(){return"</dl>\n"},rules.dt_close=function(){return"</dt>\n"},rules.dd_close=function(){return"</dd>\n"};var getBreak=rules.getBreak=function(a,h){return(h=nextToken(a,h))<a.length&&"list_item_close"===a[h].type?"":"\n"};function Renderer(){this.rules=assign({},rules),this.getBreak=rules.getBreak}function Ruler(){this.__rules__=[],this.__cache__=null}function block(a){a.inlineMode?a.tokens.push({type:"inline",content:a.src.replace(/\n/g," ").trim(),level:0,lines:[0,1],children:[]}):a.block.parse(a.src,a.options,a.env,a.tokens)}function StateInline(a,h,s,u,l){this.src=a,this.env=u,this.options=s,this.parser=h,this.tokens=l,this.pos=0,this.posMax=this.src.length,this.level=0,this.pending="",this.pendingLevel=0,this.cache=[],this.isInLabel=!1,this.linkLevel=0,this.linkContent="",this.labelUnmatchedScopes=0}function parseLinkLabel(a,h){var s,u,l,d=-1,p=a.posMax,m=a.pos,v=a.isInLabel;if(a.isInLabel)return-1;if(a.labelUnmatchedScopes)return a.labelUnmatchedScopes--,-1;for(a.pos=h+1,a.isInLabel=!0,s=1;a.pos<p;){if(91===(l=a.src.charCodeAt(a.pos)))s++;else if(93===l&&0==--s){u=!0;break}a.parser.skipToken(a)}return u?(d=a.pos,a.labelUnmatchedScopes=0):a.labelUnmatchedScopes=s-1,a.pos=m,a.isInLabel=v,d}function parseAbbr(a,h,s,u){var l,d,p,m,v,b;if(42!==a.charCodeAt(0)||91!==a.charCodeAt(1)||-1===a.indexOf("]:")||(d=parseLinkLabel(l=new StateInline(a,h,s,u,[]),1))<0||58!==a.charCodeAt(d+1))return-1;for(m=l.posMax,p=d+2;p<m&&10!==l.src.charCodeAt(p);p++);return v=a.slice(2,d),0===(b=a.slice(d+2,p).trim()).length?-1:(u.abbreviations||(u.abbreviations={}),_typeof(u.abbreviations[":"+v])>"u"&&(u.abbreviations[":"+v]=b),p)}function abbr(a){var s,u,l,d,h=a.tokens;if(!a.inlineMode)for(s=1,u=h.length-1;s<u;s++)if("paragraph_open"===h[s-1].type&&"inline"===h[s].type&&"paragraph_close"===h[s+1].type){for(l=h[s].content;l.length&&!((d=parseAbbr(l,a.inline,a.options,a.env))<0);)l=l.slice(d).trim();h[s].content=l,l.length||(h[s-1].tight=!0,h[s+1].tight=!0)}}function normalizeLink(a){var h=replaceEntities(a);try{h=decodeURI(h)}catch{}return encodeURI(h)}function parseLinkDestination(a,h){var s,u,l,d=h,p=a.posMax;if(60===a.src.charCodeAt(h)){for(h++;h<p;){if(10===(s=a.src.charCodeAt(h)))return!1;if(62===s)return l=normalizeLink(unescapeMd(a.src.slice(d+1,h))),!!a.parser.validateLink(l)&&(a.pos=h+1,a.linkContent=l,!0);92===s&&h+1<p?h+=2:h++}return!1}for(u=0;h<p&&!(32===(s=a.src.charCodeAt(h))||s<32||127===s);)if(92===s&&h+1<p)h+=2;else{if(40===s&&++u>1||41===s&&--u<0)break;h++}return!(d===h||(l=unescapeMd(a.src.slice(d,h)),!a.parser.validateLink(l))||(a.linkContent=l,a.pos=h,0))}function parseLinkTitle(a,h){var s,u=h,l=a.posMax,d=a.src.charCodeAt(h);if(34!==d&&39!==d&&40!==d)return!1;for(h++,40===d&&(d=41);h<l;){if((s=a.src.charCodeAt(h))===d)return a.pos=h+1,a.linkContent=unescapeMd(a.src.slice(u+1,h)),!0;92===s&&h+1<l?h+=2:h++}return!1}function normalizeReference(a){return a.trim().replace(/\s+/g," ").toUpperCase()}function parseReference(a,h,s,u){var l,d,p,m,v,b,w,S,M;if(91!==a.charCodeAt(0)||-1===a.indexOf("]:")||(d=parseLinkLabel(l=new StateInline(a,h,s,u,[]),0))<0||58!==a.charCodeAt(d+1))return-1;for(m=l.posMax,p=d+2;p<m&&(32===(v=l.src.charCodeAt(p))||10===v);p++);if(!parseLinkDestination(l,p))return-1;for(w=l.linkContent,b=p=l.pos,p+=1;p<m&&(32===(v=l.src.charCodeAt(p))||10===v);p++);for(p<m&&b!==p&&parseLinkTitle(l,p)?(S=l.linkContent,p=l.pos):(S="",p=b);p<m&&32===l.src.charCodeAt(p);)p++;return p<m&&10!==l.src.charCodeAt(p)?-1:(M=normalizeReference(a.slice(1,d)),_typeof(u.references[M])>"u"&&(u.references[M]={title:S,href:w}),p)}function references(a){var s,u,l,d,h=a.tokens;if(a.env.references=a.env.references||{},!a.inlineMode)for(s=1,u=h.length-1;s<u;s++)if("inline"===h[s].type&&"paragraph_open"===h[s-1].type&&"paragraph_close"===h[s+1].type){for(l=h[s].content;l.length&&!((d=parseReference(l,a.inline,a.options,a.env))<0);)l=l.slice(d).trim();h[s].content=l,l.length||(h[s-1].tight=!0,h[s+1].tight=!0)}}function inline(a){var s,u,l,h=a.tokens;for(u=0,l=h.length;u<l;u++)"inline"===(s=h[u]).type&&a.inline.parse(s.content,a.options,a.env,s.children)}function footnote_block(a){var h,s,u,l,d,p,m,v,b,w=0,S=!1,M={};if(a.env.footnotes&&(a.tokens=a.tokens.filter(function(A){return"footnote_reference_open"===A.type?(S=!0,v=[],b=A.label,!1):"footnote_reference_close"===A.type?(S=!1,M[":"+b]=v,!1):(S&&v.push(A),!S)}),a.env.footnotes.list)){for(p=a.env.footnotes.list,a.tokens.push({type:"footnote_block_open",level:w++}),h=0,s=p.length;h<s;h++){for(a.tokens.push({type:"footnote_open",id:h,level:w++}),p[h].tokens?((m=[]).push({type:"paragraph_open",tight:!1,level:w++}),m.push({type:"inline",content:"",level:w,children:p[h].tokens}),m.push({type:"paragraph_close",tight:!1,level:--w})):p[h].label&&(m=M[":"+p[h].label]),a.tokens=a.tokens.concat(m),d="paragraph_close"===a.tokens[a.tokens.length-1].type?a.tokens.pop():null,l=p[h].count>0?p[h].count:1,u=0;u<l;u++)a.tokens.push({type:"footnote_anchor",id:h,subId:u,level:w});d&&a.tokens.push(d),a.tokens.push({type:"footnote_close",level:--w})}a.tokens.push({type:"footnote_block_close",level:--w})}}Renderer.prototype.renderInline=function(a,h,s){for(var u=this.rules,l=a.length,d=0,p="";l--;)p+=u[a[d].type](a,d++,h,s,this);return p},Renderer.prototype.render=function(a,h,s){for(var u=this.rules,l=a.length,d=-1,p="";++d<l;)p+="inline"===a[d].type?this.renderInline(a[d].children,h,s):u[a[d].type](a,d,h,s,this);return p},Ruler.prototype.__find__=function(a){for(var h=this.__rules__.length,s=-1;h--;)if(this.__rules__[++s].name===a)return s;return-1},Ruler.prototype.__compile__=function(){var a=this,h=[""];a.__rules__.forEach(function(s){s.enabled&&s.alt.forEach(function(u){h.indexOf(u)<0&&h.push(u)})}),a.__cache__={},h.forEach(function(s){a.__cache__[s]=[],a.__rules__.forEach(function(u){u.enabled&&(s&&u.alt.indexOf(s)<0||a.__cache__[s].push(u.fn))})})},Ruler.prototype.at=function(a,h,s){var u=this.__find__(a),l=s||{};if(-1===u)throw new Error("Parser rule not found: "+a);this.__rules__[u].fn=h,this.__rules__[u].alt=l.alt||[],this.__cache__=null},Ruler.prototype.before=function(a,h,s,u){var l=this.__find__(a),d=u||{};if(-1===l)throw new Error("Parser rule not found: "+a);this.__rules__.splice(l,0,{name:h,enabled:!0,fn:s,alt:d.alt||[]}),this.__cache__=null},Ruler.prototype.after=function(a,h,s,u){var l=this.__find__(a),d=u||{};if(-1===l)throw new Error("Parser rule not found: "+a);this.__rules__.splice(l+1,0,{name:h,enabled:!0,fn:s,alt:d.alt||[]}),this.__cache__=null},Ruler.prototype.push=function(a,h,s){this.__rules__.push({name:a,enabled:!0,fn:h,alt:(s||{}).alt||[]}),this.__cache__=null},Ruler.prototype.enable=function(a,h){a=Array.isArray(a)?a:[a],h&&this.__rules__.forEach(function(s){s.enabled=!1}),a.forEach(function(s){var u=this.__find__(s);if(u<0)throw new Error("Rules manager: invalid rule name "+s);this.__rules__[u].enabled=!0},this),this.__cache__=null},Ruler.prototype.disable=function(a){(a=Array.isArray(a)?a:[a]).forEach(function(h){var s=this.__find__(h);if(s<0)throw new Error("Rules manager: invalid rule name "+h);this.__rules__[s].enabled=!1},this),this.__cache__=null},Ruler.prototype.getRules=function(a){return null===this.__cache__&&this.__compile__(),this.__cache__[a]||[]},StateInline.prototype.pushPending=function(){this.tokens.push({type:"text",content:this.pending,level:this.pendingLevel}),this.pending=""},StateInline.prototype.push=function(a){this.pending&&this.pushPending(),this.tokens.push(a),this.pendingLevel=this.level},StateInline.prototype.cacheSet=function(a,h){for(var s=this.cache.length;s<=a;s++)this.cache.push(0);this.cache[a]=h},StateInline.prototype.cacheGet=function(a){return a<this.cache.length?this.cache[a]:0};var PUNCT_CHARS=" \n()[]'\".,!?-";function regEscape(a){return a.replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1")}function abbr2(a){var h,s,u,l,d,p,m,v,b,w,S,M,A=a.tokens;if(a.env.abbreviations)for(a.env.abbrRegExp||(M="(^|["+PUNCT_CHARS.split("").map(regEscape).join("")+"])("+Object.keys(a.env.abbreviations).map(function(k){return k.substr(1)}).sort(function(k,N){return N.length-k.length}).map(regEscape).join("|")+")($|["+PUNCT_CHARS.split("").map(regEscape).join("")+"])",a.env.abbrRegExp=new RegExp(M,"g")),w=a.env.abbrRegExp,s=0,u=A.length;s<u;s++)if("inline"===A[s].type)for(h=(l=A[s].children).length-1;h>=0;h--)if("text"===(d=l[h]).type){for(v=0,p=d.content,w.lastIndex=0,b=d.level,m=[];S=w.exec(p);)w.lastIndex>v&&m.push({type:"text",content:p.slice(v,S.index+S[1].length),level:b}),m.push({type:"abbr_open",title:a.env.abbreviations[":"+S[2]],level:b++}),m.push({type:"text",content:S[2],level:b}),m.push({type:"abbr_close",level:--b}),v=w.lastIndex-S[3].length;m.length&&(v<p.length&&m.push({type:"text",content:p.slice(v),level:b}),A[s].children=l=[].concat(l.slice(0,h),m,l.slice(h+1)))}}var RARE_RE=/\+-|\.\.|\?\?\?\?|!!!!|,,|--/,SCOPED_ABBR_RE=/\((c|tm|r|p)\)/gi,SCOPED_ABBR={c:"\xa9",r:"\xae",p:"\xa7",tm:"\u2122"};function replaceScopedAbbr(a){return a.indexOf("(")<0?a:a.replace(SCOPED_ABBR_RE,function(h,s){return SCOPED_ABBR[s.toLowerCase()]})}function replace(a){var h,s,u,l,d;if(a.options.typographer)for(d=a.tokens.length-1;d>=0;d--)if("inline"===a.tokens[d].type)for(h=(l=a.tokens[d].children).length-1;h>=0;h--)"text"===(s=l[h]).type&&(u=replaceScopedAbbr(u=s.content),RARE_RE.test(u)&&(u=u.replace(/\+-/g,"\xb1").replace(/\.{2,}/g,"\u2026").replace(/([?!])\u2026/g,"$1..").replace(/([?!]){4,}/g,"$1$1$1").replace(/,{2,}/g,",").replace(/(^|[^-])---([^-]|$)/gm,"$1\u2014$2").replace(/(^|\s)--(\s|$)/gm,"$1\u2013$2").replace(/(^|[^-\s])--([^-\s]|$)/gm,"$1\u2013$2")),s.content=u)}var QUOTE_TEST_RE=/['"]/,QUOTE_RE=/['"]/g,PUNCT_RE=/[-\s()\[\]]/,APOSTROPHE="\u2019";function isLetter(a,h){return!(h<0||h>=a.length||PUNCT_RE.test(a[h]))}function replaceAt(a,h,s){return a.substr(0,h)+s+a.substr(h+1)}function smartquotes(a){var h,s,u,l,d,p,m,v,b,w,S,M,A,k,N,B,z;if(a.options.typographer)for(z=[],N=a.tokens.length-1;N>=0;N--)if("inline"===a.tokens[N].type)for(B=a.tokens[N].children,z.length=0,h=0;h<B.length;h++)if("text"===(s=B[h]).type&&!QUOTE_TEST_RE.test(s.text)){for(m=B[h].level,A=z.length-1;A>=0&&!(z[A].level<=m);A--);z.length=A+1,d=0,p=(u=s.content).length;e:for(;d<p&&(QUOTE_RE.lastIndex=d,l=QUOTE_RE.exec(u),l);)if(v=!isLetter(u,l.index-1),k="'"===l[0],(b=!isLetter(u,d=l.index+1))||v){if(S=!b,M=!v)for(A=z.length-1;A>=0&&(w=z[A],!(z[A].level<m));A--)if(w.single===k&&z[A].level===m){w=z[A],k?(B[w.token].content=replaceAt(B[w.token].content,w.pos,a.options.quotes[2]),s.content=replaceAt(s.content,l.index,a.options.quotes[3])):(B[w.token].content=replaceAt(B[w.token].content,w.pos,a.options.quotes[0]),s.content=replaceAt(s.content,l.index,a.options.quotes[1])),z.length=A;continue e}S?z.push({token:h,pos:l.index,single:k,level:m}):M&&k&&(s.content=replaceAt(s.content,l.index,APOSTROPHE))}else k&&(s.content=replaceAt(s.content,l.index,APOSTROPHE))}}var _rules=[["block",block],["abbr",abbr],["references",references],["inline",inline],["footnote_tail",footnote_block],["abbr2",abbr2],["replacements",replace],["smartquotes",smartquotes]];function Core(){this.options={},this.ruler=new Ruler;for(var a=0;a<_rules.length;a++)this.ruler.push(_rules[a][0],_rules[a][1])}function StateBlock(a,h,s,u,l){var d,p,m,v,b,w,S;for(this.src=a,this.parser=h,this.options=s,this.env=u,this.tokens=l,this.bMarks=[],this.eMarks=[],this.tShift=[],this.blkIndent=0,this.line=0,this.lineMax=0,this.tight=!1,this.parentType="root",this.ddIndent=-1,this.level=0,this.result="",w=0,S=!1,m=v=w=0,b=(p=this.src).length;v<b;v++){if(d=p.charCodeAt(v),!S){if(32===d){w++;continue}S=!0}(10===d||v===b-1)&&(10!==d&&v++,this.bMarks.push(m),this.eMarks.push(v),this.tShift.push(w),S=!1,w=0,m=v+1)}this.bMarks.push(p.length),this.eMarks.push(p.length),this.tShift.push(0),this.lineMax=this.bMarks.length-1}function code(a,h,s){var u,l;if(a.tShift[h]-a.blkIndent<4)return!1;for(l=u=h+1;u<s;)if(a.isEmpty(u))u++;else{if(!(a.tShift[u]-a.blkIndent>=4))break;l=++u}return a.line=u,a.tokens.push({type:"code",content:a.getLines(h,l,4+a.blkIndent,!0),block:!0,lines:[h,a.line],level:a.level}),!0}function fences(a,h,s,u){var l,d,p,m,v,b=!1,w=a.bMarks[h]+a.tShift[h],S=a.eMarks[h];if(w+3>S||126!==(l=a.src.charCodeAt(w))&&96!==l||(v=w,(d=(w=a.skipChars(w,l))-v)<3)||(p=a.src.slice(w,S).trim()).indexOf("`")>=0)return!1;if(u)return!0;for(m=h;!(++m>=s||(w=v=a.bMarks[m]+a.tShift[m],S=a.eMarks[m],w<S&&a.tShift[m]<a.blkIndent));)if(!(a.src.charCodeAt(w)!==l||a.tShift[m]-a.blkIndent>=4||(w=a.skipChars(w,l),w-v<d||(w=a.skipSpaces(w),w<S)))){b=!0;break}return d=a.tShift[h],a.line=m+(b?1:0),a.tokens.push({type:"fence",params:p,content:a.getLines(h+1,m,d,!0),lines:[h,a.line],level:a.level}),!0}function blockquote(a,h,s,u){var l,d,p,m,v,b,w,S,M,A,k,N=a.bMarks[h]+a.tShift[h],B=a.eMarks[h];if(N>B||62!==a.src.charCodeAt(N++)||a.level>=a.options.maxNesting)return!1;if(u)return!0;for(32===a.src.charCodeAt(N)&&N++,v=a.blkIndent,a.blkIndent=0,m=[a.bMarks[h]],a.bMarks[h]=N,d=(N=N<B?a.skipSpaces(N):N)>=B,p=[a.tShift[h]],a.tShift[h]=N-a.bMarks[h],S=a.parser.ruler.getRules("blockquote"),l=h+1;l<s&&!((N=a.bMarks[l]+a.tShift[l])>=(B=a.eMarks[l]));l++)if(62!==a.src.charCodeAt(N++)){if(d)break;for(k=!1,M=0,A=S.length;M<A;M++)if(S[M](a,l,s,!0)){k=!0;break}if(k)break;m.push(a.bMarks[l]),p.push(a.tShift[l]),a.tShift[l]=-1337}else 32===a.src.charCodeAt(N)&&N++,m.push(a.bMarks[l]),a.bMarks[l]=N,d=(N=N<B?a.skipSpaces(N):N)>=B,p.push(a.tShift[l]),a.tShift[l]=N-a.bMarks[l];for(b=a.parentType,a.parentType="blockquote",a.tokens.push({type:"blockquote_open",lines:w=[h,0],level:a.level++}),a.parser.tokenize(a,h,l),a.tokens.push({type:"blockquote_close",level:--a.level}),a.parentType=b,w[1]=a.line,M=0;M<p.length;M++)a.bMarks[M+h]=m[M],a.tShift[M+h]=p[M];return a.blkIndent=v,!0}function hr(a,h,s,u){var l,d,p,m=a.bMarks[h],v=a.eMarks[h];if((m+=a.tShift[h])>v||42!==(l=a.src.charCodeAt(m++))&&45!==l&&95!==l)return!1;for(d=1;m<v;){if((p=a.src.charCodeAt(m++))!==l&&32!==p)return!1;p===l&&d++}return!(d<3||(u||(a.line=h+1,a.tokens.push({type:"hr",lines:[h,a.line],level:a.level})),0))}function skipBulletListMarker(a,h){var s,u,l;return(u=a.bMarks[h]+a.tShift[h])>=(l=a.eMarks[h])||42!==(s=a.src.charCodeAt(u++))&&45!==s&&43!==s||u<l&&32!==a.src.charCodeAt(u)?-1:u}function skipOrderedListMarker(a,h){var s,u=a.bMarks[h]+a.tShift[h],l=a.eMarks[h];if(u+1>=l||(s=a.src.charCodeAt(u++))<48||s>57)return-1;for(;;){if(u>=l)return-1;if(!((s=a.src.charCodeAt(u++))>=48&&s<=57)){if(41===s||46===s)break;return-1}}return u<l&&32!==a.src.charCodeAt(u)?-1:u}function markTightParagraphs(a,h){var s,u,l=a.level+2;for(s=h+2,u=a.tokens.length-2;s<u;s++)a.tokens[s].level===l&&"paragraph_open"===a.tokens[s].type&&(a.tokens[s+2].tight=!0,a.tokens[s].tight=!0,s+=2)}function list(a,h,s,u){var l,d,p,m,v,b,w,S,A,k,N,B,z,G,te,be,me,we,Ge,ve,xe,oe=!0;if((S=skipOrderedListMarker(a,h))>=0)B=!0;else{if(!((S=skipBulletListMarker(a,h))>=0))return!1;B=!1}if(a.level>=a.options.maxNesting)return!1;if(N=a.src.charCodeAt(S-1),u)return!0;for(G=a.tokens.length,B?(w=a.bMarks[h]+a.tShift[h],k=Number(a.src.substr(w,S-w-1)),a.tokens.push({type:"ordered_list_open",order:k,lines:be=[h,0],level:a.level++})):a.tokens.push({type:"bullet_list_open",lines:be=[h,0],level:a.level++}),l=h,te=!1,we=a.parser.ruler.getRules("list");l<s&&((A=(z=a.skipSpaces(S))>=a.eMarks[l]?1:z-S)>4&&(A=1),A<1&&(A=1),d=S-a.bMarks[l]+A,a.tokens.push({type:"list_item_open",lines:me=[h,0],level:a.level++}),m=a.blkIndent,v=a.tight,p=a.tShift[h],b=a.parentType,a.tShift[h]=z-a.bMarks[h],a.blkIndent=d,a.tight=!0,a.parentType="list",a.parser.tokenize(a,h,s,!0),(!a.tight||te)&&(oe=!1),te=a.line-h>1&&a.isEmpty(a.line-1),a.blkIndent=m,a.tShift[h]=p,a.tight=v,a.parentType=b,a.tokens.push({type:"list_item_close",level:--a.level}),l=h=a.line,me[1]=l,z=a.bMarks[h],!(l>=s||a.isEmpty(l)||a.tShift[l]<a.blkIndent));){for(xe=!1,Ge=0,ve=we.length;Ge<ve;Ge++)if(we[Ge](a,l,s,!0)){xe=!0;break}if(xe)break;if(B){if((S=skipOrderedListMarker(a,l))<0)break}else if((S=skipBulletListMarker(a,l))<0)break;if(N!==a.src.charCodeAt(S-1))break}return a.tokens.push({type:B?"ordered_list_close":"bullet_list_close",level:--a.level}),be[1]=l,a.line=l,oe&&markTightParagraphs(a,G),!0}function footnote(a,h,s,u){var l,d,p,m,v,b=a.bMarks[h]+a.tShift[h],w=a.eMarks[h];if(b+4>w||91!==a.src.charCodeAt(b)||94!==a.src.charCodeAt(b+1)||a.level>=a.options.maxNesting)return!1;for(m=b+2;m<w;m++){if(32===a.src.charCodeAt(m))return!1;if(93===a.src.charCodeAt(m))break}return!(m===b+2||m+1>=w||58!==a.src.charCodeAt(++m)||(u||(m++,a.env.footnotes||(a.env.footnotes={}),a.env.footnotes.refs||(a.env.footnotes.refs={}),v=a.src.slice(b+2,m-2),a.env.footnotes.refs[":"+v]=-1,a.tokens.push({type:"footnote_reference_open",label:v,level:a.level++}),l=a.bMarks[h],d=a.tShift[h],p=a.parentType,a.tShift[h]=a.skipSpaces(m)-m,a.bMarks[h]=m,a.blkIndent+=4,a.parentType="footnote",a.tShift[h]<a.blkIndent&&(a.tShift[h]+=a.blkIndent,a.bMarks[h]-=a.blkIndent),a.parser.tokenize(a,h,s,!0),a.parentType=p,a.blkIndent-=4,a.tShift[h]=d,a.bMarks[h]=l,a.tokens.push({type:"footnote_reference_close",level:--a.level})),0))}function heading(a,h,s,u){var l,d,p,m=a.bMarks[h]+a.tShift[h],v=a.eMarks[h];if(m>=v||35!==(l=a.src.charCodeAt(m))||m>=v)return!1;for(d=1,l=a.src.charCodeAt(++m);35===l&&m<v&&d<=6;)d++,l=a.src.charCodeAt(++m);return!(d>6||m<v&&32!==l||(u||(v=a.skipCharsBack(v,32,m),(p=a.skipCharsBack(v,35,m))>m&&32===a.src.charCodeAt(p-1)&&(v=p),a.line=h+1,a.tokens.push({type:"heading_open",hLevel:d,lines:[h,a.line],level:a.level}),m<v&&a.tokens.push({type:"inline",content:a.src.slice(m,v).trim(),level:a.level+1,lines:[h,a.line],children:[]}),a.tokens.push({type:"heading_close",hLevel:d,level:a.level})),0))}function lheading(a,h,s){var u,l,d,p=h+1;return!(p>=s||a.tShift[p]<a.blkIndent||a.tShift[p]-a.blkIndent>3||(l=a.bMarks[p]+a.tShift[p],d=a.eMarks[p],l>=d)||(u=a.src.charCodeAt(l),45!==u&&61!==u)||(l=a.skipChars(l,u),l=a.skipSpaces(l),l<d)||(l=a.bMarks[h]+a.tShift[h],a.line=p+1,a.tokens.push({type:"heading_open",hLevel:61===u?1:2,lines:[h,a.line],level:a.level}),a.tokens.push({type:"inline",content:a.src.slice(l,a.eMarks[h]).trim(),level:a.level+1,lines:[h,a.line-1],children:[]}),a.tokens.push({type:"heading_close",hLevel:61===u?1:2,level:a.level}),0))}Core.prototype.process=function(a){var h,s,u;for(h=0,s=(u=this.ruler.getRules("")).length;h<s;h++)u[h](a)},StateBlock.prototype.isEmpty=function(a){return this.bMarks[a]+this.tShift[a]>=this.eMarks[a]},StateBlock.prototype.skipEmptyLines=function(a){for(var h=this.lineMax;a<h&&!(this.bMarks[a]+this.tShift[a]<this.eMarks[a]);a++);return a},StateBlock.prototype.skipSpaces=function(a){for(var h=this.src.length;a<h&&32===this.src.charCodeAt(a);a++);return a},StateBlock.prototype.skipChars=function(a,h){for(var s=this.src.length;a<s&&this.src.charCodeAt(a)===h;a++);return a},StateBlock.prototype.skipCharsBack=function(a,h,s){if(a<=s)return a;for(;a>s;)if(h!==this.src.charCodeAt(--a))return a+1;return a},StateBlock.prototype.getLines=function(a,h,s,u){var l,d,m,v,b=a;if(a>=h)return"";if(b+1===h)return d=this.bMarks[b]+Math.min(this.tShift[b],s),this.src.slice(d,u?this.eMarks[b]+1:this.eMarks[b]);for(m=new Array(h-a),l=0;b<h;b++,l++)(v=this.tShift[b])>s&&(v=s),v<0&&(v=0),m[l]=this.src.slice(d=this.bMarks[b]+v,b+1<h||u?this.eMarks[b]+1:this.eMarks[b]);return m.join("")};var html_blocks={};["article","aside","button","blockquote","body","canvas","caption","col","colgroup","dd","div","dl","dt","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","iframe","li","map","object","ol","output","p","pre","progress","script","section","style","table","tbody","td","textarea","tfoot","th","tr","thead","ul","video"].forEach(function(a){html_blocks[a]=!0});var HTML_TAG_OPEN_RE=/^<([a-zA-Z]{1,15})[\s\/>]/,HTML_TAG_CLOSE_RE=/^<\/([a-zA-Z]{1,15})[\s>]/;function isLetter$1(a){var h=32|a;return h>=97&&h<=122}function htmlblock(a,h,s,u){var l,d,p,m=a.bMarks[h],v=a.eMarks[h],b=a.tShift[h];if(m+=b,!a.options.html||b>3||m+2>=v||60!==a.src.charCodeAt(m))return!1;if(33===(l=a.src.charCodeAt(m+1))||63===l){if(u)return!0}else{if(47!==l&&!isLetter$1(l))return!1;if(47===l){if(!(d=a.src.slice(m,v).match(HTML_TAG_CLOSE_RE)))return!1}else if(!(d=a.src.slice(m,v).match(HTML_TAG_OPEN_RE)))return!1;if(!0!==html_blocks[d[1].toLowerCase()])return!1;if(u)return!0}for(p=h+1;p<a.lineMax&&!a.isEmpty(p);)p++;return a.line=p,a.tokens.push({type:"htmlblock",level:a.level,lines:[h,a.line],content:a.getLines(h,p,0,!0)}),!0}function getLine(a,h){var s=a.bMarks[h]+a.blkIndent;return a.src.substr(s,a.eMarks[h]-s)}function table(a,h,s,u){var l,d,p,m,v,b,w,S,M,A,k;if(h+2>s||a.tShift[v=h+1]<a.blkIndent||(p=a.bMarks[v]+a.tShift[v])>=a.eMarks[v]||124!==(l=a.src.charCodeAt(p))&&45!==l&&58!==l||(d=getLine(a,h+1),!/^[-:| ]+$/.test(d))||(b=d.split("|"))<=2)return!1;for(S=[],m=0;m<b.length;m++){if(!(M=b[m].trim())){if(0===m||m===b.length-1)continue;return!1}if(!/^:?-+:?$/.test(M))return!1;58===M.charCodeAt(M.length-1)?S.push(58===M.charCodeAt(0)?"center":"right"):58===M.charCodeAt(0)?S.push("left"):S.push("")}if(-1===(d=getLine(a,h).trim()).indexOf("|")||(b=d.replace(/^\||\|$/g,"").split("|"),S.length!==b.length))return!1;if(u)return!0;for(a.tokens.push({type:"table_open",lines:A=[h,0],level:a.level++}),a.tokens.push({type:"thead_open",lines:[h,h+1],level:a.level++}),a.tokens.push({type:"tr_open",lines:[h,h+1],level:a.level++}),m=0;m<b.length;m++)a.tokens.push({type:"th_open",align:S[m],lines:[h,h+1],level:a.level++}),a.tokens.push({type:"inline",content:b[m].trim(),lines:[h,h+1],level:a.level,children:[]}),a.tokens.push({type:"th_close",level:--a.level});for(a.tokens.push({type:"tr_close",level:--a.level}),a.tokens.push({type:"thead_close",level:--a.level}),a.tokens.push({type:"tbody_open",lines:k=[h+2,0],level:a.level++}),v=h+2;v<s&&!(a.tShift[v]<a.blkIndent||(d=getLine(a,v).trim(),-1===d.indexOf("|")));v++){for(b=d.replace(/^\||\|$/g,"").split("|"),a.tokens.push({type:"tr_open",level:a.level++}),m=0;m<b.length;m++)a.tokens.push({type:"td_open",align:S[m],level:a.level++}),w=b[m].substring(124===b[m].charCodeAt(0)?1:0,124===b[m].charCodeAt(b[m].length-1)?b[m].length-1:b[m].length).trim(),a.tokens.push({type:"inline",content:w,level:a.level,children:[]}),a.tokens.push({type:"td_close",level:--a.level});a.tokens.push({type:"tr_close",level:--a.level})}return a.tokens.push({type:"tbody_close",level:--a.level}),a.tokens.push({type:"table_close",level:--a.level}),A[1]=k[1]=v,a.line=v,!0}function skipMarker(a,h){var s,u,l=a.bMarks[h]+a.tShift[h],d=a.eMarks[h];return l>=d||126!==(u=a.src.charCodeAt(l++))&&58!==u||l===(s=a.skipSpaces(l))||s>=d?-1:s}function markTightParagraphs$1(a,h){var s,u,l=a.level+2;for(s=h+2,u=a.tokens.length-2;s<u;s++)a.tokens[s].level===l&&"paragraph_open"===a.tokens[s].type&&(a.tokens[s+2].tight=!0,a.tokens[s].tight=!0,s+=2)}function deflist(a,h,s,u){var l,d,p,m,v,b,w,S,M,A,k,N,B,z;if(u)return!(a.ddIndent<0)&&skipMarker(a,h)>=0;if(a.isEmpty(w=h+1)&&++w>s||a.tShift[w]<a.blkIndent||(l=skipMarker(a,w))<0||a.level>=a.options.maxNesting)return!1;b=a.tokens.length,a.tokens.push({type:"dl_open",lines:v=[h,0],level:a.level++}),p=h,d=w;e:for(;;){for(z=!0,B=!1,a.tokens.push({type:"dt_open",lines:[p,p],level:a.level++}),a.tokens.push({type:"inline",content:a.getLines(p,p+1,a.blkIndent,!1).trim(),level:a.level+1,lines:[p,p],children:[]}),a.tokens.push({type:"dt_close",level:--a.level});;){if(a.tokens.push({type:"dd_open",lines:m=[w,0],level:a.level++}),N=a.tight,M=a.ddIndent,S=a.blkIndent,k=a.tShift[d],A=a.parentType,a.blkIndent=a.ddIndent=a.tShift[d]+2,a.tShift[d]=l-a.bMarks[d],a.tight=!0,a.parentType="deflist",a.parser.tokenize(a,d,s,!0),(!a.tight||B)&&(z=!1),B=a.line-d>1&&a.isEmpty(a.line-1),a.tShift[d]=k,a.tight=N,a.parentType=A,a.blkIndent=S,a.ddIndent=M,a.tokens.push({type:"dd_close",level:--a.level}),m[1]=w=a.line,w>=s||a.tShift[w]<a.blkIndent)break e;if((l=skipMarker(a,w))<0)break;d=w}if(w>=s||a.isEmpty(p=w)||a.tShift[p]<a.blkIndent||(d=p+1)>=s||(a.isEmpty(d)&&d++,d>=s)||a.tShift[d]<a.blkIndent||(l=skipMarker(a,d))<0)break}return a.tokens.push({type:"dl_close",level:--a.level}),v[1]=w,a.line=w,z&&markTightParagraphs$1(a,b),!0}function paragraph(a,h){var s,u,l,d,p,v,m=h+1;if(m<(s=a.lineMax)&&!a.isEmpty(m))for(v=a.parser.ruler.getRules("paragraph");m<s&&!a.isEmpty(m);m++)if(!(a.tShift[m]-a.blkIndent>3)){for(l=!1,d=0,p=v.length;d<p;d++)if(v[d](a,m,s,!0)){l=!0;break}if(l)break}return u=a.getLines(h,m,a.blkIndent,!1).trim(),a.line=m,u.length&&(a.tokens.push({type:"paragraph_open",tight:!1,lines:[h,a.line],level:a.level}),a.tokens.push({type:"inline",content:u,level:a.level+1,lines:[h,a.line],children:[]}),a.tokens.push({type:"paragraph_close",tight:!1,level:a.level})),!0}var _rules$1=[["code",code],["fences",fences,["paragraph","blockquote","list"]],["blockquote",blockquote,["paragraph","blockquote","list"]],["hr",hr,["paragraph","blockquote","list"]],["list",list,["paragraph","blockquote"]],["footnote",footnote,["paragraph"]],["heading",heading,["paragraph","blockquote"]],["lheading",lheading],["htmlblock",htmlblock,["paragraph","blockquote"]],["table",table,["paragraph"]],["deflist",deflist,["paragraph"]],["paragraph",paragraph]];function ParserBlock(){this.ruler=new Ruler;for(var a=0;a<_rules$1.length;a++)this.ruler.push(_rules$1[a][0],_rules$1[a][1],{alt:(_rules$1[a][2]||[]).slice()})}ParserBlock.prototype.tokenize=function(a,h,s){for(var v,u=this.ruler.getRules(""),l=u.length,d=h,p=!1;d<s&&(a.line=d=a.skipEmptyLines(d),!(d>=s||a.tShift[d]<a.blkIndent));){for(v=0;v<l&&!u[v](a,d,s,!1);v++);if(a.tight=!p,a.isEmpty(a.line-1)&&(p=!0),(d=a.line)<s&&a.isEmpty(d)){if(p=!0,++d<s&&"list"===a.parentType&&a.isEmpty(d))break;a.line=d}}};var TABS_SCAN_RE=/[\n\t]/g,NEWLINES_RE=/\r[\n\u0085]|[\u2424\u2028\u0085]/g,SPACES_RE=/\u00a0/g;function isTerminatorChar(a){switch(a){case 10:case 92:case 96:case 42:case 95:case 94:case 91:case 93:case 33:case 38:case 60:case 62:case 123:case 125:case 36:case 37:case 64:case 126:case 43:case 61:case 58:return!0;default:return!1}}function text$1(a,h){for(var s=a.pos;s<a.posMax&&!isTerminatorChar(a.src.charCodeAt(s));)s++;return s!==a.pos&&(h||(a.pending+=a.src.slice(a.pos,s)),a.pos=s,!0)}function newline(a,h){var s,u,l=a.pos;if(10!==a.src.charCodeAt(l))return!1;if(s=a.pending.length-1,u=a.posMax,!h)if(s>=0&&32===a.pending.charCodeAt(s))if(s>=1&&32===a.pending.charCodeAt(s-1)){for(var d=s-2;d>=0;d--)if(32!==a.pending.charCodeAt(d)){a.pending=a.pending.substring(0,d+1);break}a.push({type:"hardbreak",level:a.level})}else a.pending=a.pending.slice(0,-1),a.push({type:"softbreak",level:a.level});else a.push({type:"softbreak",level:a.level});for(l++;l<u&&32===a.src.charCodeAt(l);)l++;return a.pos=l,!0}ParserBlock.prototype.parse=function(a,h,s,u){var l,d=0,p=0;if(!a)return[];(a=(a=a.replace(SPACES_RE," ")).replace(NEWLINES_RE,"\n")).indexOf("\t")>=0&&(a=a.replace(TABS_SCAN_RE,function(m,v){var b;return 10===a.charCodeAt(v)?(d=v+1,p=0,m):(b="    ".slice((v-d-p)%4),p=v-d+1,b)})),l=new StateBlock(a,this,h,s,u),this.tokenize(l,l.line,l.lineMax)};for(var ESCAPED=[],i=0;i<256;i++)ESCAPED.push(0);function escape(a,h){var s,u=a.pos,l=a.posMax;if(92!==a.src.charCodeAt(u))return!1;if(++u<l){if((s=a.src.charCodeAt(u))<256&&0!==ESCAPED[s])return h||(a.pending+=a.src[u]),a.pos+=2,!0;if(10===s){for(h||a.push({type:"hardbreak",level:a.level}),u++;u<l&&32===a.src.charCodeAt(u);)u++;return a.pos=u,!0}}return h||(a.pending+="\\"),a.pos++,!0}function backticks(a,h){var s,u,l,d,p,m=a.pos;if(96!==a.src.charCodeAt(m))return!1;for(s=m,m++,u=a.posMax;m<u&&96===a.src.charCodeAt(m);)m++;for(l=a.src.slice(s,m),d=p=m;-1!==(d=a.src.indexOf("`",p));){for(p=d+1;p<u&&96===a.src.charCodeAt(p);)p++;if(p-d===l.length)return h||a.push({type:"code",content:a.src.slice(m,d).replace(/[ \n]+/g," ").trim(),block:!1,level:a.level}),a.pos=p,!0}return h||(a.pending+=l),a.pos+=l.length,!0}function del(a,h){var s,u,l,m,v,d=a.posMax,p=a.pos;if(126!==a.src.charCodeAt(p)||h||p+4>=d||126!==a.src.charCodeAt(p+1)||a.level>=a.options.maxNesting||(m=p>0?a.src.charCodeAt(p-1):-1,v=a.src.charCodeAt(p+2),126===m)||126===v||32===v||10===v)return!1;for(u=p+2;u<d&&126===a.src.charCodeAt(u);)u++;if(u>p+3)return a.pos+=u-p,h||(a.pending+=a.src.slice(p,u)),!0;for(a.pos=p+2,l=1;a.pos+1<d;){if(126===a.src.charCodeAt(a.pos)&&126===a.src.charCodeAt(a.pos+1)&&(m=a.src.charCodeAt(a.pos-1),126!==(v=a.pos+2<d?a.src.charCodeAt(a.pos+2):-1)&&126!==m&&(32!==m&&10!==m?l--:32!==v&&10!==v&&l++,l<=0))){s=!0;break}a.parser.skipToken(a)}return s?(a.posMax=a.pos,a.pos=p+2,h||(a.push({type:"del_open",level:a.level++}),a.parser.tokenize(a),a.push({type:"del_close",level:--a.level})),a.pos=a.posMax+2,a.posMax=d,!0):(a.pos=p,!1)}function ins(a,h){var s,u,l,m,v,d=a.posMax,p=a.pos;if(43!==a.src.charCodeAt(p)||h||p+4>=d||43!==a.src.charCodeAt(p+1)||a.level>=a.options.maxNesting||(m=p>0?a.src.charCodeAt(p-1):-1,v=a.src.charCodeAt(p+2),43===m)||43===v||32===v||10===v)return!1;for(u=p+2;u<d&&43===a.src.charCodeAt(u);)u++;if(u!==p+2)return a.pos+=u-p,h||(a.pending+=a.src.slice(p,u)),!0;for(a.pos=p+2,l=1;a.pos+1<d;){if(43===a.src.charCodeAt(a.pos)&&43===a.src.charCodeAt(a.pos+1)&&(m=a.src.charCodeAt(a.pos-1),43!==(v=a.pos+2<d?a.src.charCodeAt(a.pos+2):-1)&&43!==m&&(32!==m&&10!==m?l--:32!==v&&10!==v&&l++,l<=0))){s=!0;break}a.parser.skipToken(a)}return s?(a.posMax=a.pos,a.pos=p+2,h||(a.push({type:"ins_open",level:a.level++}),a.parser.tokenize(a),a.push({type:"ins_close",level:--a.level})),a.pos=a.posMax+2,a.posMax=d,!0):(a.pos=p,!1)}function mark(a,h){var s,u,l,m,v,d=a.posMax,p=a.pos;if(61!==a.src.charCodeAt(p)||h||p+4>=d||61!==a.src.charCodeAt(p+1)||a.level>=a.options.maxNesting||(m=p>0?a.src.charCodeAt(p-1):-1,v=a.src.charCodeAt(p+2),61===m)||61===v||32===v||10===v)return!1;for(u=p+2;u<d&&61===a.src.charCodeAt(u);)u++;if(u!==p+2)return a.pos+=u-p,h||(a.pending+=a.src.slice(p,u)),!0;for(a.pos=p+2,l=1;a.pos+1<d;){if(61===a.src.charCodeAt(a.pos)&&61===a.src.charCodeAt(a.pos+1)&&(m=a.src.charCodeAt(a.pos-1),61!==(v=a.pos+2<d?a.src.charCodeAt(a.pos+2):-1)&&61!==m&&(32!==m&&10!==m?l--:32!==v&&10!==v&&l++,l<=0))){s=!0;break}a.parser.skipToken(a)}return s?(a.posMax=a.pos,a.pos=p+2,h||(a.push({type:"mark_open",level:a.level++}),a.parser.tokenize(a),a.push({type:"mark_close",level:--a.level})),a.pos=a.posMax+2,a.posMax=d,!0):(a.pos=p,!1)}function isAlphaNum(a){return a>=48&&a<=57||a>=65&&a<=90||a>=97&&a<=122}function scanDelims(a,h){var u,l,d,s=h,p=!0,m=!0,v=a.posMax,b=a.src.charCodeAt(h);for(u=h>0?a.src.charCodeAt(h-1):-1;s<v&&a.src.charCodeAt(s)===b;)s++;return s>=v&&(p=!1),(d=s-h)>=4?p=m=!1:((32===(l=s<v?a.src.charCodeAt(s):-1)||10===l)&&(p=!1),(32===u||10===u)&&(m=!1),95===b&&(isAlphaNum(u)&&(p=!1),isAlphaNum(l)&&(m=!1))),{can_open:p,can_close:m,delims:d}}function emphasis(a,h){var s,u,l,d,p,m,v,b=a.posMax,w=a.pos,S=a.src.charCodeAt(w);if(95!==S&&42!==S||h)return!1;if(s=(v=scanDelims(a,w)).delims,!v.can_open)return a.pos+=s,h||(a.pending+=a.src.slice(w,a.pos)),!0;if(a.level>=a.options.maxNesting)return!1;for(a.pos=w+s,m=[s];a.pos<b;)if(a.src.charCodeAt(a.pos)!==S)a.parser.skipToken(a);else{if(u=(v=scanDelims(a,a.pos)).delims,v.can_close){for(d=m.pop(),p=u;d!==p;){if(p<d){m.push(d-p);break}if(p-=d,0===m.length)break;a.pos+=d,d=m.pop()}if(0===m.length){s=d,l=!0;break}a.pos+=u;continue}v.can_open&&m.push(u),a.pos+=u}return l?(a.posMax=a.pos,a.pos=w+s,h||((2===s||3===s)&&a.push({type:"strong_open",level:a.level++}),(1===s||3===s)&&a.push({type:"em_open",level:a.level++}),a.parser.tokenize(a),(1===s||3===s)&&a.push({type:"em_close",level:--a.level}),(2===s||3===s)&&a.push({type:"strong_close",level:--a.level})),a.pos=a.posMax+s,a.posMax=b,!0):(a.pos=w,!1)}"\\!\"#$%&'()*+,./:;<=>?@[]^_`{|}~-".split("").forEach(function(a){ESCAPED[a.charCodeAt(0)]=1});var UNESCAPE_RE=/\\([ \\!"#$%&'()*+,.\/:;<=>?@[\]^_`{|}~-])/g;function sub(a,h){var s,u,l=a.posMax,d=a.pos;if(126!==a.src.charCodeAt(d)||h||d+2>=l||a.level>=a.options.maxNesting)return!1;for(a.pos=d+1;a.pos<l;){if(126===a.src.charCodeAt(a.pos)){s=!0;break}a.parser.skipToken(a)}return!s||d+1===a.pos||(u=a.src.slice(d+1,a.pos)).match(/(^|[^\\])(\\\\)*\s/)?(a.pos=d,!1):(a.posMax=a.pos,a.pos=d+1,h||a.push({type:"sub",level:a.level,content:u.replace(UNESCAPE_RE,"$1")}),a.pos=a.posMax+1,a.posMax=l,!0)}var UNESCAPE_RE$1=/\\([ \\!"#$%&'()*+,.\/:;<=>?@[\]^_`{|}~-])/g;function sup(a,h){var s,u,l=a.posMax,d=a.pos;if(94!==a.src.charCodeAt(d)||h||d+2>=l||a.level>=a.options.maxNesting)return!1;for(a.pos=d+1;a.pos<l;){if(94===a.src.charCodeAt(a.pos)){s=!0;break}a.parser.skipToken(a)}return!s||d+1===a.pos||(u=a.src.slice(d+1,a.pos)).match(/(^|[^\\])(\\\\)*\s/)?(a.pos=d,!1):(a.posMax=a.pos,a.pos=d+1,h||a.push({type:"sup",level:a.level,content:u.replace(UNESCAPE_RE$1,"$1")}),a.pos=a.posMax+1,a.posMax=l,!0)}function links(a,h){var s,u,l,d,p,m,v,b,w=!1,S=a.pos,M=a.posMax,A=a.pos,k=a.src.charCodeAt(A);if(33===k&&(w=!0,k=a.src.charCodeAt(++A)),91!==k||a.level>=a.options.maxNesting||(s=A+1,(u=parseLinkLabel(a,A))<0))return!1;if((m=u+1)<M&&40===a.src.charCodeAt(m)){for(m++;m<M&&(32===(b=a.src.charCodeAt(m))||10===b);m++);if(m>=M)return!1;for(A=m,parseLinkDestination(a,m)?(d=a.linkContent,m=a.pos):d="",A=m;m<M&&(32===(b=a.src.charCodeAt(m))||10===b);m++);if(m<M&&A!==m&&parseLinkTitle(a,m))for(p=a.linkContent,m=a.pos;m<M&&(32===(b=a.src.charCodeAt(m))||10===b);m++);else p="";if(m>=M||41!==a.src.charCodeAt(m))return a.pos=S,!1;m++}else{if(a.linkLevel>0)return!1;for(;m<M&&(32===(b=a.src.charCodeAt(m))||10===b);m++);if(m<M&&91===a.src.charCodeAt(m)&&(A=m+1,(m=parseLinkLabel(a,m))>=0?l=a.src.slice(A,m++):m=A-1),l||(_typeof(l)>"u"&&(m=u+1),l=a.src.slice(s,u)),!(v=a.env.references[normalizeReference(l)]))return a.pos=S,!1;d=v.href,p=v.title}return h||(a.pos=s,a.posMax=u,w?a.push({type:"image",src:d,title:p,alt:a.src.substr(s,u-s),level:a.level}):(a.push({type:"link_open",href:d,title:p,level:a.level++}),a.linkLevel++,a.parser.tokenize(a),a.linkLevel--,a.push({type:"link_close",level:--a.level}))),a.pos=m,a.posMax=M,!0}function footnote_inline(a,h){var s,u,l,d,p=a.posMax,m=a.pos;return!(m+2>=p||94!==a.src.charCodeAt(m)||91!==a.src.charCodeAt(m+1)||a.level>=a.options.maxNesting||(s=m+2,u=parseLinkLabel(a,m+1),u<0)||(h||(a.env.footnotes||(a.env.footnotes={}),a.env.footnotes.list||(a.env.footnotes.list=[]),l=a.env.footnotes.list.length,a.pos=s,a.posMax=u,a.push({type:"footnote_ref",id:l,level:a.level}),a.linkLevel++,d=a.tokens.length,a.parser.tokenize(a),a.env.footnotes.list[l]={tokens:a.tokens.splice(d)},a.linkLevel--),a.pos=u+1,a.posMax=p,0))}function footnote_ref(a,h){var s,u,l,d,p=a.posMax,m=a.pos;if(m+3>p||!a.env.footnotes||!a.env.footnotes.refs||91!==a.src.charCodeAt(m)||94!==a.src.charCodeAt(m+1)||a.level>=a.options.maxNesting)return!1;for(u=m+2;u<p;u++){if(32===a.src.charCodeAt(u)||10===a.src.charCodeAt(u))return!1;if(93===a.src.charCodeAt(u))break}return!(u===m+2||u>=p||(u++,s=a.src.slice(m+2,u-1),_typeof(a.env.footnotes.refs[":"+s])>"u")||(h||(a.env.footnotes.list||(a.env.footnotes.list=[]),a.env.footnotes.refs[":"+s]<0?(a.env.footnotes.list[l=a.env.footnotes.list.length]={label:s,count:0},a.env.footnotes.refs[":"+s]=l):l=a.env.footnotes.refs[":"+s],d=a.env.footnotes.list[l].count,a.env.footnotes.list[l].count++,a.push({type:"footnote_ref",id:l,subId:d,level:a.level})),a.pos=u,a.posMax=p,0))}var url_schemas=["coap","doi","javascript","aaa","aaas","about","acap","cap","cid","crid","data","dav","dict","dns","file","ftp","geo","go","gopher","h323","http","https","iax","icap","im","imap","info","ipp","iris","iris.beep","iris.xpc","iris.xpcs","iris.lwz","ldap","mailto","mid","msrp","msrps","mtqp","mupdate","news","nfs","ni","nih","nntp","opaquelocktoken","pop","pres","rtsp","service","session","shttp","sieve","sip","sips","sms","snmp","soap.beep","soap.beeps","tag","tel","telnet","tftp","thismessage","tn3270","tip","tv","urn","vemmi","ws","wss","xcon","xcon-userid","xmlrpc.beep","xmlrpc.beeps","xmpp","z39.50r","z39.50s","adiumxtra","afp","afs","aim","apt","attachment","aw","beshare","bitcoin","bolo","callto","chrome","chrome-extension","com-eventbrite-attendee","content","cvs","dlna-playsingle","dlna-playcontainer","dtn","dvb","ed2k","facetime","feed","finger","fish","gg","git","gizmoproject","gtalk","hcp","icon","ipn","irc","irc6","ircs","itms","jar","jms","keyparc","lastfm","ldaps","magnet","maps","market","message","mms","ms-help","msnim","mumble","mvn","notes","oid","palm","paparazzi","platform","proxy","psyc","query","res","resource","rmi","rsync","rtmp","secondlife","sftp","sgn","skype","smb","soldat","spotify","ssh","steam","svn","teamspeak","things","udp","unreal","ut2004","ventrilo","view-source","webcal","wtai","wyciwyg","xfire","xri","ymsgr"],EMAIL_RE=/^<([a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*)>/,AUTOLINK_RE=/^<([a-zA-Z.\-]{1,25}):([^<>\x00-\x20]*)>/;function autolink(a,h){var s,u,l,d,p,m=a.pos;return!(60!==a.src.charCodeAt(m)||(s=a.src.slice(m),s.indexOf(">")<0)||((u=s.match(AUTOLINK_RE))?url_schemas.indexOf(u[1].toLowerCase())<0||(d=u[0].slice(1,-1),p=normalizeLink(d),!a.parser.validateLink(d))||(h||(a.push({type:"link_open",href:p,level:a.level}),a.push({type:"text",content:d,level:a.level+1}),a.push({type:"link_close",level:a.level})),a.pos+=u[0].length,0):!(l=s.match(EMAIL_RE))||(p=normalizeLink("mailto:"+(d=l[0].slice(1,-1))),!a.parser.validateLink(p)||(h||(a.push({type:"link_open",href:p,level:a.level}),a.push({type:"text",content:d,level:a.level+1}),a.push({type:"link_close",level:a.level})),a.pos+=l[0].length,0))))}function replace$1(a,h){return a=a.source,h=h||"",function s(u,l){return u?(a=a.replace(u,l=l.source||l),s):new RegExp(a,h)}}var attr_name=/[a-zA-Z_:][a-zA-Z0-9:._-]*/,unquoted=/[^"'=<>`\x00-\x20]+/,single_quoted=/'[^']*'/,double_quoted=/"[^"]*"/,attr_value=replace$1(/(?:unquoted|single_quoted|double_quoted)/)("unquoted",unquoted)("single_quoted",single_quoted)("double_quoted",double_quoted)(),attribute=replace$1(/(?:\s+attr_name(?:\s*=\s*attr_value)?)/)("attr_name",attr_name)("attr_value",attr_value)(),open_tag=replace$1(/<[A-Za-z][A-Za-z0-9]*attribute*\s*\/?>/)("attribute",attribute)(),close_tag=/<\/[A-Za-z][A-Za-z0-9]*\s*>/,comment=/<!---->|<!--(?:-?[^>-])(?:-?[^-])*-->/,processing=/<[?].*?[?]>/,declaration=/<![A-Z]+\s+[^>]*>/,cdata=/<!\[CDATA\[[\s\S]*?\]\]>/,HTML_TAG_RE=replace$1(/^(?:open_tag|close_tag|comment|processing|declaration|cdata)/)("open_tag",open_tag)("close_tag",close_tag)("comment",comment)("processing",processing)("declaration",declaration)("cdata",cdata)();function isLetter$2(a){var h=32|a;return h>=97&&h<=122}function htmltag(a,h){var s,u,l,d=a.pos;return!(!a.options.html||(l=a.posMax,60!==a.src.charCodeAt(d)||d+2>=l)||(s=a.src.charCodeAt(d+1),33!==s&&63!==s&&47!==s&&!isLetter$2(s))||(u=a.src.slice(d).match(HTML_TAG_RE),!u)||(h||a.push({type:"htmltag",content:a.src.slice(d,d+u[0].length),level:a.level}),a.pos+=u[0].length,0))}var DIGITAL_RE=/^&#((?:x[a-f0-9]{1,8}|[0-9]{1,8}));/i,NAMED_RE=/^&([a-z][a-z0-9]{1,31});/i;function entity(a,h){var u,l,d=a.pos,p=a.posMax;if(38!==a.src.charCodeAt(d))return!1;if(d+1<p)if(35===a.src.charCodeAt(d+1)){if(l=a.src.slice(d).match(DIGITAL_RE))return h||(u="x"===l[1][0].toLowerCase()?parseInt(l[1].slice(1),16):parseInt(l[1],10),a.pending+=isValidEntityCode(u)?fromCodePoint(u):fromCodePoint(65533)),a.pos+=l[0].length,!0}else if(l=a.src.slice(d).match(NAMED_RE)){var m=decodeEntity(l[1]);if(l[1]!==m)return h||(a.pending+=m),a.pos+=l[0].length,!0}return h||(a.pending+="&"),a.pos++,!0}var _rules$2=[["text",text$1],["newline",newline],["escape",escape],["backticks",backticks],["del",del],["ins",ins],["mark",mark],["emphasis",emphasis],["sub",sub],["sup",sup],["links",links],["footnote_inline",footnote_inline],["footnote_ref",footnote_ref],["autolink",autolink],["htmltag",htmltag],["entity",entity]];function ParserInline(){this.ruler=new Ruler;for(var a=0;a<_rules$2.length;a++)this.ruler.push(_rules$2[a][0],_rules$2[a][1]);this.validateLink=validateLink}function validateLink(a){var s=a.trim().toLowerCase();return!(-1!==(s=replaceEntities(s)).indexOf(":")&&-1!==["vbscript","javascript","file","data"].indexOf(s.split(":")[0]))}ParserInline.prototype.skipToken=function(a){var l,d,h=this.ruler.getRules(""),s=h.length,u=a.pos;if((d=a.cacheGet(u))>0)a.pos=d;else{for(l=0;l<s;l++)if(h[l](a,!0))return void a.cacheSet(u,a.pos);a.pos++,a.cacheSet(u,a.pos)}},ParserInline.prototype.tokenize=function(a){for(var l,d,h=this.ruler.getRules(""),s=h.length,u=a.posMax;a.pos<u;){for(d=0;d<s&&!(l=h[d](a,!1));d++);if(l){if(a.pos>=u)break}else a.pending+=a.src[a.pos++]}a.pending&&a.pushPending()},ParserInline.prototype.parse=function(a,h,s,u){var l=new StateInline(a,this,h,s,u);this.tokenize(l)};var defaultConfig={options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkTarget:"",typographer:!1,quotes:"\u201c\u201d\u2018\u2019",highlight:null,maxNesting:20},components:{core:{rules:["block","inline","references","replacements","smartquotes","references","abbr2","footnote_tail"]},block:{rules:["blockquote","code","fences","footnote","heading","hr","htmlblock","lheading","list","paragraph","table"]},inline:{rules:["autolink","backticks","del","emphasis","entity","escape","footnote_ref","htmltag","links","newline","text"]}}},fullConfig={options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkTarget:"",typographer:!1,quotes:"\u201c\u201d\u2018\u2019",highlight:null,maxNesting:20},components:{core:{},block:{},inline:{}}},commonmarkConfig={options:{html:!0,xhtmlOut:!0,breaks:!1,langPrefix:"language-",linkTarget:"",typographer:!1,quotes:"\u201c\u201d\u2018\u2019",highlight:null,maxNesting:20},components:{core:{rules:["block","inline","references","abbr2"]},block:{rules:["blockquote","code","fences","heading","hr","htmlblock","lheading","list","paragraph"]},inline:{rules:["autolink","backticks","emphasis","entity","escape","htmltag","links","newline","text"]}}},config={default:defaultConfig,full:fullConfig,commonmark:commonmarkConfig};function StateCore(a,h,s){this.src=h,this.env=s,this.options=a.options,this.tokens=[],this.inlineMode=!1,this.inline=a.inline,this.block=a.block,this.renderer=a.renderer,this.typographer=a.typographer}function Remarkable(a,h){"string"!=typeof a&&(h=a,a="default"),h&&null!=h.linkify&&console.warn("linkify option is removed. Use linkify plugin instead:\n\nimport Remarkable from 'remarkable';\nimport linkify from 'remarkable/linkify';\nnew Remarkable().use(linkify)\n"),this.inline=new ParserInline,this.block=new ParserBlock,this.core=new Core,this.renderer=new Renderer,this.ruler=new Ruler,this.options={},this.configure(config[a]),this.set(h||{})}Remarkable.prototype.set=function(a){assign(this.options,a)},Remarkable.prototype.configure=function(a){var h=this;if(!a)throw new Error("Wrong `remarkable` preset, check name/content");a.options&&h.set(a.options),a.components&&Object.keys(a.components).forEach(function(s){a.components[s].rules&&h[s].ruler.enable(a.components[s].rules,!0)})},Remarkable.prototype.use=function(a,h){return a(this,h),this},Remarkable.prototype.parse=function(a,h){var s=new StateCore(this,a,h);return this.core.process(s),s.tokens},Remarkable.prototype.render=function(a,h){return this.renderer.render(this.parse(a,h=h||{}),this.options,h)},Remarkable.prototype.parseInline=function(a,h){var s=new StateCore(this,a,h);return s.inlineMode=!0,this.core.process(s),s.tokens},Remarkable.prototype.renderInline=function(a,h){return this.renderer.render(this.parseInline(a,h=h||{}),this.options,h)};var RemarkableConfig=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"createNew",value:function(){var s=window.hljs;return new Remarkable(s?{highlight:function(l,d){if(d&&s.getLanguage(d))try{return s.highlight(d,l).value}catch{console.error("failed to setup the highlight dependency")}try{return s.highlightAuto(l).value}catch{console.error("failed to automatically highlight messages")}return""},html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkTarget:"_blank",typographer:!0}:{highlight:function(l){return l},linkTarget:"_blank"})}}]),a}(),SetFileTypes=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"parseConfig",value:function(s,u,l,d){var p,m={files:u};if("object"==_typeof(d)){var v=d.files,b=d.request,w=d.button;v&&(v.infoModal&&(m.files.infoModal=v.infoModal,null!=(p=v.infoModal)&&p.textMarkDown&&(m.infoModalTextMarkUp=l.render(v.infoModal.textMarkDown))),v.acceptedFormats&&(m.files.acceptedFormats=v.acceptedFormats),v.maxNumberOfFiles&&(m.files.maxNumberOfFiles=v.maxNumberOfFiles)),m.button=w,b&&(b.headers||b.method||b.url||s.headers||s.method||s.url)&&(m.request={headers:b?.headers||s.headers,method:b?.method||s.method,url:b?.url||s.url})}return m}},{key:"processMixedFiles",value:function(s,u,l){l&&(s.fileTypes.mixedFiles=a.parseConfig(s.requestSettings,{acceptedFormats:""},u,l))}},{key:"processMicrophone",value:function(s,u,l,d){var p,m,v,b,w,S,M,A,k=_objectSpread({acceptedFormats:"audio/*"},(null==(v=s.fileTypes.audio)?void 0:v.files)||{});l&&(void 0!==navigator.mediaDevices.getUserMedia?(s.recordAudio=a.parseConfig(s.requestSettings,k,u,l),"object"==_typeof(l)&&l.files&&(null!==(p=(b=s.recordAudio).files)&&void 0!==p||(b.files={}),s.recordAudio.files.format=null==(w=l.files)?void 0:w.format,s.recordAudio.files.maxDurationSeconds=null==(S=l.files)?void 0:S.maxDurationSeconds,null!=(M=s.fileTypes.audio)&&M.files&&(null!==(m=(A=s.fileTypes.audio.files).maxNumberOfFiles)&&void 0!==m||(A.maxNumberOfFiles=l.files.maxNumberOfFiles)))):d||(s.fileTypes.audio=a.parseConfig(s.requestSettings,k,u,l)))}},{key:"processAudioConfig",value:function(s,u,l,d){if(l||d){var p=_objectSpread({acceptedFormats:"audio/*"},d?.files||{});s.fileTypes.audio=a.parseConfig(s.requestSettings,p,u,l)}}},{key:"processGifConfig",value:function(s,u,l,d){if(l||d){var p=_objectSpread({acceptedFormats:"image/gif"},d?.files||{});s.fileTypes.gifs=a.parseConfig(s.requestSettings,p,u,l)}}},{key:"processCamera",value:function(s,u,l,d){var p,m,v,b,w,S=_objectSpread({acceptedFormats:"image/*"},(null==(m=s.fileTypes.images)?void 0:m.files)||{});l&&(void 0!==navigator.mediaDevices.getUserMedia?(s.camera=a.parseConfig(s.requestSettings,S,u,l),"object"==_typeof(l)&&(s.camera.modalContainerStyle=l.modalContainerStyle,l.files&&(null!==(p=(v=s.camera).files)&&void 0!==p||(v.files={}),s.camera.files.format=null==(b=l.files)?void 0:b.format,s.camera.files.dimensions=null==(w=l.files)?void 0:w.dimensions))):d||(s.fileTypes.images=a.parseConfig(s.requestSettings,S,u,l)))}},{key:"processImagesConfig",value:function(s,u,l,d){if(l||d){var p=_objectSpread({acceptedFormats:"image/*"},d?.files||{});s.fileTypes.images=a.parseConfig(s.requestSettings,p,u,l)}}},{key:"populateDefaultFileIO",value:function(s,u){var l,d,p,m,v;s&&(null!==(l=s.files)&&void 0!==l||(s.files={}),null!==(d=(m=s.files).acceptedFormats)&&void 0!==d||(m.acceptedFormats=u),null!==(p=(v=s.files).maxNumberOfFiles)&&void 0!==p||(v.maxNumberOfFiles=1))}},{key:"set",value:function(s,u,l){a.populateDefaultFileIO(l?.audio,".4a,.mp3,.webm,.mp4,.mpga,.wav,.mpeg,.m4a"),a.populateDefaultFileIO(l?.images,".png,.jpg");var d=RemarkableConfig.createNew();a.processImagesConfig(u,d,s.images,l?.images),a.processCamera(u,d,s.camera,s.images),a.processGifConfig(u,d,s.gifs,l?.gifs),a.processAudioConfig(u,d,s.audio,l?.audio),a.processMicrophone(u,d,s.microphone,s.audio),a.processMixedFiles(u,d,s.mixedFiles)}}]),a}(),BaseServiceIO=function(){function a(h,s,u){var l,d,p,m,v;_classCallCheck(this,a),this.rawBody={},this.validateConfigKey=!1,this.canSendMessage=a.canSendMessage,this.requestSettings={},this.fileTypes={},this.completionsHandlers={},this.streamHandlers={},this.deepChat=h,this.demo=u,Object.assign(this.rawBody,null==(d=h.request)?void 0:d.additionalBodyProps),this.totalMessagesMaxCharLength=null==(p=h?.requestBodyLimits)?void 0:p.totalMessagesMaxCharLength,this.maxMessages=null==(m=h?.requestBodyLimits)?void 0:m.maxMessages,SetFileTypes.set(h,this,s),h.request&&(this.requestSettings=h.request),this.demo&&(null!==(l=(v=this.requestSettings).url)&&void 0!==l||(v.url=Demo.URL)),this._directServiceRequiresFiles=!!s&&Object.keys(s).length>0,this.requestSettings.websocket&&Websocket.setup(this)}return _createClass(a,[{key:"verifyKey",value:function(s,u){}},{key:"getServiceIOByType",value:function(s){if(s.type.startsWith("audio")&&this.fileTypes.audio)return this.fileTypes.audio;if(s.type.startsWith("image")){if(this.fileTypes.gifs&&s.type.endsWith("/gif"))return this.fileTypes.gifs;if(this.fileTypes.images)return this.fileTypes.images;if(this.camera)return this.camera}return this.fileTypes.mixedFiles}},{key:"callServiceAPI",value:(h=_asyncToGenerator(_regeneratorRuntime().mark(function u(l,d,p){var m,v,b,w,S,M,A,k,N;return _regeneratorRuntime().wrap(function(z){for(;;)switch(z.prev=z.next){case 0:if(A=_objectSpread({messages:d},this.rawBody),k=!1,null!=(b=this.requestSettings.headers)&&b["Content-Type"]||(null!==(m=(w=this.requestSettings).headers)&&void 0!==m||(w.headers={}),null!==(v=(S=this.requestSettings.headers)["Content-Type"])&&void 0!==v||(S["Content-Type"]="application/json"),k=!0),!(N=this.deepChat.stream)||!this.demo&&"object"==_typeof(N)&&N.simulation){z.next=9;break}return z.next=7,Stream.request(this,A,l);case 7:z.next=11;break;case 9:return z.next=11,HTTPRequest.request(this,A,l);case 11:k&&(null==(M=this.requestSettings.headers)||delete M["Content-Type"]);case 12:case"end":return z.stop()}},u,this)})),function s(u,l,d){return h.apply(this,arguments)})},{key:"callApiWithFiles",value:function(){var h=_asyncToGenerator(_regeneratorRuntime().mark(function u(l,d,p,m){var v,b,w;return _regeneratorRuntime().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return v=a.createCustomFormDataBody(l,p,m),b=this.requestSettings,w=this.getServiceIOByType(m[0]),this.requestSettings=w?.request||this.requestSettings,M.next=4,HTTPRequest.request(this,v,d,!1);case 4:this.requestSettings=b;case 5:case"end":return M.stop()}},u,this)}));return function s(u,l,d,p){return h.apply(this,arguments)}}()},{key:"callAPI",value:function(){var h=_asyncToGenerator(_regeneratorRuntime().mark(function u(l,d){var p,m;return _regeneratorRuntime().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:if(this.requestSettings){b.next=2;break}throw new Error("Request settings have not been set up");case 2:p=MessageLimitUtils.processMessages(l,d.messages,this.maxMessages,this.totalMessagesMaxCharLength),this.requestSettings.websocket?(m=_objectSpread({messages:p},this.rawBody),Websocket.sendWebsocket(this,m,d,!1)):l.files&&!this._directServiceRequiresFiles?this.callApiWithFiles(this.rawBody,d,p,l.files):this.callServiceAPI(d,p,l.files);case 4:case"end":return b.stop()}},u,this)}));return function s(u,l){return h.apply(this,arguments)}}()},{key:"extractResultData",value:function(){var h=_asyncToGenerator(_regeneratorRuntime().mark(function u(l){return _regeneratorRuntime().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(!l.error){p.next=2;break}throw l.error;case 2:return p.abrupt("return",l.result?(console.error("The {result: ....} response object type is deprecated since version 1.3.0."),console.error("Please change to using the new response object: https://deepchat.dev/docs/connect#Response"),l.result):l);case 3:case"end":return p.stop()}},u)}));return function s(u){return h.apply(this,arguments)}}()},{key:"isDirectConnection",value:function(){return!1}}],[{key:"canSendMessage",value:function(s,u){return!(!s||""===s.trim())||!!(u&&u.length>0)}},{key:"createCustomFormDataBody",value:function(s,u,l){var d=new FormData;l.forEach(function(m){return d.append("files",m)}),Object.keys(s).forEach(function(m){return d.append(m,String(s[m]))});var p=0;return u.forEach(function(m){m.text&&d.append("message".concat(p+=1),JSON.stringify(m))}),d}}]),a;var h}(),DirectServiceIO=function(a){_inherits(s,a);var h=_createSuper(s);function s(u,l,d,p,m){var v,b;return _classCallCheck(this,s),(v=h.call(this,u,m)).insertKeyPlaceholderText="API Key",v.getKeyLink="",Object.assign(v.rawBody,null==(b=u.request)?void 0:b.additionalBodyProps),v.keyVerificationDetails=l,v.buildHeadersFunc=d,p&&v.setApiKeyProperties(p),v.requestSettings=v.buildRequestSettings(v.key||"",u.request),v}return _createClass(s,[{key:"setApiKeyProperties",value:function(l){this.key=l.key,l.validateKeyProperty&&(this.validateConfigKey=l.validateKeyProperty)}},{key:"buildRequestSettings",value:function(l,d){var p=d??{};return p.headers=this.buildHeadersFunc(l),p}},{key:"keyAuthenticated",value:function(l,d){this.requestSettings=this.buildRequestSettings(d,this.requestSettings),this.key=d,l()}},{key:"verifyKey",value:function(l,d){var p=this.keyVerificationDetails,m=p.url,v=p.method,b=p.handleVerificationResult,w=p.createHeaders,S=p.body,M=w?.(l)||this.buildHeadersFunc(l);HTTPRequest.verifyKey(l,m,M,v,this.keyAuthenticated.bind(this,d.onSuccess),d.onFail,d.onLoad,b,S)}},{key:"isDirectConnection",value:function(){return!0}}]),s}(BaseServiceIO),RenderControl=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"waitForPropertiesToBeUpdatedBeforeRender",value:function(s){s._propUpdated_=!1,setTimeout(function(){s._propUpdated_?a.waitForPropertiesToBeUpdatedBeforeRender(s):(s._waitingToRender_=!1,s.onRender())})}},{key:"attemptRender",value:function(s){s._propUpdated_=!0,s._waitingToRender_||(s._waitingToRender_=!0,a.waitForPropertiesToBeUpdatedBeforeRender(s))}}]),a}(),_InternalHTML=function(a){_inherits(s,a);var h=_createSuper(s);function s(){var u;return _classCallCheck(this,s),(u=h.call(this))._waitingToRender_=!1,u._propUpdated_=!1,Object.keys(s._attributeToProperty_).forEach(function(l){var d=s._attributeToProperty_[l];u.constructPropertyAccessors(d),u.hasOwnProperty(l)||u.constructPropertyAccessors(d,l)}),u}return _createClass(s,[{key:"constructPropertyAccessors",value:function(l,d){var p;Object.defineProperty(this,d||l,{get:function(){return p},set:function(v){p=v,d?this[l]=v:RenderControl.attemptRender(this)}})}},{key:"attributeChangedCallback",value:function(l,d,p){if(d!==p){var m=s._attributes_[l](p);this[s._attributeToProperty_[l]]=m}}},{key:"onRender",value:function(){}}],[{key:"observedAttributes",get:function(){return Object.keys(s._attributes_)||[]}}]),s}(_wrapNativeSuper(HTMLElement));_InternalHTML._attributes_={},_InternalHTML._attributeToProperty_={};var InternalHTML=_InternalHTML,NOT_VISIBLE_ICON_STRING='<?xml version="1.0" standalone="no"?>\n<svg version="1.1"\n\txmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"\n\txmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="0.9em" height="0.9em"\n\tviewBox="0 0 1200 1200" enable-background="new 0 0 1200 1200">\n\t\t<path d="\n\t\t\tM669.727,273.516c-22.891-2.476-46.15-3.895-69.727-4.248c-103.025,0.457-209.823,25.517-310.913,73.536\n\t\t\tc-75.058,37.122-148.173,89.529-211.67,154.174C46.232,529.978,6.431,577.76,0,628.74c0.76,44.162,48.153,98.67,77.417,131.764\n\t\t\tc59.543,62.106,130.754,113.013,211.67,154.174c2.75,1.335,5.51,2.654,8.276,3.955l-75.072,131.102l102.005,60.286l551.416-960.033\n\t\t\tl-98.186-60.008L669.727,273.516z M902.563,338.995l-74.927,129.857c34.47,44.782,54.932,100.006,54.932,159.888\n\t\t\tc0,149.257-126.522,270.264-282.642,270.264c-6.749,0-13.29-0.728-19.922-1.172l-49.585,85.84c22.868,2.449,45.99,4.233,69.58,4.541\n\t\t\tc103.123-0.463,209.861-25.812,310.84-73.535c75.058-37.122,148.246-89.529,211.743-154.174\n\t\t\tc31.186-32.999,70.985-80.782,77.417-131.764c-0.76-44.161-48.153-98.669-77.417-131.763\n\t\t\tc-59.543-62.106-130.827-113.013-211.743-154.175C908.108,341.478,905.312,340.287,902.563,338.995L902.563,338.995z\n\t\t\tM599.927,358.478c6.846,0,13.638,0.274,20.361,0.732l-58.081,100.561c-81.514,16.526-142.676,85.88-142.676,168.897\n\t\t\tc0,20.854,3.841,40.819,10.913,59.325c0.008,0.021-0.008,0.053,0,0.074l-58.228,100.854\n\t\t\tc-34.551-44.823-54.932-100.229-54.932-160.182C317.285,479.484,443.808,358.477,599.927,358.478L599.927,358.478z M768.896,570.513\n\t\t\tL638.013,797.271c81.076-16.837,141.797-85.875,141.797-168.603C779.81,608.194,775.724,588.729,768.896,570.513L768.896,570.513z"\n\t\t\t/>\n</svg>\n',VISIBLE_ICON_STRING='<?xml version="1.0" standalone="no"?>\n<svg version="1.1"\n\txmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"\n\txmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="0.9em" height="0.9em"\n\tviewBox="0 0 1200 1200" enable-background="new 0 0 1200 1200">\n\t\t<path id="path6686" inkscape:connector-curvature="0" d="M779.843,599.925c0,95.331-80.664,172.612-180.169,172.612\n\t\t\tc-99.504,0-180.168-77.281-180.168-172.612c0-95.332,80.664-172.612,180.168-172.612\n\t\t\tC699.179,427.312,779.843,504.594,779.843,599.925z M600,240.521c-103.025,0.457-209.814,25.538-310.904,73.557\n\t\t\tc-75.058,37.122-148.206,89.496-211.702,154.141C46.208,501.218,6.431,549,0,599.981c0.76,44.161,48.13,98.669,77.394,131.763\n\t\t\tc59.543,62.106,130.786,113.018,211.702,154.179c94.271,45.751,198.616,72.092,310.904,73.557\n\t\t\tc103.123-0.464,209.888-25.834,310.866-73.557c75.058-37.122,148.243-89.534,211.74-154.179\n\t\t\tc31.185-32.999,70.962-80.782,77.394-131.763c-0.76-44.161-48.13-98.671-77.394-131.764\n\t\t\tc-59.543-62.106-130.824-112.979-211.74-154.141C816.644,268.36,712.042,242.2,600,240.521z M599.924,329.769\n\t\t\tc156.119,0,282.675,120.994,282.675,270.251c0,149.256-126.556,270.25-282.675,270.25S317.249,749.275,317.249,600.02\n\t\t\tC317.249,450.763,443.805,329.769,599.924,329.769L599.924,329.769z"/>\n</svg>\n',SVGIconUtils=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"createSVGElement",value:function(s){return(new DOMParser).parseFromString(s,"image/svg+xml").documentElement}}]),a}(),_VisibilityIcon=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"changeVisibility",value:function(s,u,l,d){d.target.id===a.VISIBLE_ICON_ID?(u.style.display="none",l.style.display="block",s.type="password"):(u.style.display="block",l.style.display="none",s.type="text")}},{key:"createIconElement",value:function(s,u){var l=SVGIconUtils.createSVGElement(s);return l.id=u,l.classList.add("visibility-icon"),l}},{key:"create",value:function(s){var u=document.createElement("div");u.id="visibility-icon-container";var l=a.createIconElement(VISIBLE_ICON_STRING,a.VISIBLE_ICON_ID);l.style.display="none",u.appendChild(l);var d=a.createIconElement(NOT_VISIBLE_ICON_STRING,"not-visible-icon");return u.appendChild(d),u.onclick=a.changeVisibility.bind(this,s,l,d),u}}]),a}();_VisibilityIcon.VISIBLE_ICON_ID="visible-icon";var VisibilityIcon=_VisibilityIcon,InsertKeyView=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"createCautionText",value:function(){var s=document.createElement("a");return s.classList.add("insert-key-input-help-text"),s.innerText="Please exercise CAUTION when inserting your API key outside of deepchat.dev or localhost!!",s}},{key:"createHelpLink",value:function(s){var u=document.createElement("a");return u.classList.add("insert-key-input-help-text"),u.href=s,u.innerText="Find more info here",u.target="_blank",u}},{key:"createFailText",value:function(){var s=document.createElement("div");return s.id="insert-key-input-invalid-text",s.style.display="none",s}},{key:"createHelpTextContainer",value:function(s){var u=document.createElement("div");u.id="insert-key-help-text-container";var l=document.createElement("div");l.id="insert-key-help-text-contents";var d=a.createFailText();if(l.appendChild(d),s){var p=a.createHelpLink(s);l.appendChild(p)}var m=a.createCautionText();return l.appendChild(m),u.appendChild(l),{helpTextContainerElement:u,failTextElement:d}}},{key:"onFail",value:function(s,u,l,d){s.classList.replace("insert-key-input-valid","insert-key-input-invalid"),l.innerText=d,l.style.display="block",u.innerText="Start",s.classList.remove("loading")}},{key:"onLoad",value:function(s,u){s.classList.add("loading"),u.innerHTML='<div id="loading-ring"></div>'}},{key:"verifyKey",value:function(s,u,l){var d=s.value.trim();l.verifyKey(d,u)}},{key:"addVerificationEvents",value:function(s,u,l,d,p){var m={onSuccess:d,onFail:a.onFail.bind(this,s,u,l),onLoad:a.onLoad.bind(this,s,u)},v=a.verifyKey.bind(this,s,m,p);u.onclick=v,s.onkeydown=function(b){!s.classList.contains("loading")&&b.key===KEYBOARD_KEY.ENTER&&v()}}},{key:"createStartButton",value:function(){var s=document.createElement("div");return s.id="start-button",s.innerText="Start",s}},{key:"onInputFocus",value:function(s){s.target.classList.replace("insert-key-input-invalid","insert-key-input-valid")}},{key:"createInput",value:function(s){var u=document.createElement("div");u.id="insert-key-input-container";var l=document.createElement("input");return l.id="insert-key-input",l.placeholder=s||"API Key",l.type="password",l.classList.add("insert-key-input-valid"),l.onfocus=a.onInputFocus,u.appendChild(l),u}},{key:"createContents",value:function(s,u){var l=document.createElement("div");l.id="insert-key-contents";var d=a.createInput(u.insertKeyPlaceholderText),p=d.children[0],m=VisibilityIcon.create(p);d.appendChild(m),l.appendChild(d);var v=a.createStartButton(),b=a.createHelpTextContainer(u.getKeyLink),w=b.helpTextContainerElement,S=b.failTextElement;return l.appendChild(v),l.appendChild(w),a.addVerificationEvents(p,v,S,s,u),l}},{key:"createElements",value:function(s,u){var l=document.createElement("div");l.id="insert-key-view";var d=a.createContents(s,u);return l.appendChild(d),l}},{key:"render",value:function(s,u,l){var d=a.createElements(u,l);s.replaceChildren(d)}}]),a}(),HuggingFaceUtils=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"buildHeaders",value:function(s){return{Authorization:"Bearer ".concat(s),"Content-Type":"application/json"}}},{key:"handleVerificationResult",value:function(s,u,l,d){var p=s;Array.isArray(p.error)&&"Error in `parameters`: field required"===p.error[0]?l(u):d(ErrorMessages.INVALID_KEY)}},{key:"buildKeyVerificationDetails",value:function(){return{url:"https://api-inference.huggingface.co/models/gpt2",method:"POST",handleVerificationResult:a.handleVerificationResult}}}]),a}(),_HuggingFaceIO=function(a){_inherits(s,a);var u,h=_createSuper(s);function s(u,l,d,p,m,v){var b;return _classCallCheck(this,s),(b=h.call(this,u,HuggingFaceUtils.buildKeyVerificationDetails(),HuggingFaceUtils.buildHeaders,m,v)).insertKeyPlaceholderText="Hugging Face Token",b.getKeyLink="https://huggingface.co/settings/tokens",b.introPanelMarkUp='\n    <div style="width: 100%; text-align: center; margin-left: -10px"><b>Hugging Face</b></div>\n    <p>First message may take an extented amount of time to complete as the model needs to be initialized.</p>',b.permittedErrorPrefixes=["Authorization header"],b.url="".concat(s.URL_PREFIX).concat(d),b.textInputPlaceholderText=l,"object"==_typeof(p)&&(p.model&&(b.url="".concat(s.URL_PREFIX).concat(p.model)),p.options&&(b.rawBody.options=p.options),p.parameters&&(b.rawBody.parameters=p.parameters)),b}return _createClass(s,[{key:"preprocessBody",value:function(l,d,p){var m,v=JSON.parse(JSON.stringify(l)),b=d[d.length-1].text;if(b)return null!==(m=v.options)&&void 0!==m||(v.options={}),v.options.wait_for_model=!0,_objectSpread({inputs:b},v)}},{key:"callServiceAPI",value:(u=_asyncToGenerator(_regeneratorRuntime().mark(function d(p,m,v){var b;return _regeneratorRuntime().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(this.requestSettings){S.next=2;break}throw new Error("Request settings have not been set up");case 2:b=this.preprocessBody(this.rawBody,m,v),HTTPRequest.request(this,b,p);case 4:case"end":return S.stop()}},d,this)})),function l(d,p,m){return u.apply(this,arguments)})}]),s}(DirectServiceIO);_HuggingFaceIO.URL_PREFIX="https://api-inference.huggingface.co/models/";var HuggingFaceIO=_HuggingFaceIO,HuggingFaceFileIO=function(a){_inherits(s,a);var u,h=_createSuper(s);function s(u,l,d,p,m,v){var b;return _classCallCheck(this,s),(b=h.call(this,u,l,d,p,m,v)).isTextInputDisabled=!0,b.canSendMessage=s.canSendFile,b}return _createClass(s,[{key:"preprocessBody",value:function(l,d,p){return p[0]}},{key:"callServiceAPI",value:(u=_asyncToGenerator(_regeneratorRuntime().mark(function d(p,m,v){return _regeneratorRuntime().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:if(this.requestSettings){w.next=2;break}throw new Error("Request settings have not been set up");case 2:if(null!=v&&v[0]){w.next=4;break}throw new Error("No file was added");case 4:HTTPRequest.poll(this,v[0],p,!1);case 5:case"end":return w.stop()}},d,this)})),function l(d,p,m){return u.apply(this,arguments)})}],[{key:"canSendFile",value:function(l,d){return!(null==d||!d[0])}}]),s}(HuggingFaceIO),HuggingFaceAudioClassificationIO=function(a){_inherits(s,a);var u,h=_createSuper(s);function s(u){_classCallCheck(this,s);var l,d,p,m=null==(d=null==(l=u.directConnection)?void 0:l.huggingFace)?void 0:d.audioClassification,v=null==(p=u.directConnection)?void 0:p.huggingFace;return h.call(this,u,"Attach an audio file","ehcalabres/wav2vec2-lg-xlsr-en-speech-emotion-recognition",m,v,{audio:{}})}return _createClass(s,[{key:"extractPollResultData",value:(u=_asyncToGenerator(_regeneratorRuntime().mark(function d(p){var m;return _regeneratorRuntime().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:if(!p.estimated_time){b.next=2;break}return b.abrupt("return",{timeoutMS:1e3*(p.estimated_time+1)});case 2:if(!p.error){b.next=4;break}throw p.error;case 4:return b.abrupt("return",{text:(null==(m=p[0])?void 0:m.label)||""});case 5:case"end":return b.stop()}},d)})),function l(d){return u.apply(this,arguments)})}]),s}(HuggingFaceFileIO),HuggingFaceImageClassificationIO=function(a){_inherits(s,a);var u,h=_createSuper(s);function s(u){_classCallCheck(this,s);var l,d,p,m=null==(d=null==(l=u.directConnection)?void 0:l.huggingFace)?void 0:d.imageClassification,v=null==(p=u.directConnection)?void 0:p.huggingFace;return h.call(this,u,"Attach an image file","google/vit-base-patch16-224",m,v,{images:{}})}return _createClass(s,[{key:"extractPollResultData",value:(u=_asyncToGenerator(_regeneratorRuntime().mark(function d(p){var m;return _regeneratorRuntime().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:if(!p.estimated_time){b.next=2;break}return b.abrupt("return",{timeoutMS:1e3*(p.estimated_time+1)});case 2:if(!p.error){b.next=4;break}throw p.error;case 4:return b.abrupt("return",{text:(null==(m=p[0])?void 0:m.label)||""});case 5:case"end":return b.stop()}},d)})),function l(d){return u.apply(this,arguments)})}]),s}(HuggingFaceFileIO),BASE_64_PREFIX="data:image/png;base64,",StabilityAIUtils=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"buildHeaders",value:function(s){return{Authorization:"Bearer ".concat(s),"Content-Type":"application/json"}}},{key:"handleVerificationResult",value:function(s,u,l,d){s.message?d(ErrorMessages.INVALID_KEY):l(u)}},{key:"buildKeyVerificationDetails",value:function(){return{url:"https://api.stability.ai/v1/engines/list",method:"GET",handleVerificationResult:a.handleVerificationResult}}}]),a}(),StabilityAIIO=function(a){_inherits(s,a);var h=_createSuper(s);function s(u,l,d,p,m){var v;return _classCallCheck(this,s),(v=h.call(this,u,l,d,p,m)).insertKeyPlaceholderText="Stability AI API Key",v.getKeyLink="https://platform.stability.ai/docs/getting-started/authentication",v.permittedErrorPrefixes=["Incorrect","invalid_"],v}return _createClass(s)}(DirectServiceIO),StabilityAIImageToImageUpscaleIO=function(a){_inherits(s,a);var u,h=_createSuper(s);function s(u){var l;_classCallCheck(this,s);var d,p=JSON.parse(JSON.stringify(u.directConnection)),m=p?.stabilityAI;(l=h.call(this,u,StabilityAIUtils.buildKeyVerificationDetails(),StabilityAIUtils.buildHeaders,m,{images:{files:{acceptedFormats:".png",maxNumberOfFiles:1}}})).url="https://api.stability.ai/v1/generation/esrgan-v1-x2plus/image-to-image/upscale",l.textInputPlaceholderText="Describe image changes",l.introPanelMarkUp='\n    <div style="width: 100%; text-align: center; margin-left: -10px"><b>Stability AI</b></div>\n    <div style="width: 100%; text-align: center; margin-left: -10px; margin-top: 5px"><b>Image to Image Upscale</b></div>\n    <p>Upload an image to generate a new one with higher resolution.</p>\n    <p>Click <a href="https://platform.stability.ai/">here</a> for more info.</p>';var b=null==(d=p?.stabilityAI)?void 0:d.imageToImageUpscale;return"object"==_typeof(b)&&(b.engine_id&&(l.url="https://api.stability.ai/v1/generation/".concat(b.engine_id,"/image-to-image/upscale")),s.cleanConfig(b),Object.assign(l.rawBody,b)),l.canSendMessage=s.canSendFileMessage,l}return _createClass(s,[{key:"createFormDataBody",value:function(l,d){var p=new FormData;return p.append("image",d),Object.keys(l).forEach(function(m){p.append(m,String(l[m]))}),p}},{key:"callServiceAPI",value:(u=_asyncToGenerator(_regeneratorRuntime().mark(function d(p,m,v){var b;return _regeneratorRuntime().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(this.requestSettings){S.next=2;break}throw new Error("Request settings have not been set up");case 2:if(v){S.next=4;break}throw new Error("Image was not found");case 4:b=this.createFormDataBody(this.rawBody,v[0]),RequestUtils.temporarilyRemoveHeader(this.requestSettings,HTTPRequest.request.bind(this,this,b,p),!1);case 6:case"end":return S.stop()}},d,this)})),function l(d,p,m){return u.apply(this,arguments)})},{key:"extractResultData",value:function(){var u=_asyncToGenerator(_regeneratorRuntime().mark(function d(p){return _regeneratorRuntime().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(!p.message){v.next=2;break}throw p.message;case 2:return v.abrupt("return",{files:p.artifacts.map(function(b){return{src:"".concat(BASE_64_PREFIX).concat(b.base64),type:"image"}})});case 3:case"end":return v.stop()}},d)}));return function l(d){return u.apply(this,arguments)}}()}],[{key:"cleanConfig",value:function(l){delete l.engine_id}},{key:"canSendFileMessage",value:function(l,d){return!(null==d||!d[0])}}]),s}(StabilityAIIO),StabilityAIImageToImageMaskingIO=function(a){_inherits(s,a);var u,h=_createSuper(s);function s(u){var l;_classCallCheck(this,s);var d,p=JSON.parse(JSON.stringify(u.directConnection)),m=p?.stabilityAI;(l=h.call(this,u,StabilityAIUtils.buildKeyVerificationDetails(),StabilityAIUtils.buildHeaders,m,{images:{files:{acceptedFormats:".png",maxNumberOfFiles:2}}})).url="https://api.stability.ai/v1/generation/stable-inpainting-512-v2-0/image-to-image/masking",l._maskSource="MASK_IMAGE_WHITE",l.textInputPlaceholderText="Describe image changes",l.introPanelMarkUp='\n    <div style="width: 100%; text-align: center; margin-left: -10px"><b>Stability AI</b></div>\n    <div style="width: 100%; text-align: center; margin-left: -10px; margin-top: 5px"><b>Image to Image Masking</b></div>\n    <p>Upload an image, its mask image to create a new one based on the changes you have described for the mask area.</p>\n    <p>Click <a href="https://platform.stability.ai/">here</a> for more info.</p>';var b=null==(d=p?.stabilityAI)?void 0:d.imageToImageMasking;return"object"==_typeof(b)&&(b.engine_id&&(l.url="https://api.stability.ai/v1/generation/".concat(b.engine_id,"/image-to-image/masking")),null!=b.weight&&(l._imageWeight=b.weight),null!=b.mask_source&&(l._maskSource=b.mask_source),s.cleanConfig(b),Object.assign(l.rawBody,b)),l.canSendMessage=s.canSendFileTextMessage,l}return _createClass(s,[{key:"createFormDataBody",value:function(l,d,p,m){var v=new FormData;return v.append("init_image",d),v.append("mask_source",String(this._maskSource)),v.append("mask_image",p),m&&""!==m&&v.append("text_prompts[0][text]",m),null!=this._imageWeight&&v.append("text_prompts[0][weight]",String(this._imageWeight)),Object.keys(l).forEach(function(b){v.append(b,String(l[b]))}),void 0===v.get("weight")&&v.append("weight",String(1)),v}},{key:"callServiceAPI",value:(u=_asyncToGenerator(_regeneratorRuntime().mark(function d(p,m,v){var b,w,S,M;return _regeneratorRuntime().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:if(this.requestSettings){k.next=2;break}throw new Error("Request settings have not been set up");case 2:if(v&&v[0]&&v[1]){k.next=4;break}throw new Error("Image was not found");case 4:S=null==(w=null==(b=m[m.length-1])?void 0:b.text)?void 0:w.trim(),M=this.createFormDataBody(this.rawBody,v[0],v[1],S),RequestUtils.temporarilyRemoveHeader(this.requestSettings,HTTPRequest.request.bind(this,this,M,p),!1);case 6:case"end":return k.stop()}},d,this)})),function l(d,p,m){return u.apply(this,arguments)})},{key:"extractResultData",value:function(){var u=_asyncToGenerator(_regeneratorRuntime().mark(function d(p){return _regeneratorRuntime().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(!p.message){v.next=2;break}throw p.message;case 2:return v.abrupt("return",{files:p.artifacts.map(function(b){return{src:"".concat(BASE_64_PREFIX).concat(b.base64),type:"image"}})});case 3:case"end":return v.stop()}},d)}));return function l(d){return u.apply(this,arguments)}}()}],[{key:"cleanConfig",value:function(l){delete l.engine_id,delete l.weight}},{key:"canSendFileTextMessage",value:function(l,d){return!(null==d||!d[0]||!l||""===l.trim())}}]),s}(StabilityAIIO),HuggingFaceAudioRecognitionIO=function(a){_inherits(s,a);var u,h=_createSuper(s);function s(u){_classCallCheck(this,s);var l,d,p,m=null==(d=null==(l=u.directConnection)?void 0:l.huggingFace)?void 0:d.audioSpeechRecognition,v=null==(p=u.directConnection)?void 0:p.huggingFace;return h.call(this,u,"Attach an audio file","facebook/wav2vec2-large-960h-lv60-self",m,v,{audio:{}})}return _createClass(s,[{key:"extractPollResultData",value:(u=_asyncToGenerator(_regeneratorRuntime().mark(function d(p){return _regeneratorRuntime().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(!p.estimated_time){v.next=2;break}return v.abrupt("return",{timeoutMS:1e3*(p.estimated_time+1)});case 2:if(!p.error){v.next=4;break}throw p.error;case 4:return v.abrupt("return",{text:p.text||""});case 5:case"end":return v.stop()}},d)})),function l(d){return u.apply(this,arguments)})}]),s}(HuggingFaceFileIO),HuggingFaceTextGenerationIO=function(a){_inherits(s,a);var u,h=_createSuper(s);function s(u){_classCallCheck(this,s);var l,d,p,m=null==(d=null==(l=u.directConnection)?void 0:l.huggingFace)?void 0:d.textGeneration,v=null==(p=u.directConnection)?void 0:p.huggingFace;return h.call(this,u,"Once upon a time","gpt2",m,v)}return _createClass(s,[{key:"extractResultData",value:(u=_asyncToGenerator(_regeneratorRuntime().mark(function d(p){return _regeneratorRuntime().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(!p.error){v.next=2;break}throw p.error;case 2:return v.abrupt("return",{text:p[0].generated_text||""});case 3:case"end":return v.stop()}},d)})),function l(d){return u.apply(this,arguments)})}]),s}(HuggingFaceIO),HuggingFaceQuestionAnswerIO=function(a){_inherits(s,a);var u,h=_createSuper(s);function s(u){var l;_classCallCheck(this,s);var d,p,m,v=null==(p=null==(d=u.directConnection)?void 0:d.huggingFace)?void 0:p.questionAnswer,b=null==(m=u.directConnection)?void 0:m.huggingFace;return(l=h.call(this,u,"Ask a question","bert-large-uncased-whole-word-masking-finetuned-squad",v,b)).permittedErrorPrefixes=["Authorization header","Error in"],l.context=v.context,l}return _createClass(s,[{key:"preprocessBody",value:function(l,d){var p=d[d.length-1].text;if(p)return{inputs:{question:p,context:this.context,options:{wait_for_model:!0}}}}},{key:"extractResultData",value:(u=_asyncToGenerator(_regeneratorRuntime().mark(function d(p){return _regeneratorRuntime().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(!p.error){v.next=2;break}throw p.error;case 2:return v.abrupt("return",{text:p.answer||""});case 3:case"end":return v.stop()}},d)})),function l(d){return u.apply(this,arguments)})}]),s}(HuggingFaceIO),HuggingFaceSummarizationIO=function(a){_inherits(s,a);var u,h=_createSuper(s);function s(u){_classCallCheck(this,s);var l,d,p,m=null==(d=null==(l=u.directConnection)?void 0:l.huggingFace)?void 0:d.summarization,v=null==(p=u.directConnection)?void 0:p.huggingFace;return h.call(this,u,"Insert text to summarize","facebook/bart-large-cnn",m,v)}return _createClass(s,[{key:"extractResultData",value:(u=_asyncToGenerator(_regeneratorRuntime().mark(function d(p){return _regeneratorRuntime().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(!p.error){v.next=2;break}throw p.error;case 2:return v.abrupt("return",{text:p[0].summary_text||""});case 3:case"end":return v.stop()}},d)})),function l(d){return u.apply(this,arguments)})}]),s}(HuggingFaceIO),HuggingFaceConversationIO=function(a){_inherits(s,a);var u,h=_createSuper(s);function s(u){var l;_classCallCheck(this,s);var d,p,m,v=null==(p=null==(d=u.directConnection)?void 0:d.huggingFace)?void 0:p.conversation,b=null==(m=u.directConnection)?void 0:m.huggingFace;return void 0===(l=h.call(this,u,"Ask me anything!","facebook/blenderbot-400M-distill",v,b)).maxMessages&&(l.maxMessages=-1),l}return _createClass(s,[{key:"processMessages",value:function(l){var d=l[l.length-1].text,p=l.slice(0,l.length-1);if(d)return{past_user_inputs:p.filter(function(b){return"user"===b.role}).map(function(b){return b.text}),generated_responses:p.filter(function(b){return"ai"===b.role}).map(function(b){return b.text}),mostRecentMessageText:d}}},{key:"preprocessBody",value:function(l,d){var p,m=JSON.parse(JSON.stringify(l)),v=this.processMessages(d);if(v)return null!==(p=m.options)&&void 0!==p||(m.options={}),m.options.wait_for_model=!0,_objectSpread({inputs:{past_user_inputs:v.past_user_inputs,generated_responses:v.generated_responses,text:v.mostRecentMessageText}},m)}},{key:"extractResultData",value:(u=_asyncToGenerator(_regeneratorRuntime().mark(function d(p){return _regeneratorRuntime().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(!p.error){v.next=2;break}throw p.error;case 2:return v.abrupt("return",{text:p.generated_text||""});case 3:case"end":return v.stop()}},d)})),function l(d){return u.apply(this,arguments)})}]),s}(HuggingFaceIO),StabilityAIImageToImageIO=function(a){_inherits(s,a);var u,h=_createSuper(s);function s(u){var l;_classCallCheck(this,s);var d,p=JSON.parse(JSON.stringify(u.directConnection)),m=p.stabilityAI;(l=h.call(this,u,StabilityAIUtils.buildKeyVerificationDetails(),StabilityAIUtils.buildHeaders,m,{images:{files:{acceptedFormats:".png",maxNumberOfFiles:1}}})).url="https://api.stability.ai/v1/generation/stable-diffusion-v1-5/image-to-image",l.textInputPlaceholderText="Describe image changes",l.introPanelMarkUp='\n    <div style="width: 100%; text-align: center; margin-left: -10px"><b>Stability AI: Image to Image</b></div>\n    <p>Upload an image to create a new one with the changes you have described.</p>\n    <p>Click <a href="https://platform.stability.ai/">here</a> for more info.</p>';var b=null==(d=p.stabilityAI)?void 0:d.imageToImage;return"object"==_typeof(b)&&(b.engine_id&&(l.url="https://api.stability.ai/v1/generation/".concat(b.engine_id,"/text-to-image")),null!=b.weight&&(l._imageWeight=b.weight),s.cleanConfig(b),Object.assign(l.rawBody,b)),l.canSendMessage=s.canSendFileTextMessage,l}return _createClass(s,[{key:"createFormDataBody",value:function(l,d,p){var m=new FormData;return m.append("init_image",d),p&&""!==p&&m.append("text_prompts[0][text]",p),null!=this._imageWeight&&m.append("text_prompts[0][weight]",String(this._imageWeight)),Object.keys(l).forEach(function(v){m.append(v,String(l[v]))}),void 0===m.get("weight")&&m.append("weight",String(1)),m}},{key:"callServiceAPI",value:(u=_asyncToGenerator(_regeneratorRuntime().mark(function d(p,m,v){var b,w,S,M;return _regeneratorRuntime().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:if(this.requestSettings){k.next=2;break}throw new Error("Request settings have not been set up");case 2:if(v){k.next=4;break}throw new Error("Image was not found");case 4:S=null==(w=null==(b=m[m.length-1])?void 0:b.text)?void 0:w.trim(),M=this.createFormDataBody(this.rawBody,v[0],S),RequestUtils.temporarilyRemoveHeader(this.requestSettings,HTTPRequest.request.bind(this,this,M,p),!1);case 6:case"end":return k.stop()}},d,this)})),function l(d,p,m){return u.apply(this,arguments)})},{key:"extractResultData",value:function(){var u=_asyncToGenerator(_regeneratorRuntime().mark(function d(p){return _regeneratorRuntime().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(!p.message){v.next=2;break}throw p.message;case 2:return v.abrupt("return",{files:p.artifacts.map(function(b){return{src:"".concat(BASE_64_PREFIX).concat(b.base64),type:"image"}})});case 3:case"end":return v.stop()}},d)}));return function l(d){return u.apply(this,arguments)}}()}],[{key:"cleanConfig",value:function(l){delete l.engine_id,delete l.weight}},{key:"canSendFileTextMessage",value:function(l,d){return!(null==d||!d[0]||!l||""===l.trim())}}]),s}(StabilityAIIO),HuggingFaceTranslationIO=function(a){_inherits(s,a);var u,h=_createSuper(s);function s(u){_classCallCheck(this,s);var l,d,p,m=null==(d=null==(l=u.directConnection)?void 0:l.huggingFace)?void 0:d.translation,v=null==(p=u.directConnection)?void 0:p.huggingFace;return h.call(this,u,"Insert text to translate","Helsinki-NLP/opus-tatoeba-en-ja",m,v)}return _createClass(s,[{key:"extractResultData",value:(u=_asyncToGenerator(_regeneratorRuntime().mark(function d(p){return _regeneratorRuntime().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(!p.error){v.next=2;break}throw p.error;case 2:return v.abrupt("return",{text:p[0].translation_text||""});case 3:case"end":return v.stop()}},d)})),function l(d){return u.apply(this,arguments)})}]),s}(HuggingFaceIO),StabilityAITextToImageIO=function(a){_inherits(s,a);var u,h=_createSuper(s);function s(u){var l;_classCallCheck(this,s);var d,p=JSON.parse(JSON.stringify(u.directConnection)),m=p.stabilityAI;(l=h.call(this,u,StabilityAIUtils.buildKeyVerificationDetails(),StabilityAIUtils.buildHeaders,m)).url="https://api.stability.ai/v1/generation/stable-diffusion-v1-5/text-to-image",l.textInputPlaceholderText="Describe an image",l.introPanelMarkUp='\n    <div style="width: 100%; text-align: center; margin-left: -10px"><b>Stability AI: Text to Image</b></div>\n    <p>Insert text to generate an image.</p>\n    <p>Click <a href="https://platform.stability.ai/">here</a> for more info.</p>';var v=null==(d=p.stabilityAI)?void 0:d.textToImage;return"object"==_typeof(v)&&(v.engine_id&&(l.url="https://api.stability.ai/v1/generation/".concat(v.engine_id,"/text-to-image")),null!=v.weight&&(l._imageWeight=v.weight),s.cleanConfig(v),Object.assign(l.rawBody,v)),l.canSendMessage=s.canSendTextMessage,l}return _createClass(s,[{key:"preprocessBody",value:function(l,d){var p=JSON.parse(JSON.stringify(l)),m={text:d};return this._imageWeight&&(m.weight=this._imageWeight),p.text_prompts=[m],p}},{key:"callServiceAPI",value:(u=_asyncToGenerator(_regeneratorRuntime().mark(function d(p,m){var v;return _regeneratorRuntime().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:if(this.requestSettings){w.next=2;break}throw new Error("Request settings have not been set up");case 2:v=this.preprocessBody(this.rawBody,m[m.length-1].text),HTTPRequest.request(this,v,p);case 4:case"end":return w.stop()}},d,this)})),function l(d,p){return u.apply(this,arguments)})},{key:"extractResultData",value:function(){var u=_asyncToGenerator(_regeneratorRuntime().mark(function d(p){return _regeneratorRuntime().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(!p.message){v.next=2;break}throw p.message;case 2:return v.abrupt("return",{files:p.artifacts.map(function(b){return{src:"".concat(BASE_64_PREFIX).concat(b.base64),type:"image"}})});case 3:case"end":return v.stop()}},d)}));return function l(d){return u.apply(this,arguments)}}()}],[{key:"cleanConfig",value:function(l){delete l.engine_id,delete l.weight}},{key:"canSendTextMessage",value:function(l){return!(!l||""===l.trim())}}]),s}(StabilityAIIO),HuggingFaceFillMaskIO=function(a){_inherits(s,a);var u,h=_createSuper(s);function s(u){var l;_classCallCheck(this,s);var d,p,m,v=null==(p=null==(d=u.directConnection)?void 0:d.huggingFace)?void 0:p.fillMask,b=null==(m=u.directConnection)?void 0:m.huggingFace;return(l=h.call(this,u,"The goal of life is [MASK].","bert-base-uncased",v,b)).introPanelMarkUp='\n    <div style="width: 100%; text-align: center; margin-left: -10px"><b>Hugging Face</b></div>\n    <p>Insert a sentence with the word [MASK] and the model will try to fill it for you. E.g. I want [MASK].</p>\n    <p>First message may take an extented amount of time to complete as the model needs to be initialized.</p>',l.permittedErrorPrefixes=["Authorization header","No mask_token"],l}return _createClass(s,[{key:"extractResultData",value:(u=_asyncToGenerator(_regeneratorRuntime().mark(function d(p){return _regeneratorRuntime().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(!p.error){v.next=2;break}throw p.error;case 2:return v.abrupt("return",{text:p[0].sequence||""});case 3:case"end":return v.stop()}},d)})),function l(d){return u.apply(this,arguments)})}]),s}(HuggingFaceIO),CohereUtils=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"buildHeaders",value:function(s){return{Authorization:"Bearer ".concat(s),"Content-Type":"application/json",accept:"application/json"}}},{key:"handleVerificationResult",value:function(s,u,l,d){"invalid request: prompt must be at least 1 token long"===s.message?l(u):d(ErrorMessages.INVALID_KEY)}},{key:"buildKeyVerificationDetails",value:function(){return{url:"https://api.cohere.ai/v1/generate",method:"POST",handleVerificationResult:a.handleVerificationResult,body:JSON.stringify({prompt:""})}}}]),a}(),CohereIO=function(a){_inherits(s,a);var h=_createSuper(s);function s(u,l,d,p,m){var v;return _classCallCheck(this,s),(v=h.call(this,u,CohereUtils.buildKeyVerificationDetails(),CohereUtils.buildHeaders,m)).insertKeyPlaceholderText="Cohere API Key",v.getKeyLink="https://dashboard.cohere.ai/api-keys",v.permittedErrorPrefixes=["invalid"],v.url=l,v.textInputPlaceholderText=d,p&&"object"==_typeof(p)&&Object.assign(v.rawBody,p),v}return _createClass(s)}(DirectServiceIO),CohereTextGenerationIO=function(a){_inherits(s,a);var u,h=_createSuper(s);function s(u){_classCallCheck(this,s);var l,d,p,m=null==(d=null==(l=u.directConnection)?void 0:l.cohere)?void 0:d.textGeneration,v=null==(p=u.directConnection)?void 0:p.cohere;return h.call(this,u,"https://api.cohere.ai/v1/generate","Once upon a time",m,v)}return _createClass(s,[{key:"preprocessBody",value:function(l,d){var p=JSON.parse(JSON.stringify(l)),m=d[d.length-1].text;if(m)return _objectSpread({prompt:m},p)}},{key:"callServiceAPI",value:(u=_asyncToGenerator(_regeneratorRuntime().mark(function d(p,m){var v;return _regeneratorRuntime().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:if(this.requestSettings){w.next=2;break}throw new Error("Request settings have not been set up");case 2:v=this.preprocessBody(this.rawBody,m),HTTPRequest.request(this,v,p);case 4:case"end":return w.stop()}},d,this)})),function l(d,p){return u.apply(this,arguments)})},{key:"extractResultData",value:function(){var u=_asyncToGenerator(_regeneratorRuntime().mark(function d(p){var m;return _regeneratorRuntime().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:if(!p.message){b.next=2;break}throw p.message;case 2:return b.abrupt("return",{text:(null==(m=p.generations)?void 0:m[0].text)||""});case 3:case"end":return b.stop()}},d)}));return function l(d){return u.apply(this,arguments)}}()}]),s}(CohereIO),CohereSummarizationIO=function(a){_inherits(s,a);var u,h=_createSuper(s);function s(u){_classCallCheck(this,s);var l,d,p,m=null==(d=null==(l=u.directConnection)?void 0:l.cohere)?void 0:d.summarization,v=null==(p=u.directConnection)?void 0:p.cohere;return h.call(this,u,"https://api.cohere.ai/v1/summarize","Insert text to summarize",m,v)}return _createClass(s,[{key:"preprocessBody",value:function(l,d){var p=JSON.parse(JSON.stringify(l)),m=d[d.length-1].text;if(m)return _objectSpread({text:m},p)}},{key:"callServiceAPI",value:(u=_asyncToGenerator(_regeneratorRuntime().mark(function d(p,m){var v;return _regeneratorRuntime().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:if(this.requestSettings){w.next=2;break}throw new Error("Request settings have not been set up");case 2:v=this.preprocessBody(this.rawBody,m),HTTPRequest.request(this,v,p);case 4:case"end":return w.stop()}},d,this)})),function l(d,p){return u.apply(this,arguments)})},{key:"extractResultData",value:function(){var u=_asyncToGenerator(_regeneratorRuntime().mark(function d(p){return _regeneratorRuntime().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(!p.message){v.next=2;break}throw p.message;case 2:return v.abrupt("return",{text:p.summary||""});case 3:case"end":return v.stop()}},d)}));return function l(d){return u.apply(this,arguments)}}()}]),s}(CohereIO),AzureUtils=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"buildTextToSpeechHeaders",value:function(s,u){return{"Ocp-Apim-Subscription-Key":u,"Content-Type":"application/ssml+xml","X-Microsoft-OutputFormat":s}}},{key:"buildSpeechToTextHeaders",value:function(s){return{"Ocp-Apim-Subscription-Key":s,Accept:"application/json"}}},{key:"handleSpeechVerificationResult",value:function(s,u,l,d){s.error?d(ErrorMessages.INVALID_KEY):l(u)}},{key:"buildSpeechKeyVerificationDetails",value:function(s){return{url:"https://".concat(s,".api.cognitive.microsoft.com/sts/v1.0/issuetoken"),method:"POST",createHeaders:function(l){return{"Ocp-Apim-Subscription-Key":"".concat(l)}},handleVerificationResult:a.handleSpeechVerificationResult}}},{key:"buildSummarizationHeader",value:function(s){return{"Ocp-Apim-Subscription-Key":s,"Content-Type":"application/json"}}},{key:"handleLanguageVerificationResult",value:function(s,u,l,d){var p;"401"===(null==(p=s.error)?void 0:p.code)?d(ErrorMessages.INVALID_KEY):l(u)}},{key:"buildLanguageKeyVerificationDetails",value:function(s){return{url:"".concat(s,"/language/analyze-text/jobs?api-version=2022-10-01-preview"),method:"POST",createHeaders:function(l){return{"Ocp-Apim-Subscription-Key":"".concat(l)}},handleVerificationResult:a.handleLanguageVerificationResult}}},{key:"handleTranslationVerificationResult",value:function(s,u,l,d){s.json().then(function(p){Array.isArray(p)||401e3!==p.error.code?l(u):d(ErrorMessages.INVALID_KEY)})}},{key:"buildTranslationKeyVerificationDetails",value:function(s){return{url:"https://api.cognitive.microsofttranslator.com/translate?api-version=3.0&to=es",method:"POST",createHeaders:function(l){return a.buildTranslationHeaders(s,l)},handleVerificationResult:a.handleTranslationVerificationResult}}},{key:"buildTranslationHeaders",value:function(s,u){var l={"Ocp-Apim-Subscription-Key":u,"Content-Type":"application/json"};return s&&(l["Ocp-Apim-Subscription-Region"]=s),l}}]),a}(),AzureLanguageIO=function(a){_inherits(s,a);var h=_createSuper(s);function s(u,l,d,p,m){var v;return _classCallCheck(this,s),(v=h.call(this,u,AzureUtils.buildLanguageKeyVerificationDetails(d),l,p,m)).insertKeyPlaceholderText="Azure Language Subscription Key",v.getKeyLink="https://learn.microsoft.com/en-us/azure/api-management/api-management-subscriptions#create-and-manage-subscriptions-in-azure-portal",v.permittedErrorPrefixes=["Access"],v}return _createClass(s)}(DirectServiceIO),AzureSummarizationIO=function(a){_inherits(s,a);var u,h=_createSuper(s);function s(u){var l,d;_classCallCheck(this,s);var p,m,v,b,w=null==(m=null==(p=u.directConnection)?void 0:p.azure)?void 0:m.summarization,S=null==(v=u.directConnection)?void 0:v.azure;return(d=h.call(this,u,AzureUtils.buildSummarizationHeader,w.endpoint,S)).url="",d.textInputPlaceholderText="Insert text to summarize",null!==(l=(b=d.rawBody).language)&&void 0!==l||(b.language="en"),Object.assign(d.rawBody,w),d.url="".concat(w.endpoint,"/language/analyze-text/jobs?api-version=2022-10-01-preview"),d}return _createClass(s,[{key:"preprocessBody",value:function(l,d){var p=d[d.length-1].text;if(p)return{analysisInput:{documents:[{id:"1",language:l.language,text:p}]},tasks:[{kind:"ExtractiveSummarization"}]}}},{key:"callServiceAPI",value:(u=_asyncToGenerator(_regeneratorRuntime().mark(function d(p,m){var v;return _regeneratorRuntime().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:if(this.requestSettings){w.next=2;break}throw new Error("Request settings have not been set up");case 2:v=this.preprocessBody(this.rawBody,m),HTTPRequest.request(this,v,p),this.messages=p;case 4:case"end":return w.stop()}},d,this)})),function l(d,p){return u.apply(this,arguments)})},{key:"extractResultData",value:function(){var u=_asyncToGenerator(_regeneratorRuntime().mark(function d(p){var m,v,b;return _regeneratorRuntime().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(!p.error){S.next=2;break}throw p.error.message;case 2:return this.messages&&this.completionsHandlers&&(v=p.headers.get("operation-location"),b={method:"GET",headers:null==(m=this.requestSettings)?void 0:m.headers},HTTPRequest.executePollRequest(this,v,b,this.messages)),S.abrupt("return",{pollingInAnotherRequest:!0});case 4:case"end":return S.stop()}},d,this)}));return function l(d){return u.apply(this,arguments)}}()},{key:"extractPollResultData",value:function(){var u=_asyncToGenerator(_regeneratorRuntime().mark(function d(p){var m,v,b;return _regeneratorRuntime().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:if(!p.error){M.next=2;break}throw p.error;case 2:if("running"!==p.status){M.next=4;break}return M.abrupt("return",{timeoutMS:2e3});case 4:if(!(p.errors.length>0)){M.next=6;break}throw p.errors[0];case 6:if(!(p.tasks.items[0].results.errors.length>0)){M.next=8;break}throw p.tasks.items[0].results.errors[0];case 8:m="",v=_createForOfIteratorHelper(p.tasks.items[0].results.documents[0].sentences);try{for(v.s();!(b=v.n()).done;)m+=b.value.text}catch(A){v.e(A)}finally{v.f()}return M.abrupt("return",{text:m||""});case 12:case"end":return M.stop()}},d)}));return function l(d){return u.apply(this,arguments)}}()}]),s}(AzureLanguageIO),_OpenAIConverseBaseBody=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"generateDefaultBody",value:function(s){return{model:s}}},{key:"build",value:function(s,u){var l=a.generateDefaultBody(s);return u&&"boolean"!=typeof u?Object.assign(l,u):l}}]),a}();_OpenAIConverseBaseBody.GPT_COMPLETIONS_DAVINCI_MODEL="text-davinci-003",_OpenAIConverseBaseBody.GPT_CHAT_TURBO_MODEL="gpt-3.5-turbo";var OpenAIConverseBaseBody=_OpenAIConverseBaseBody,_OpenAIUtils=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"buildHeaders",value:function(s){return{Authorization:"Bearer ".concat(s),"Content-Type":"application/json"}}},{key:"handleVerificationResult",value:function(s,u,l,d){s.error?d("invalid_api_key"===s.error.code?ErrorMessages.INVALID_KEY:ErrorMessages.CONNECTION_FAILED):l(u)}},{key:"buildKeyVerificationDetails",value:function(){return{url:"https://api.openai.com/v1/models",method:"GET",handleVerificationResult:a.handleVerificationResult}}}]),a}();_OpenAIUtils.CONVERSE_MAX_CHAR_LENGTH=13352,_OpenAIUtils.FILE_MAX_CHAR_LENGTH=1e3;var OpenAIUtils=_OpenAIUtils,OpenAICompletionsIO=function(a){_inherits(s,a);var u,h=_createSuper(s);function s(u){var l,d;_classCallCheck(this,s);var p,m,v=u.directConnection,b=u.textInput,w=v?.openAI;(d=h.call(this,u,OpenAIUtils.buildKeyVerificationDetails(),OpenAIUtils.buildHeaders,w)).insertKeyPlaceholderText="OpenAI API Key",d.getKeyLink="https://platform.openai.com/account/api-keys",d.url="https://api.openai.com/v1/completions",d.permittedErrorPrefixes=["Incorrect"],d._maxCharLength=OpenAIUtils.CONVERSE_MAX_CHAR_LENGTH,d.full_transaction_max_tokens=4e3,d.numberOfCharsPerToken=3.5;var S=null==(p=v?.openAI)?void 0:p.completions;return null!=b&&b.characterLimit&&(d._maxCharLength=b.characterLimit),"object"==_typeof(S)&&Object.assign(d.rawBody,S),null!==(l=(m=d.rawBody).model)&&void 0!==l||(m.model=OpenAIConverseBaseBody.GPT_COMPLETIONS_DAVINCI_MODEL),d}return _createClass(s,[{key:"preprocessBody",value:function(l,d){var p=JSON.parse(JSON.stringify(l)),m=d[d.length-1].text;if(m){var v=m.substring(0,this._maxCharLength);return _objectSpread({prompt:v,max_tokens:Math.floor(p.max_tokens||this.full_transaction_max_tokens-v.length/this.numberOfCharsPerToken)},p)}}},{key:"callServiceAPI",value:(u=_asyncToGenerator(_regeneratorRuntime().mark(function d(p,m){var v;return _regeneratorRuntime().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:if(this.requestSettings){w.next=2;break}throw new Error("Request settings have not been set up");case 2:v=this.preprocessBody(this.rawBody,m),this.deepChat.stream||v.stream?(v.stream=!0,Stream.request(this,v,p)):HTTPRequest.request(this,v,p);case 4:case"end":return w.stop()}},d,this)})),function l(d,p){return u.apply(this,arguments)})},{key:"extractResultData",value:function(){var u=_asyncToGenerator(_regeneratorRuntime().mark(function d(p){var m;return _regeneratorRuntime().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:if(!p.error){b.next=2;break}throw p.error.message;case 2:return b.abrupt("return",{text:(null==(m=p.choices[0])?void 0:m.text)||""});case 3:case"end":return b.stop()}},d)}));return function l(d){return u.apply(this,arguments)}}()}]),s}(DirectServiceIO),AssemblyAIUtils=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"poll",value:(h=_asyncToGenerator(_regeneratorRuntime().mark(function u(l,d){var p,m,v,b;return _regeneratorRuntime().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return p={authorization:l,"content-type":"application/json"},S.t0="https://api.assemblyai.com/v2/transcript/",S.next=4,fetch("https://api.assemblyai.com/v2/transcript",{method:"POST",body:JSON.stringify({audio_url:d}),headers:p});case 4:return S.next=6,S.sent.json();case 6:S.t1=S.sent.id,m=S.t0.concat.call(S.t0,S.t1);case 8:if(v){S.next=24;break}return S.next=11,fetch(m,{headers:p});case 11:return S.next=13,S.sent.json();case 13:if("completed"!==(b=S.sent).status){S.next=18;break}v=b,S.next=22;break;case 18:if("error"!==b.status){S.next=20;break}throw new Error("Transcription failed: ".concat(b.error));case 20:return S.next=22,new Promise(function(M){return setTimeout(M,3e3)});case 22:S.next=8;break;case 24:return S.abrupt("return",v);case 25:case"end":return S.stop()}},u)})),function s(u,l){return h.apply(this,arguments)})},{key:"buildHeaders",value:function(s){return{Authorization:s,"Content-Type":"application/octet-stream"}}},{key:"handleVerificationResult",value:function(s,u,l,d){s.error?d("invalid_api_key"===s.error.code?ErrorMessages.INVALID_KEY:ErrorMessages.CONNECTION_FAILED):l(u)}},{key:"buildKeyVerificationDetails",value:function(){return{url:"https://api.assemblyai.com/v2/upload",method:"POST",handleVerificationResult:a.handleVerificationResult}}}]),a;var h}(),AssemblyAIAudioIO=function(a){_inherits(s,a);var u,h=_createSuper(s);function s(u){var l;_classCallCheck(this,s);var d,p=null==(d=u.directConnection)?void 0:d.assemblyAI;return(l=h.call(this,u,AssemblyAIUtils.buildKeyVerificationDetails(),AssemblyAIUtils.buildHeaders,p,{audio:{}})).insertKeyPlaceholderText="AssemblyAI API Key",l.getKeyLink="https://www.assemblyai.com/app/account",l.introPanelMarkUp='\n    <div style="width: 100%; text-align: center; margin-left: -10px"><b>AssemblyAI Audio</b></div>\n    <p><b>Upload an audio file</b> to transcribe it into text.\n    <p>\n      Click <a href="https://www.assemblyai.com/docs/Guides/transcribing_an_audio_file#get-started">here</a> for more info.\n    </p>',l.url="https://api.assemblyai.com/v2/upload",l.isTextInputDisabled=!0,l.textInputPlaceholderText="Upload an audio file",l.permittedErrorPrefixes=["Authentication","Invalid"],l.canSendMessage=s.canFileSendMessage,l}return _createClass(s,[{key:"callServiceAPI",value:(u=_asyncToGenerator(_regeneratorRuntime().mark(function d(p,m,v){var b;return _regeneratorRuntime().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(null!=(b=this.requestSettings)&&b.headers){S.next=2;break}throw new Error("Request settings have not been set up");case 2:if(null!=v&&v[0]){S.next=4;break}throw new Error("No file was added");case 4:HTTPRequest.request(this,v[0],p,!1);case 5:case"end":return S.stop()}},d,this)})),function l(d,p,m){return u.apply(this,arguments)})},{key:"extractResultData",value:function(){var u=_asyncToGenerator(_regeneratorRuntime().mark(function d(p){var m,v,b;return _regeneratorRuntime().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(!p.error){S.next=2;break}throw p.error;case 2:return b=null==(v=null==(m=this.requestSettings)?void 0:m.headers)?void 0:v.Authorization,S.next=5,AssemblyAIUtils.poll(b,p.upload_url);case 5:return S.t0=S.sent.text,S.abrupt("return",{text:S.t0});case 7:case"end":return S.stop()}},d,this)}));return function l(d){return u.apply(this,arguments)}}()}],[{key:"canFileSendMessage",value:function(l,d){return!(null==d||!d[0])}}]),s}(DirectServiceIO),AzureSpeechIO=function(a){_inherits(s,a);var h=_createSuper(s);function s(u,l,d,p,m){var v;return _classCallCheck(this,s),(v=h.call(this,u,AzureUtils.buildSpeechKeyVerificationDetails(d),l,p,m)).insertKeyPlaceholderText="Azure Speech Subscription Key",v.getKeyLink="https://learn.microsoft.com/en-us/azure/api-management/api-management-subscriptions#create-and-manage-subscriptions-in-azure-portal",v}return _createClass(s)}(DirectServiceIO),_AzureTextToSpeechIO=function(a){_inherits(s,a);var u,h=_createSuper(s);function s(u){var l,d,p,m;_classCallCheck(this,s);var v,b,w,S,M,A,k=null==(b=null==(v=u.directConnection)?void 0:v.azure)?void 0:b.textToSpeech,N=null==(w=u.directConnection)?void 0:w.azure;return(m=h.call(this,u,AzureUtils.buildTextToSpeechHeaders.bind({},k?.outputFormat||"audio-16khz-128kbitrate-mono-mp3"),k.region,N)).introPanelMarkUp='\n    <div style="width: 100%; text-align: center; margin-left: -10px"><b>Azure Text To Speech</b></div>\n    <p>Insert text to synthesize it to audio.\n    <p>\n      Click <a href="'.concat(s.HELP_LINK,'">here</a> for more info.\n    </p>'),m.url="",Object.assign(m.rawBody,k),null!==(l=(S=m.rawBody).lang)&&void 0!==l||(S.lang="en-US"),null!==(d=(M=m.rawBody).name)&&void 0!==d||(M.name="en-US-JennyNeural"),null!==(p=(A=m.rawBody).gender)&&void 0!==p||(A.gender="Female"),m.url="https://".concat(k.region,".tts.speech.microsoft.com/cognitiveservices/v1"),m}return _createClass(s,[{key:"preprocessBody",value:function(l,d){var p=d[d.length-1].text;if(p)return"<speak version='1.0' xml:lang='".concat(l.lang,"'>\n      <voice xml:lang='").concat(l.lang,"' xml:gender='").concat(l.gender,"' name='").concat(l.name,"'>\n        ").concat(p,"\n      </voice>\n    </speak>")}},{key:"callServiceAPI",value:(u=_asyncToGenerator(_regeneratorRuntime().mark(function d(p,m){var v;return _regeneratorRuntime().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:if(this.requestSettings){w.next=2;break}throw new Error("Request settings have not been set up");case 2:v=this.preprocessBody(this.rawBody,m),HTTPRequest.request(this,v,p,!1);case 4:case"end":return w.stop()}},d,this)})),function l(d,p){return u.apply(this,arguments)})},{key:"extractResultData",value:function(){var u=_asyncToGenerator(_regeneratorRuntime().mark(function d(p){return _regeneratorRuntime().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.abrupt("return",new Promise(function(b){var w=new FileReader;w.readAsDataURL(p),w.onload=function(S){b({files:[{src:S.target.result,type:"audio"}]})}}));case 1:case"end":return v.stop()}},d)}));return function l(d){return u.apply(this,arguments)}}()}]),s}(AzureSpeechIO);_AzureTextToSpeechIO.HELP_LINK="https://learn.microsoft.com/en-GB/azure/cognitive-services/speech-service/get-started-text-to-speech?tabs=windows%2Cterminal&pivots=programming-language-rest";var AzureTextToSpeechIO=_AzureTextToSpeechIO,_AzureSpeechToTextIO=function(a){_inherits(s,a);var u,h=_createSuper(s);function s(u){var l;_classCallCheck(this,s);var d,p,m,v=null==(p=null==(d=u.directConnection)?void 0:d.azure)?void 0:p.speechToText,b=null==(m=u.directConnection)?void 0:m.azure;(l=h.call(this,u,AzureUtils.buildSpeechToTextHeaders,v.region,b,{audio:{files:{acceptedFormats:".wav,.ogg"}}})).introPanelMarkUp='\n    <div style="width: 100%; text-align: center; margin-left: -10px"><b>Azure Speech To Text</b></div>\n    <p><b>Upload a .wav or .ogg audio file</b> to transcribe it into text.\n    <p>\n      Click <a href="'.concat(s.HELP_LINK,'">here</a> for more info.\n    </p>'),l.url="",l.isTextInputDisabled=!0,l.textInputPlaceholderText="Upload an audio file",l.canSendMessage=s.canFileSendMessage;var S=v.lang||"en-US";return l.url="https://".concat(v.region,".stt.speech.microsoft.com/speech/recognition/conversation/cognitiveservices/v1?language=").concat(S,"&format=detailed"),l.recordAudio=void 0,l}return _createClass(s,[{key:"callServiceAPI",value:(u=_asyncToGenerator(_regeneratorRuntime().mark(function d(p,m,v){var b,w;return _regeneratorRuntime().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:if(null!=(b=this.requestSettings)&&b.headers){M.next=2;break}throw new Error("Request settings have not been set up");case 2:if(null!=v&&v[0]){M.next=4;break}throw new Error("No file was added");case 4:null!=(w=this.requestSettings)&&w.headers&&(this.requestSettings.headers["Content-Type"]=v[0].name.toLocaleLowerCase().endsWith(".wav")?"audio/wav; codecs=audio/pcm; samplerate=16000":"audio/ogg; codecs=opus"),HTTPRequest.request(this,v[0],p,!1);case 5:case"end":return M.stop()}},d,this)})),function l(d,p,m){return u.apply(this,arguments)})},{key:"extractResultData",value:function(){var u=_asyncToGenerator(_regeneratorRuntime().mark(function d(p){return _regeneratorRuntime().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(!p.error){v.next=2;break}throw p.error;case 2:return v.abrupt("return",{text:p.DisplayText||""});case 3:case"end":return v.stop()}},d)}));return function l(d){return u.apply(this,arguments)}}()}],[{key:"canFileSendMessage",value:function(l,d){return!(null==d||!d[0])}}]),s}(AzureSpeechIO);_AzureSpeechToTextIO.HELP_LINK="https://learn.microsoft.com/en-GB/azure/cognitive-services/speech-service/get-started-text-to-speech?tabs=windows%2Cterminal&pivots=programming-language-rest";var AzureSpeechToTextIO=_AzureSpeechToTextIO,AzureTranslationIO=function(a){_inherits(s,a);var u,h=_createSuper(s);function s(u){var l;_classCallCheck(this,s);var d,p,m,v=null==(p=null==(d=u.directConnection)?void 0:d.azure)?void 0:p.translation,b=null==(m=u.directConnection)?void 0:m.azure;return(l=h.call(this,u,AzureUtils.buildTranslationKeyVerificationDetails(v.region),AzureUtils.buildTranslationHeaders.bind({},v?.region),b)).insertKeyPlaceholderText="Azure Translate Subscription Key",l.getKeyLink="https://learn.microsoft.com/en-us/azure/api-management/api-management-subscriptions#create-and-manage-subscriptions-in-azure-portal",l.url="",l.url="https://api.cognitive.microsofttranslator.com/translate?api-version=3.0&to=".concat(v.language||"es"),l}return _createClass(s,[{key:"preprocessBody",value:function(l){var d=l[l.length-1].text;if(d)return[{Text:d}]}},{key:"callServiceAPI",value:(u=_asyncToGenerator(_regeneratorRuntime().mark(function d(p,m){var v;return _regeneratorRuntime().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:if(this.requestSettings){w.next=2;break}throw new Error("Request settings have not been set up");case 2:v=this.preprocessBody(m),HTTPRequest.request(this,v,p);case 4:case"end":return w.stop()}},d,this)})),function l(d,p){return u.apply(this,arguments)})},{key:"extractResultData",value:function(){var u=_asyncToGenerator(_regeneratorRuntime().mark(function d(p){var m;return _regeneratorRuntime().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:if(!Array.isArray(p)){b.next=2;break}return b.abrupt("return",{text:(null==(m=p[0].translations)?void 0:m[0].text)||""});case 2:throw p.error;case 3:case"end":return b.stop()}},d)}));return function l(d){return u.apply(this,arguments)}}()}]),s}(DirectServiceIO),_OpenAIImagesIO=function(a){_inherits(s,a);var u,h=_createSuper(s);function s(u){var l;_classCallCheck(this,s);var d,p=u.directConnection,m=u.textInput,v=p?.openAI;(l=h.call(this,u,OpenAIUtils.buildKeyVerificationDetails(),OpenAIUtils.buildHeaders,v,{images:{files:{acceptedFormats:".png",maxNumberOfFiles:2}}})).insertKeyPlaceholderText="OpenAI API Key",l.getKeyLink="https://platform.openai.com/account/api-keys",l.introPanelMarkUp='\n    <div style="width: 100%; text-align: center; margin-left: -10px"><b>OpenAI DALL\xb7E</b></div>\n    <p><b>Insert text</b> to generate an image.</p>\n    <p><b>Upload 1</b> PNG image to generate its variation and optionally insert text to specify the change.</p>\n    <p><b>Upload 2</b> PNG images where the second is a copy of the first with a transparent area where the edit should\n      take place and text to specify the edit.</p>\n    <p>Click <a href="https://platform.openai.com/docs/guides/images/introduction">here</a> for more info.</p>',l.url="",l.permittedErrorPrefixes=["Incorrect","Invalid input image"],l._maxCharLength=OpenAIUtils.FILE_MAX_CHAR_LENGTH,null!=m&&m.characterLimit&&(l._maxCharLength=m.characterLimit);var w=null==(d=p?.openAI)?void 0:d.images;if(l.camera){var S="object"==_typeof(w)&&w.size?Number.parseInt(w.size):1024;l.camera.files={dimensions:{width:S,height:S}}}return"object"==_typeof(w)&&Object.assign(l.rawBody,w),l.canSendMessage=s.canFileSendMessage,l}return _createClass(s,[{key:"preprocessBody",value:function(l,d){var p=JSON.parse(JSON.stringify(l));if(d&&""!==d){var m=d.substring(0,this._maxCharLength);p.prompt=m}return p}},{key:"callApiWithImage",value:function(l,d,p){var m,v,b,w=null==(v=null==(m=d[d.length-1])?void 0:m.text)?void 0:v.trim();if(p[1]||w&&""!==w){this.url=s.IMAGE_EDIT_URL;var S=this.preprocessBody(this.rawBody,w);b=s.createFormDataBody(S,p[0],p[1])}else this.url=s.IMAGE_VARIATIONS_URL,b=s.createFormDataBody(this.rawBody,p[0]);RequestUtils.temporarilyRemoveHeader(this.requestSettings,HTTPRequest.request.bind(this,this,b,l),!1)}},{key:"callServiceAPI",value:(u=_asyncToGenerator(_regeneratorRuntime().mark(function d(p,m,v){var b,w;return _regeneratorRuntime().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:if(null!=(b=this.requestSettings)&&b.headers){M.next=2;break}throw new Error("Request settings have not been set up");case 2:if(null==v||!v[0]){M.next=6;break}this.callApiWithImage(p,m,v),M.next=11;break;case 6:if(this.requestSettings){M.next=8;break}throw new Error("Request settings have not been set up");case 8:this.url=s.IMAGE_GENERATION_URL,w=this.preprocessBody(this.rawBody,m[m.length-1].text),HTTPRequest.request(this,w,p);case 11:case"end":return M.stop()}},d,this)})),function l(d,p,m){return u.apply(this,arguments)})},{key:"extractResultData",value:function(){var u=_asyncToGenerator(_regeneratorRuntime().mark(function d(p){return _regeneratorRuntime().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(!p.error){v.next=2;break}throw p.error.message;case 2:return v.abrupt("return",{files:p.data.map(function(b){return b.url?{src:b.url,type:"image"}:{src:"".concat(BASE_64_PREFIX).concat(b.b64_json),type:"image"}})});case 3:case"end":return v.stop()}},d)}));return function l(d){return u.apply(this,arguments)}}()}],[{key:"canFileSendMessage",value:function(l,d){return!(null==d||!d[0])||!(!l||""===l.trim())}},{key:"createFormDataBody",value:function(l,d,p){var m=new FormData;return m.append("image",d),p&&m.append("mask",p),Object.keys(l).forEach(function(v){m.append(v,String(l[v]))}),m}}]),s}(DirectServiceIO);_OpenAIImagesIO.IMAGE_GENERATION_URL="https://api.openai.com/v1/images/generations",_OpenAIImagesIO.IMAGE_VARIATIONS_URL="https://api.openai.com/v1/images/variations",_OpenAIImagesIO.IMAGE_EDIT_URL="https://api.openai.com/v1/images/edits";var OpenAIImagesIO=_OpenAIImagesIO,_OpenAIAudioIO=function(a){_inherits(s,a);var u,h=_createSuper(s);function s(u){var l,d;_classCallCheck(this,s);var p,m,v=u.textInput,b=JSON.parse(JSON.stringify(u.directConnection)),w=b?.openAI;(d=h.call(this,u,OpenAIUtils.buildKeyVerificationDetails(),OpenAIUtils.buildHeaders,w,{audio:{}})).insertKeyPlaceholderText="OpenAI API Key",d.getKeyLink="https://platform.openai.com/account/api-keys",d.introPanelMarkUp='\n    <div style="width: 100%; text-align: center; margin-left: -10px"><b>OpenAI Whisper</b></div>\n    <p><b>Upload an audio file</b> to transcribe it into text. You can optionally provide text to guide the audio\n      processing.\n    <p>Click <a href="https://platform.openai.com/docs/api-reference/audio/create">here</a> for more info.</p>',d.url="",d.permittedErrorPrefixes=["Invalid"],d._maxCharLength=OpenAIUtils.FILE_MAX_CHAR_LENGTH,d._service_url=s.AUDIO_TRANSCRIPTIONS_URL,null!=v&&v.characterLimit&&(d._maxCharLength=v.characterLimit);var S=null==(p=b?.openAI)?void 0:p.audio;return"object"==_typeof(S)&&(d.processConfig(S),s.cleanConfig(S),Object.assign(d.rawBody,S)),null!==(l=(m=d.rawBody).model)&&void 0!==l||(m.model=s.DEFAULT_MODEL),d.rawBody.response_format="json",d.canSendMessage=s.canSendFileMessage,d}return _createClass(s,[{key:"processConfig",value:function(l){null!=l&&l.type&&"translation"===l.type&&(this._service_url=s.AUDIO_TRANSLATIONS_URL,delete l.language)}},{key:"preprocessBody",value:function(l,d,p){var m,v,b=JSON.parse(JSON.stringify(l)),w=null==(v=null==(m=d[d.length-p.length+1])?void 0:m.text)?void 0:v.trim();if(w&&""!==w){var S=w.substring(0,this._maxCharLength);b.prompt=S}return b}},{key:"callServiceAPI",value:(u=_asyncToGenerator(_regeneratorRuntime().mark(function d(p,m,v){var b,w,S;return _regeneratorRuntime().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:if(null!=(b=this.requestSettings)&&b.headers){A.next=2;break}throw new Error("Request settings have not been set up");case 2:if(null!=v&&v[0]){A.next=4;break}throw new Error("No file was added");case 4:this.url=this.requestSettings.url||this._service_url,w=this.preprocessBody(this.rawBody,m,v),S=s.createFormDataBody(w,v[0]),RequestUtils.temporarilyRemoveHeader(this.requestSettings,HTTPRequest.request.bind(this,this,S,p),!1);case 7:case"end":return A.stop()}},d,this)})),function l(d,p,m){return u.apply(this,arguments)})},{key:"extractResultData",value:function(){var u=_asyncToGenerator(_regeneratorRuntime().mark(function d(p){return _regeneratorRuntime().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(!p.error){v.next=2;break}throw p.error.message;case 2:return v.abrupt("return",{text:p.text});case 3:case"end":return v.stop()}},d)}));return function l(d){return u.apply(this,arguments)}}()}],[{key:"canSendFileMessage",value:function(l,d){return!(null==d||!d[0])}},{key:"cleanConfig",value:function(l){delete l.type}},{key:"createFormDataBody",value:function(l,d){var p=new FormData;return p.append("file",d),Object.keys(l).forEach(function(m){p.append(m,String(l[m]))}),p}}]),s}(DirectServiceIO);_OpenAIAudioIO.AUDIO_TRANSCRIPTIONS_URL="https://api.openai.com/v1/audio/transcriptions",_OpenAIAudioIO.AUDIO_TRANSLATIONS_URL="https://api.openai.com/v1/audio/translations",_OpenAIAudioIO.DEFAULT_MODEL="whisper-1";var OpenAIAudioIO=_OpenAIAudioIO,OpenAIChatIO=function(a){_inherits(s,a);var u,h=_createSuper(s);function s(u){var l,d;_classCallCheck(this,s);var p,m,v=JSON.parse(JSON.stringify(u.directConnection)),b=v.openAI;(d=h.call(this,u,OpenAIUtils.buildKeyVerificationDetails(),OpenAIUtils.buildHeaders,b)).insertKeyPlaceholderText="OpenAI API Key",d.getKeyLink="https://platform.openai.com/account/api-keys",d.url="https://api.openai.com/v1/chat/completions",d.permittedErrorPrefixes=["Incorrect"],d._systemMessage=s.generateSystemMessage("You are a helpful assistant.");var w=null==(p=v.openAI)?void 0:p.chat;return"object"==_typeof(w)&&(w.system_prompt&&(d._systemMessage=s.generateSystemMessage(w.system_prompt)),d.cleanConfig(w),Object.assign(d.rawBody,w)),void 0===d.maxMessages&&(d.maxMessages=-1),null!==(l=(m=d.rawBody).model)&&void 0!==l||(m.model=OpenAIConverseBaseBody.GPT_CHAT_TURBO_MODEL),d}return _createClass(s,[{key:"cleanConfig",value:function(l){delete l.system_prompt}},{key:"preprocessBody",value:function(l,d){var p=JSON.parse(JSON.stringify(l)),v=MessageLimitUtils.getCharacterLimitMessages(d,(this.totalMessagesMaxCharLength||OpenAIUtils.CONVERSE_MAX_CHAR_LENGTH)-this._systemMessage.content.length).map(function(b){return{content:b.text,role:"ai"===b.role?"assistant":"user"}});return p.messages=[this._systemMessage].concat(_toConsumableArray(v)),p}},{key:"callServiceAPI",value:(u=_asyncToGenerator(_regeneratorRuntime().mark(function d(p,m){var v;return _regeneratorRuntime().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:if(this.requestSettings){w.next=2;break}throw new Error("Request settings have not been set up");case 2:v=this.preprocessBody(this.rawBody,m),this.deepChat.stream||v.stream?(v.stream=!0,Stream.request(this,v,p)):HTTPRequest.request(this,v,p);case 4:case"end":return w.stop()}},d,this)})),function l(d,p){return u.apply(this,arguments)})},{key:"extractResultData",value:function(){var u=_asyncToGenerator(_regeneratorRuntime().mark(function d(p){return _regeneratorRuntime().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(!p.error){v.next=2;break}throw p.error.message;case 2:return v.abrupt("return",p.choices[0].delta?{text:p.choices[0].delta.content||""}:p.choices[0].message?{text:p.choices[0].message.content}:{text:""});case 3:case"end":return v.stop()}},d)}));return function l(d){return u.apply(this,arguments)}}()}],[{key:"generateSystemMessage",value:function(l){return{role:"system",content:l}}}]),s}(DirectServiceIO),CohereChatIO=function(a){_inherits(s,a);var u,h=_createSuper(s);function s(u){var l;_classCallCheck(this,s);var d,p=JSON.parse(JSON.stringify(u.directConnection)),m=null==(d=p.cohere)?void 0:d.chat;return(l=h.call(this,u,"https://api.cohere.ai/v1/chat","Ask me anything!",m,p.cohere)).username="USER","object"==_typeof(m)&&(m.user_name&&(l.username=m.user_name),l.cleanConfig(m),Object.assign(l.rawBody,m)),void 0===l.maxMessages&&(l.maxMessages=-1),l}return _createClass(s,[{key:"cleanConfig",value:function(l){delete l.user_name}},{key:"preprocessBody",value:function(l,d){var p=this,m=JSON.parse(JSON.stringify(l));return m.query=d[d.length-1].text,m.chat_history=d.slice(0,d.length-1).map(function(v){return{text:v.text,user_name:"ai"===v.role?"CHATBOT":p.username}}),m}},{key:"callServiceAPI",value:(u=_asyncToGenerator(_regeneratorRuntime().mark(function d(p,m){var v;return _regeneratorRuntime().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:if(this.requestSettings){w.next=2;break}throw new Error("Request settings have not been set up");case 2:v=this.preprocessBody(this.rawBody,m),HTTPRequest.request(this,v,p);case 4:case"end":return w.stop()}},d,this)})),function l(d,p){return u.apply(this,arguments)})},{key:"extractResultData",value:function(){var u=_asyncToGenerator(_regeneratorRuntime().mark(function d(p){return _regeneratorRuntime().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(!p.message){v.next=2;break}throw p.message;case 2:return v.abrupt("return",{text:p.text});case 3:case"end":return v.stop()}},d)}));return function l(d){return u.apply(this,arguments)}}()}]),s}(CohereIO),ServiceIOFactory=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"create",value:function(s){var u=s.directConnection,l=s.request,d=s.demo;if(u){if(u.openAI)return u.openAI.images?new OpenAIImagesIO(s):u.openAI.audio?new OpenAIAudioIO(s):u.openAI.completions?new OpenAICompletionsIO(s):new OpenAIChatIO(s);if(u.assemblyAI)return new AssemblyAIAudioIO(s);if(u.cohere)return u.cohere.chat?new CohereChatIO(s):u.cohere.summarization?new CohereSummarizationIO(s):new CohereTextGenerationIO(s);if(u.huggingFace)return u.huggingFace.textGeneration?new HuggingFaceTextGenerationIO(s):u.huggingFace.summarization?new HuggingFaceSummarizationIO(s):u.huggingFace.translation?new HuggingFaceTranslationIO(s):u.huggingFace.fillMask?new HuggingFaceFillMaskIO(s):u.huggingFace.questionAnswer?new HuggingFaceQuestionAnswerIO(s):u.huggingFace.audioSpeechRecognition?new HuggingFaceAudioRecognitionIO(s):u.huggingFace.audioClassification?new HuggingFaceAudioClassificationIO(s):u.huggingFace.imageClassification?new HuggingFaceImageClassificationIO(s):new HuggingFaceConversationIO(s);if(u.azure){if(u.azure.speechToText)return new AzureSpeechToTextIO(s);if(u.azure.textToSpeech)return new AzureTextToSpeechIO(s);if(u.azure.summarization)return new AzureSummarizationIO(s);if(u.azure.translation)return new AzureTranslationIO(s)}if(u.stabilityAI)return u.stabilityAI.imageToImage?new StabilityAIImageToImageIO(s):u.stabilityAI.imageToImageUpscale?new StabilityAIImageToImageUpscaleIO(s):u.stabilityAI.imageToImageMasking?new StabilityAIImageToImageMaskingIO(s):new StabilityAITextToImageIO(s)}return l?new BaseServiceIO(s):new BaseServiceIO(s,void 0,d||!0)}}]),a}(),_GoogleFont=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"appendStyleSheetToHead",value:function(){var s=document.getElementsByTagName("head")[0];if(!Array.from(s.getElementsByTagName("link")).some(function(l){return l.getAttribute("href")===a.FONT_URL})){var u=document.createElement("link");u.rel="stylesheet",u.href=a.FONT_URL,s.appendChild(u)}}}]),a}();_GoogleFont.FONT_URL="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap";var GoogleFont=_GoogleFont,TypeConverters=_createClass(function a(){_classCallCheck(this,a)});function Property(a){return function(h,s){Object.defineProperty(h,s,{});var u=h.constructor,l=s.toLocaleLowerCase();u._attributes_[l]=TypeConverters.attibutes[a],u._attributeToProperty_[l]=s}}TypeConverters.attibutes={string:function(h){return h},number:function(h){return parseFloat(h)},boolean:function(h){return"true"===h},object:function(h){return JSON.parse(h)},array:function(h){return JSON.parse(h)},function:function _function(value){return eval(value)}};var FireEvents=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"onNewMessage",value:function(s,u,l){var d=JSON.parse(JSON.stringify({message:u,isInitial:l}));s.onNewMessage(d),s.dispatchEvent(new CustomEvent("new-message",{detail:d}))}},{key:"onClearMessages",value:function(s){s.onClearMessages(),s.dispatchEvent(new CustomEvent("clear-messages"))}},{key:"onRender",value:function(s){s.onComponentRender(),s.dispatchEvent(new CustomEvent("render"))}}]),a}(),_ElementUtils=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"addElements",value:function(s){for(var u=arguments.length,l=new Array(u>1?u-1:0),d=1;d<u;d++)l[d-1]=arguments[d];l.forEach(function(p){return s.appendChild(p)})}},{key:"isScrollbarAtBottomOfElement",value:function(s){return s.scrollTop>=s.scrollHeight-s.clientHeight-a.CODE_SNIPPET_GENERATION_JUMP}},{key:"cloneElement",value:function(s){var u=s.cloneNode(!0);return s.parentNode.replaceChild(u,s),u}}]),a}();_ElementUtils.CODE_SNIPPET_GENERATION_JUMP=.5;var ElementUtils=_ElementUtils,_TextToSpeech=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"speak",value:function(s,u){if(window.SpeechSynthesisUtterance){var l=new SpeechSynthesisUtterance(s);Object.assign(l,u),speechSynthesis.speak(l)}}},{key:"processConfig",value:function(s,u){var l={};setTimeout(function(){if("object"==_typeof(s)&&(s.lang&&(l.lang=s.lang),s.pitch&&(l.pitch=s.pitch),s.rate&&(l.rate=s.rate),s.volume&&(l.volume=s.volume),s.voiceName)){var d=window.speechSynthesis.getVoices().find(function(p){var m;return p.name.toLocaleLowerCase()===(null==(m=s.voiceName)?void 0:m.toLocaleLowerCase())});d&&(l.voice=d)}u(l)},a.LOAD_VOICES_MS)}}]),a}();_TextToSpeech.LOAD_VOICES_MS=200;var TextToSpeech=_TextToSpeech,LoadingMessageDotsStyle=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"colorToHex",value:function(s){var u=document.createElement("div");return u.style.color=s,document.body.appendChild(u),"#".concat(window.getComputedStyle(u).color.match(/\d+/g).map(function(l){return parseInt(l).toString(16).padStart(2,"0")}).join(""))}},{key:"set",value:function(s,u){var l,d,p,m;if(null!=(d=null==(l=u?.loading)?void 0:l.bubble)&&d.color){var v=a.colorToHex(null==(m=null==(p=u?.loading)?void 0:p.bubble)?void 0:m.color);s.style.setProperty("--message-dots-color",v),s.style.setProperty("--message-dots-color-fade","".concat(v,"33"))}else s.style.setProperty("--message-dots-color","#848484"),s.style.setProperty("--message-dots-color-fade","#55555533")}}]),a}(),MessageStyleUtils=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"applyCustomStylesToElements",value:function(s,u,l){if(l&&(Object.assign(s.outerContainer.style,l.outerContainer),Object.assign(s.innerContainer.style,l.innerContainer),Object.assign(s.bubbleElement.style,l.bubble),u)){var d=s.bubbleElement.children[0],p="a"!==d.tagName.toLocaleLowerCase()?d:d.children[0];Object.assign(p.style,l.media)}}},{key:"applySideStyles",value:function(s,u,l,d){d&&(a.applyCustomStylesToElements(s,l,d.shared),a.applyCustomStylesToElements(s,l,u?d.ai:d.user))}},{key:"isMessageSideStyles",value:function(s){return!!(s.ai||s.shared||s.user)}},{key:"applyCustomStyles",value:function(s,u,l,d,p){var m;p&&s.default!==p?a.isMessageSideStyles(p)?(a.applySideStyles(u,l,d,s.default),a.applySideStyles(u,l,d,p)):(a.applyCustomStylesToElements(u,d,null==(m=s.default)?void 0:m.shared),a.applyCustomStylesToElements(u,d,p)):a.applySideStyles(u,l,d,s.default)}},{key:"extractParticularSharedStyles",value:function(s,u){if(null!=u&&u.shared){var l=u.shared,d={outerContainer:{},innerContainer:{},bubble:{},media:{}};return s.forEach(function(p){var m,v,b,w;d.outerContainer[p]=(null==(m=l.outerContainer)?void 0:m[p])||"",d.innerContainer[p]=(null==(v=l.innerContainer)?void 0:v[p])||"",d.bubble[p]=(null==(b=l.bubble)?void 0:b[p])||"",d.media[p]=(null==(w=l.media)?void 0:w[p])||""}),d}}}]),a}(),IntroPanel=function(){function a(h,s,u){_classCallCheck(this,a),this._isDisplayed=!1,h?(this._elementRef=this.createIntroPanelWithChild(h,u),this._isDisplayed=!0):s&&(this._elementRef=this.createInternalIntroPanel(s,u),this._isDisplayed=!0)}return _createClass(a,[{key:"createIntroPanelWithChild",value:function(s,u){var l=a.createIntroPanel(u);return"none"===s.style.display&&(s.style.display="block"),l.appendChild(s),l}},{key:"createInternalIntroPanel",value:function(s,u){var l=a.createIntroPanel(u);return l.id="internal-intro-panel",l.innerHTML=s,l}},{key:"hide",value:function(){this._isDisplayed&&this._elementRef&&(this._elementRef.style.display="none",this._isDisplayed=!1)}},{key:"display",value:function(){!this._isDisplayed&&this._elementRef&&(this._elementRef.style.display="",this._isDisplayed=!0)}}],[{key:"createIntroPanel",value:function(s){var u=document.createElement("div");return u.classList.add("intro-panel"),Object.assign(u.style,s),u}}]),a}(),_FileMessageUtils=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"updateMessages",value:function(s,u,l,d,p){var v,m=arguments.length>5&&void 0!==arguments[5]&&arguments[5];s.applyCustomStyles(u,p,!0,null==(v=s.messageStyles)?void 0:v[d]),s.elementRef.scrollTop=s.elementRef.scrollHeight;var b=Messages.createMessageContent(p,void 0,l);s.messages.push(b),s.sendClientUpdate(b,m)}},{key:"wrapInLink",value:function(s,u){var l=document.createElement("a");return l.href=u,l.target="_blank",l.appendChild(s),l}},{key:"processContent",value:function(s,u){return!u||u.startsWith("data")?s:a.wrapInLink(s,u)}},{key:"waitToLoadThenScroll",value:function(s){setTimeout(function(){s.scrollTop=s.scrollHeight},60)}},{key:"scrollDownOnImageLoad",value:function(s,u){if(s.startsWith("data"))a.waitToLoadThenScroll(u);else try{fetch(s,{mode:"no-cors"}).catch(function(){}).finally(function(){a.waitToLoadThenScroll(u)})}catch{u.scrollTop=u.scrollHeight}}}]),a}();_FileMessageUtils.DEFAULT_FILE_NAME="file";var FileMessageUtils=_FileMessageUtils,SetupMessages=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"getText",value:function(s,u){if(!s.directConnection&&!s.request&&!s.demo)return"Connect to any API using the [request](https://deepchat.dev/docs/connect#Request)\n        property or choose any one of the preconfigured APIs via\n        the [directConnection](https://deepchat.dev/docs/directConnection/#directConnection) property.\n        \n To get started checkout the [Start](https://deepchat.dev/start) page and\n        live code [examples](https://deepchat.dev/examples/frameworks).\n        \n To remove this message set the [demo](https://deepchat.dev/docs/demo#demo) property to true.";if(s.directConnection){if(!u.isDirectConnection())return"Please define a valid service inside\n          the [directConnection](https://deepchat.dev/docs/directConnection/#directConnection) object."}else if(s.request&&!s.request.url&&!s.request.handler)return"Please define a `url` or a `handler` property inside the [request](https://deepchat.dev/docs/connect#Request) object.";return null}}]),a}(),FILE_ICON_STRING='<?xml version="1.0" encoding="iso-8859-1"?>\n<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" \n\t viewBox="50 30 420 450" xml:space="preserve">\n<g filter="brightness(0) saturate(100%) invert(16%) sepia(0%) saturate(1942%) hue-rotate(215deg) brightness(99%) contrast(93%)">\n\t<g>\n\t\t<path d="M447.933,103.629c-0.034-3.076-1.224-6.09-3.485-8.352L352.683,3.511c-0.004-0.004-0.007-0.005-0.011-0.008\n\t\t\tC350.505,1.338,347.511,0,344.206,0H89.278C75.361,0,64.04,11.32,64.04,25.237v461.525c0,13.916,11.32,25.237,25.237,25.237\n\t\t\th333.444c13.916,0,25.237-11.32,25.237-25.237V103.753C447.96,103.709,447.937,103.672,447.933,103.629z M356.194,40.931\n\t\t\tl50.834,50.834h-49.572c-0.695,0-1.262-0.567-1.262-1.262V40.931z M423.983,486.763c0,0.695-0.566,1.261-1.261,1.261H89.278\n\t\t\tc-0.695,0-1.261-0.566-1.261-1.261V25.237c0-0.695,0.566-1.261,1.261-1.261h242.94v66.527c0,13.916,11.322,25.239,25.239,25.239\n\t\t\th66.527V486.763z"/>\n\t</g>\n</g>\n<g>\n\t<g>\n\t\t<path d="M362.088,164.014H149.912c-6.62,0-11.988,5.367-11.988,11.988c0,6.62,5.368,11.988,11.988,11.988h212.175\n\t\t\tc6.62,0,11.988-5.368,11.988-11.988C374.076,169.381,368.707,164.014,362.088,164.014z"/>\n\t</g>\n</g>\n<g>\n\t<g>\n\t\t<path d="M362.088,236.353H149.912c-6.62,0-11.988,5.368-11.988,11.988c0,6.62,5.368,11.988,11.988,11.988h212.175\n\t\t\tc6.62,0,11.988-5.368,11.988-11.988C374.076,241.721,368.707,236.353,362.088,236.353z"/>\n\t</g>\n</g>\n<g>\n\t<g>\n\t\t<path d="M362.088,308.691H149.912c-6.62,0-11.988,5.368-11.988,11.988c0,6.621,5.368,11.988,11.988,11.988h212.175\n\t\t\tc6.62,0,11.988-5.367,11.988-11.988C374.076,314.06,368.707,308.691,362.088,308.691z"/>\n\t</g>\n</g>\n<g>\n\t<g>\n\t\t<path d="M256,381.031H149.912c-6.62,0-11.988,5.368-11.988,11.988c0,6.621,5.368,11.988,11.988,11.988H256\n\t\t\tc6.62,0,11.988-5.367,11.988-11.988C267.988,386.398,262.62,381.031,256,381.031z"/>\n\t</g>\n</g>\n</svg>',FileMessages=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"createImage",value:function(s,u){var l=new Image;return l.src=s.src,FileMessageUtils.scrollDownOnImageLoad(l.src,u),FileMessageUtils.processContent(l,l.src)}},{key:"addNewImageMessage",value:(h=_asyncToGenerator(_regeneratorRuntime().mark(function u(l,d,p){var m,v,b,w=arguments;return _regeneratorRuntime().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:m=w.length>3&&void 0!==w[3]&&w[3],v=a.createImage(d,l.elementRef),(b=l.createNewMessageElement("",p)).bubbleElement.appendChild(v),b.bubbleElement.classList.add("image-message"),l.elementRef.appendChild(b.outerContainer),FileMessageUtils.updateMessages(l,b,d,"image",p,m);case 3:case"end":return M.stop()}},u)})),function s(u,l,d){return h.apply(this,arguments)})},{key:"createAudioElement",value:function(s,u){var l=document.createElement("audio");return l.src=s.src,l.classList.add("audio-player"),l.controls=!0,Browser$1.IS_SAFARI&&(l.classList.add("audio-player-safari"),l.classList.add(u?"audio-player-safari-left":"audio-player-safari-right")),l}},{key:"addNewAudioMessage",value:function(s,u,l){var d=arguments.length>3&&void 0!==arguments[3]&&arguments[3],p=a.createAudioElement(u,l),m=s.createNewMessageElement("",l);m.bubbleElement.appendChild(p),m.bubbleElement.classList.add("audio-message"),s.elementRef.appendChild(m.outerContainer),FileMessageUtils.updateMessages(s,m,u,"audio",l,d)}},{key:"createAnyFile",value:function(s){var u=document.createElement("div");u.classList.add("any-file-message-contents");var l=document.createElement("div");l.classList.add("any-file-message-icon-container");var d=SVGIconUtils.createSVGElement(FILE_ICON_STRING);d.classList.add("any-file-message-icon"),l.appendChild(d);var p=document.createElement("div");return p.classList.add("any-file-message-text"),p.textContent=s.name||FileMessageUtils.DEFAULT_FILE_NAME,u.appendChild(l),u.appendChild(p),FileMessageUtils.processContent(u,s.src)}},{key:"addNewAnyFileMessage",value:function(s,u,l){var d=arguments.length>3&&void 0!==arguments[3]&&arguments[3],p=s.createNewMessageElement("",l),m=a.createAnyFile(u);p.bubbleElement.classList.add("any-file-message-bubble"),p.bubbleElement.appendChild(m),s.elementRef.appendChild(p.outerContainer),FileMessageUtils.updateMessages(s,p,u,"file",l,d)}}]),a;var h}(),aiLogoUrl="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI/Pgo8c3ZnIGZpbGw9IiMwMDAwMDAiIHZlcnNpb249IjEuMSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIAoJCXZpZXdCb3g9IjAgMCAzMiAzMiIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+Cgk8cGF0aCBkPSJNMjMsMzAuMzZIOWMtMi40MDQsMC00LjM2LTEuOTU2LTQuMzYtNC4zNlYxNWMwLTIuNDA0LDEuOTU2LTQuMzYsNC4zNi00LjM2aDMuNjU5CgkJYzAuMTY3LTEuNTY2LDEuNDE1LTIuODEzLDIuOTgxLTIuOTgxVjUuMzMzYy0xLjEzMS0wLjE3NC0yLTEuMTU0LTItMi4zMzNjMC0xLjMwMSwxLjA1OS0yLjM2LDIuMzYtMi4zNgoJCWMxLjMwMiwwLDIuMzYsMS4wNTksMi4zNiwyLjM2YzAsMS4xNzktMC44NjksMi4xNTktMiwyLjMzM1Y3LjY2YzEuNTY2LDAuMTY3LDIuODE0LDEuNDE1LDIuOTgxLDIuOTgxSDIzCgkJYzIuNDA0LDAsNC4zNiwxLjk1Niw0LjM2LDQuMzZ2MTFDMjcuMzYsMjguNDA0LDI1LjQwNCwzMC4zNiwyMywzMC4zNnogTTksMTEuMzZjLTIuMDA3LDAtMy42NCwxLjYzMy0zLjY0LDMuNjR2MTEKCQljMCwyLjAwNywxLjYzMywzLjY0LDMuNjQsMy42NGgxNGMyLjAwNywwLDMuNjQtMS42MzMsMy42NC0zLjY0VjE1YzAtMi4wMDctMS42MzMtMy42NC0zLjY0LTMuNjRIOXogTTEzLjM4NCwxMC42NGg1LjIzMQoJCUMxOC40MzksOS4zNTQsMTcuMzM0LDguMzYsMTYsOC4zNkMxNC42NjcsOC4zNiwxMy41NjEsOS4zNTQsMTMuMzg0LDEwLjY0eiBNMTYsMS4zNmMtMC45MDQsMC0xLjY0LDAuNzM2LTEuNjQsMS42NAoJCVMxNS4wOTYsNC42NCwxNiw0LjY0YzAuOTA0LDAsMS42NC0wLjczNiwxLjY0LTEuNjRTMTYuOTA0LDEuMzYsMTYsMS4zNnogTTIwLDI3LjM2aC04Yy0xLjMwMSwwLTIuMzYtMS4wNTktMi4zNi0yLjM2CgkJczEuMDU5LTIuMzYsMi4zNi0yLjM2aDhjMS4zMDIsMCwyLjM2LDEuMDU5LDIuMzYsMi4zNlMyMS4zMDIsMjcuMzYsMjAsMjcuMzZ6IE0xMiwyMy4zNmMtMC45MDQsMC0xLjY0LDAuNzM1LTEuNjQsMS42NAoJCXMwLjczNiwxLjY0LDEuNjQsMS42NGg4YzAuOTA0LDAsMS42NC0wLjczNSwxLjY0LTEuNjRzLTAuNzM1LTEuNjQtMS42NC0xLjY0SDEyeiBNMzEsMjMuODZoLTJjLTAuMTk5LDAtMC4zNi0wLjE2MS0wLjM2LTAuMzZWMTUKCQljMC0wLjE5OSwwLjE2MS0wLjM2LDAuMzYtMC4zNmgyYzAuMTk5LDAsMC4zNiwwLjE2MSwwLjM2LDAuMzZ2OC41QzMxLjM2LDIzLjY5OSwzMS4xOTksMjMuODYsMzEsMjMuODZ6IE0yOS4zNiwyMy4xNGgxLjI3OXYtNy43OAoJCUgyOS4zNlYyMy4xNHogTTMsMjMuODZIMWMtMC4xOTksMC0wLjM2LTAuMTYxLTAuMzYtMC4zNlYxNWMwLTAuMTk5LDAuMTYxLTAuMzYsMC4zNi0wLjM2aDJjMC4xOTksMCwwLjM2LDAuMTYxLDAuMzYsMC4zNnY4LjUKCQlDMy4zNiwyMy42OTksMy4xOTksMjMuODYsMywyMy44NnogTTEuMzYsMjMuMTRoMS4yOHYtNy43OEgxLjM2VjIzLjE0eiBNMjAsMjAuMzZjLTEuMzAyLDAtMi4zNi0xLjA1OS0yLjM2LTIuMzYKCQlzMS4wNTktMi4zNiwyLjM2LTIuMzZzMi4zNiwxLjA1OSwyLjM2LDIuMzZDMjIuMzYsMTkuMzAyLDIxLjMwMiwyMC4zNiwyMCwyMC4zNnogTTIwLDE2LjM2Yy0wLjkwNCwwLTEuNjQsMC43MzYtMS42NCwxLjY0CgkJczAuNzM1LDEuNjQsMS42NCwxLjY0czEuNjQtMC43MzUsMS42NC0xLjY0UzIwLjkwNCwxNi4zNiwyMCwxNi4zNnogTTEyLDIwLjM2Yy0xLjMwMSwwLTIuMzYtMS4wNTktMi4zNi0yLjM2czEuMDU5LTIuMzYsMi4zNi0yLjM2CgkJczIuMzYsMS4wNTksMi4zNiwyLjM2QzE0LjM2LDE5LjMwMiwxMy4zMDEsMjAuMzYsMTIsMjAuMzZ6IE0xMiwxNi4zNmMtMC45MDQsMC0xLjY0LDAuNzM2LTEuNjQsMS42NHMwLjczNiwxLjY0LDEuNjQsMS42NAoJCXMxLjY0LTAuNzM1LDEuNjQtMS42NFMxMi45MDQsMTYuMzYsMTIsMTYuMzZ6Ii8+Cgk8cmVjdCBzdHlsZT0iZmlsbDpub25lOyIgd2lkdGg9IjMyIiBoZWlnaHQ9IjMyIi8+Cjwvc3ZnPg==",avatarUrl="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAPoAAAD6CAMAAAC/MqoPAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAADNQTFRF////9vX18vLy/Pz86enp4+Li2tnZ1tbWzczM+fn57Ozs4N/f09LS0M/P5uXl7+/v3dzcwtncCAAAAAFiS0dEAIgFHUgAAAAJcEhZcwAAAEgAAABIAEbJaz4AAAZNSURBVHja7d3bdtsqEABQYABZSLH9/3+ZpnUsIcF5iOM6PfElNoMHMfPQdq3GmL0GkLhEUqLaUExnOtOZznSmM53pTGc605nOdKYznelMZzrTmV4LXSqllKyJDkob26xWq8Zae/iH0QoWTm9d1xur4WuypQJtTd+5dqn0VjcxzNO5/57mEBvdLo8Oron6aseWOjYOFkVvjQs3DmgyONMuht52EfztP+4hdu0i6LCO808/M8c1lE/fuPGej41uUzgdtoO/75N+2ELJ9I3b3//hPXbiMenm3pR/Jt4USgcLBIp4Bh10gqKVhvLo0klCxeSky96nKcj3siw6pJIL4XsoiQ7apyvMY/V3HHrSRioLopvEhSpTCn2TPEuwKYMOIX0tAxRBf/Hpa+lfSqBv9gi1FPsNfTrMAiVmIE/vJhz61FGnQxRIEYE4vfNYdN8Rp6MlHaHotHTn8ejekaZPAjEmyvQWdZFTtYTpXqCGJ0zvcek9Yfoel76nS0ffv1NMp1ca+pkgyfRCGind4L7OWWc605l+cxjsyhqy9AGbPpClc1/nvl5VX0c/3Alk6RU3+Am7shNZ+h6bvidLr7jBB+zKBrL0irOOudmIUDzTmf5gIP+iEuXtRuTVaEmY/oZLfyNMrzjryPc0gerMTdpVg0tvjJUU6bLPcGOoUv46SLL6Wi8yhLf06C7TUyekI0efRaaYqdFltkeNpPumRPSMDxgBYvSM035FrKAmH72hRW99PrpvSdEHkTEGUvSsK3yKVDkuJ92RohcZaehzzirPpOg+J92Tolfc4Cumx5xVXpGiZ34+ICX6W84qv5GiR5NPbiIpOv6BCoSvSkTX+eiaGP092zINvBOj4x8mSf9FqejvNo/cvpOji19ZbmviL0GPLsYMFzgzCor0+Bv/ePDvSJKOb9dJ5UlnbnEHiHgzv6cdTpJOWuc/u3FEucLDOL75xGtBiefrcwgoC9NDSH/jkH6pAuXmBqPQ9HSUPVdZBH1GGOrMXAQdYxcKZfxAoK+KKBKFLosoEoX+u4giUehz8jlcnAuhp78I46yDYNAd+QLR6K+pr+yvxdBTHyVDubQh0UfSxaHSd0lbvNkVRE87JGOtc+PQd2QLQ6fHhJkKsSh6yg13tO08JPprsgrrXWH0dJd2vH1MLPprot4eXoujpzrdhngiD40ek2y92lggPcnWa8qN1Yz0BFuvZhRl0uOfR0v4Ewuli/Bg4Qr3lArqGdndQ3UPO1EunXYwnelMZzrTmc50pjOd6UxnOtOZznSmM53pTGf6kuj6oedFKV0s3fX6sX1S3bsi6a4PD7+/YAqYeBw6pIB/4qEgOqxdSPbGiim4NRRCbzs3Jj0L4UfXtQXQVRfn5IdA/Bw7RZzurEV6EtdsLeGXkIPuA+K1UoVeA0l62zmN/LqfSSft9KkepmoRuvi3nd5uKNFB9zbbXEANqdr941XO0NJx2v2jdJenpf+/3bvn0ts16ph+sd6hX7dPo2+2cZzE02Ia43bzDHqr+2Evnhz74ZHU30ffbKOeng1/NPV30Ns1gYQnSP2P6e65Pfxc6h02XZqXQCjhJ6kPL6bFo4NrGvAU4UII4SE2P1vQuZkuOxckVfehisF1MjUddN/MZBN+kvq5uf0O/xa66gyNS9ktMWlz44rO1Z8C19i5FPdHzPamXn+F3hryPfxMr78+4F+kq22kO6Rf6fUQt+puuustyWv4rbG3l/duztFB96GYoe1cTBdXMr+nw9qVM6ZfxOvzezff0nXi/ZOndvrR6Zvpm0c3h6nhdb+5iS7tsIim/qXZD9+97/Jf+rpZ5BET1ayv0GUzLhEuhBBjIy/RdVPgndutIRt9nt7p5cKFEEJ3Z+jQFDZL+XnMDXxHB73gxn5s9Kc3d3/pFciFkN/QTSXHJpX5l66gDrkQoP6hL3xsPw39la4qOiV8tH78XeSbue6N9mvWa6J/ybpc1CT1Wnh5Qq9meP8IOKH3ddH7E/ri1iYux/SXDrXR4UiPdck/wUpU+FtPf6/orja6O9KL3l56LOvVxe5Ib2qjN0d6Vbex4ghWlU3bPqI90If66MNng680FNpbJijH6kCvaF3uMzQ3+IrpFerV4Y9dffQdN3im10ivbuImhD3Qq5u4HdZkua8znelMZ/pS4z9CPVKkxowNxgAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxNy0wMy0yN1QxNTo0NToxNSswMDowMN1xSg4AAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTctMDMtMjdUMTU6NDU6MTUrMDA6MDCsLPKyAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAABJRU5ErkJggg==",AvatarEl=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"applyCustomStylesToElements",value:function(s,u,l){Object.assign(s.style,l.container),Object.assign(u.style,l.avatar)}},{key:"applyCustomStyles",value:function(s,u,l,d){var p,m,v;null!=(p=l.default)&&p.styles&&a.applyCustomStylesToElements(s,u,l.default.styles),d?null!=(m=l.ai)&&m.styles&&a.applyCustomStylesToElements(s,u,l.ai.styles):null!=(v=l.user)&&v.styles&&a.applyCustomStylesToElements(s,u,l.user.styles)}},{key:"createAvatar",value:function(s,u){var l,d,p,m,v=document.createElement("img");v.src=s?(null==(l=u?.ai)?void 0:l.src)||(null==(d=u?.default)?void 0:d.src)||aiLogoUrl:(null==(p=u?.user)?void 0:p.src)||(null==(m=u?.default)?void 0:m.src)||avatarUrl,v.classList.add("avatar");var b=document.createElement("div");return b.classList.add("avatar-container"),b.appendChild(v),u&&a.applyCustomStyles(b,v,u,s),b}},{key:"getPosition",value:function(s,u){var l,d,p,m,v,b,w,S,M=s?null==(m=null==(p=u?.ai)?void 0:p.styles)?void 0:m.position:null==(b=null==(v=u?.user)?void 0:v.styles)?void 0:b.position;return null!==(l=M)&&void 0!==l||(M=null==(S=null==(w=u?.default)?void 0:w.styles)?void 0:S.position),null!==(d=M)&&void 0!==d||(M=s?"left":"right"),M}},{key:"add",value:function(s,u,l){var d="boolean"==typeof l?void 0:l,p=a.createAvatar(u,d),m=a.getPosition(u,d);p.classList.add("left"===m?"left-item-position":"right-item-position"),s.insertAdjacentElement("left"===m?"beforebegin":"afterend",p)}}]),a}(),Name=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"getPosition",value:function(s,u){var l,d,p,m=s?null==(l=u?.ai)?void 0:l.position:null==(d=u?.user)?void 0:d.position;return m||(m=null==(p=u?.default)?void 0:p.position),m||(m=s?"left":"right"),m}},{key:"applyStyle",value:function(s,u,l){var d,p,m;Object.assign(s.style,null==(d=l.default)?void 0:d.style,u?null==(p=l.ai)?void 0:p.style:null==(m=l.user)?void 0:m.style)}},{key:"getNameText",value:function(s,u){var l,d,p,m;return s?(null==(l=u.ai)?void 0:l.text)||(null==(d=u.default)?void 0:d.text)||"AI":(null==(p=u.user)?void 0:p.text)||(null==(m=u.default)?void 0:m.text)||"User"}},{key:"createName",value:function(s,u){var l=document.createElement("div");return l.classList.add("name"),l.textContent=a.getNameText(s,u),a.applyStyle(l,s,u),l}},{key:"add",value:function(s,u,l){var d="boolean"==typeof l?{}:l,p=a.createName(u,d),m=a.getPosition(u,d);p.classList.add("left"===m?"left-item-position":"right-item-position"),s.insertAdjacentElement("left"===m?"beforebegin":"afterend",p)}}]),a}(),Messages=function(){function a(h,s,u){var d,p,l=this;_classCallCheck(this,a),this._messageElementRefs=[],this._streamedText="",this.messages=[];var m=s.permittedErrorPrefixes,v=s.introPanelMarkUp,b=s.demo;this._remarkable=RemarkableConfig.createNew(),this.elementRef=a.createContainerElement(),this.messageStyles=h.messageStyles,this._avatars=h.avatars,this._names=h.names,this._errorMessageOverrides=null==(d=h.errorMessages)?void 0:d.overrides,this._onNewMessage=FireEvents.onNewMessage.bind(this,h),this._onClearMessages=FireEvents.onClearMessages.bind(this,h),this._displayLoadingMessage=a.getDisplayLoadingMessage(h,s),this._permittedErrorPrefixes=m,this.addSetupMessageIfNeeded(h,s),this.populateIntroPanel(u,v,h.introPanelStyle),h.introMessage&&this.addIntroductoryMessage(h.introMessage),h.initialMessages&&this.populateInitialMessages(h.initialMessages),this.displayServiceErrorMessages=null==(p=h.errorMessages)?void 0:p.displayServiceErrorMessages,h.getMessages=function(){return JSON.parse(JSON.stringify(l.messages))},h.clearMessages=this.clearMessages.bind(this),h.refreshMessages=this.refreshTextMessages.bind(this),b&&this.prepareDemo(b),h.textToSpeech&&TextToSpeech.processConfig(h.textToSpeech,function(w){l._textToSpeech=w})}return _createClass(a,[{key:"prepareDemo",value:function(s){"object"==_typeof(s)&&(s.response&&(this.customDemoResponse=s.response),s.displayErrors&&(s.displayErrors.default&&this.addNewErrorMessage("",""),s.displayErrors.service&&this.addNewErrorMessage("service",""),s.displayErrors.speechToText&&this.addNewErrorMessage("speechToText","")),s.displayLoadingBubble&&this.addLoadingMessage())}},{key:"addSetupMessageIfNeeded",value:function(s,u){var l=SetupMessages.getText(s,u);if(l){var d=this.createAndAppendNewMessageElement(l,!0);this.applyCustomStyles(d,!0,!1)}}},{key:"addIntroductoryMessage",value:function(s){var u;if(s&&(this._introMessage=s),this._introMessage){var l=this.createAndAppendNewMessageElement(this._introMessage,!0);this.applyCustomStyles(l,!0,!1,null==(u=this.messageStyles)?void 0:u.intro)}}},{key:"populateInitialMessages",value:function(s){var u=this;s.forEach(function(l){l.text?u.addNewMessage({text:l.text},"ai"===l.role,!0,!0):l.file&&u.addNewMessage({files:[l.file]},"ai"===l.role,!0,!0)}),setTimeout(function(){return u.elementRef.scrollTop=u.elementRef.scrollHeight})}},{key:"applyCustomStyles",value:function(s,u,l,d){this.messageStyles&&MessageStyleUtils.applyCustomStyles(this.messageStyles,s,u,l,d)}},{key:"addInnerContainerElements",value:function(s,u,l){return s.classList.add("message-bubble",l?"ai-message-text":"user-message-text"),s.innerHTML=this._remarkable.render(u),0===s.innerText.trim().length&&(s.innerText=u),this._avatars&&AvatarEl.add(s,l,this._avatars),this._names&&Name.add(s,l,this._names),{bubbleElement:s}}},{key:"createMessageElements",value:function(s,u){var l=a.createBaseElements(),m=l.bubbleElement;return l.outerContainer.appendChild(l.innerContainer),this.addInnerContainerElements(m,s,u),this._messageElementRefs.push(l),l}},{key:"createNewMessageElement",value:function(s,u){var l;null==(l=this._introPanel)||l.hide();var d=this._messageElementRefs[this._messageElementRefs.length-1];return null!=d&&d.bubbleElement.classList.contains("loading-message-text")&&(d.outerContainer.remove(),this._messageElementRefs.pop()),this.createMessageElements(s,u)}},{key:"createAndAppendNewMessageElement",value:function(s,u){var l=this.createNewMessageElement(s,u);return this.elementRef.appendChild(l.outerContainer),this.elementRef.scrollTop=this.elementRef.scrollHeight,l}},{key:"addNewTextMessage",value:function(s,u,l){var d=arguments.length>3&&void 0!==arguments[3]&&arguments[3],p=this.createAndAppendNewMessageElement(s,u);this.applyCustomStyles(p,u,!1);var m=a.createMessageContent(u,s);return 0===s.trim().length&&a.editEmptyMessageElement(p.bubbleElement),this.messages.push(m),l&&this.sendClientUpdate(m,d),p}},{key:"addNewMessage",value:function(s,u,l){var d=this,p=arguments.length>3&&void 0!==arguments[3]&&arguments[3];null!=s.text?(this.addNewTextMessage(s.text,u,l,p),!p&&this._textToSpeech&&u&&TextToSpeech.speak(s.text,this._textToSpeech)):s.files&&s.files.forEach(function(m){var v,b;"audio"===m.type||null!=(v=m.src)&&v.startsWith("data:audio")?FileMessages.addNewAudioMessage(d,m,u,p):"image"===m.type||"gif"===m.type||null!=(b=m.src)&&b.startsWith("data:image")?FileMessages.addNewImageMessage(d,m,u,p):FileMessages.addNewAnyFileMessage(d,m,u,p)})}},{key:"sendClientUpdate",value:function(s){var l,u=arguments.length>1&&void 0!==arguments[1]&&arguments[1];null==(l=this._onNewMessage)||l.call(this,JSON.parse(JSON.stringify(s)),u)}},{key:"removeMessageOnError",value:function(){var s=this._messageElementRefs[this._messageElementRefs.length-1],u=s?.bubbleElement;(null!=u&&u.classList.contains("streamed-message")&&""===u.textContent||null!=u&&u.classList.contains("loading-message-text"))&&(s.outerContainer.remove(),this._messageElementRefs.pop())}},{key:"addNewErrorMessage",value:function(s,u){var l,d,p,m;this.removeMessageOnError();var v=a.createBaseElements(),b=v.outerContainer,w=v.bubbleElement;w.classList.add("error-message-text");var S=this.getPermittedMessage(u)||(null==(l=this._errorMessageOverrides)?void 0:l[s])||(null==(d=this._errorMessageOverrides)?void 0:d.default)||"Error, please try again.";w.innerHTML=S;var M=MessageStyleUtils.extractParticularSharedStyles(["fontSize","fontFamily"],null==(p=this.messageStyles)?void 0:p.default);MessageStyleUtils.applyCustomStylesToElements(v,!1,M),MessageStyleUtils.applyCustomStylesToElements(v,!1,null==(m=this.messageStyles)?void 0:m.error),this.elementRef.appendChild(b),this.elementRef.scrollTop=this.elementRef.scrollHeight,this._textToSpeech&&TextToSpeech.speak(S,this._textToSpeech),this._streamedText=""}},{key:"getPermittedMessage",value:function(s){if(s){if(this.displayServiceErrorMessages)return s;if("string"==typeof s&&this._permittedErrorPrefixes){var u=a.checkPermittedErrorPrefixes(this._permittedErrorPrefixes,s);if(u)return u}else if(Array.isArray(s)&&this._permittedErrorPrefixes)for(var l=0;l<s.length;l+=1){var d=a.checkPermittedErrorPrefixes(this._permittedErrorPrefixes,s[l]);if(d)return d}}}},{key:"getLastMessageElement",value:function(){return this.elementRef.children[this.elementRef.children.length-1]}},{key:"getLastMessageBubbleElement",value:function(){var s,u;return Array.from((null==(u=null==(s=this.getLastMessageElement())?void 0:s.children)?void 0:u[0].children)||[]).find(function(l){return l.classList.contains("message-bubble")})}},{key:"isLastMessageError",value:function(){var s;return null==(s=this.getLastMessageBubbleElement())?void 0:s.classList.contains("error-message-text")}},{key:"removeError",value:function(){this.isLastMessageError()&&this.getLastMessageElement().remove()}},{key:"addLoadingMessage",value:function(){var s;if(this._displayLoadingMessage){var u=this.createMessageElements("",!0),l=u.outerContainer,d=u.bubbleElement;d.classList.add("loading-message-text");var p=document.createElement("div");p.classList.add("dots-flashing"),d.appendChild(p),this.applyCustomStyles(u,!0,!1,null==(s=this.messageStyles)?void 0:s.loading),LoadingMessageDotsStyle.set(d,this.messageStyles),this.elementRef.appendChild(l),this.elementRef.scrollTop=this.elementRef.scrollHeight}}},{key:"addNewStreamedMessage",value:function(){var u=this.addNewTextMessage("",!0,!1).bubbleElement;return u.classList.add("streamed-message"),this.elementRef.scrollTop=this.elementRef.scrollHeight,u}},{key:"updateStreamedMessage",value:function(s,u){var l,d,p,m,v,b=ElementUtils.isScrollbarAtBottomOfElement(this.elementRef);if(0!==s.trim().length){var w=null==(l=this.messageStyles)?void 0:l.default;u.style.color=(null==(p=null==(d=w?.ai)?void 0:d.bubble)?void 0:p.color)||(null==(v=null==(m=w?.shared)?void 0:m.bubble)?void 0:v.color)||""}this._streamedText+=s,u.innerHTML=this._remarkable.render(this._streamedText),b&&(this.elementRef.scrollTop=this.elementRef.scrollHeight)}},{key:"finaliseStreamedMessage",value:function(){var s;null!=(s=this.getLastMessageBubbleElement())&&s.classList.contains("streamed-message")&&(this.messages[this.messages.length-1].text=this._streamedText,this.sendClientUpdate(a.createMessageContent(!0,this._streamedText),!1),this._textToSpeech&&TextToSpeech.speak(this._streamedText,this._textToSpeech),this._streamedText="")}},{key:"populateIntroPanel",value:function(s,u,l){(s||u)&&(this._introPanel=new IntroPanel(s,u,l),this._introPanel._elementRef&&this.elementRef.appendChild(this._introPanel._elementRef))}},{key:"addMultipleFiles",value:(h=_asyncToGenerator(_regeneratorRuntime().mark(function u(l){var d=this;return _regeneratorRuntime().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.abrupt("return",Promise.all((l||[]).map(function(v){return new Promise(function(b){if(v.type&&"any"!==v.type){var S=new FileReader;S.readAsDataURL(v.file),S.onload=function(){d.addNewMessage({files:[{src:S.result,type:v.type}]},!1,!0),b(!0)}}else d.addNewMessage({files:[{name:v.file.name||FileMessageUtils.DEFAULT_FILE_NAME,type:"any"}]},!1,!0),b(!0)})})));case 1:case"end":return m.stop()}},u)})),function s(u){return h.apply(this,arguments)})},{key:"clearMessages",value:function(s){var u,l,d=[];this._messageElementRefs.forEach(function(p){var m=p.bubbleElement.classList;m.contains("loading-message-text")||m.contains("streamed-message")?d.push(p):p.outerContainer.remove()}),Array.from(this.elementRef.children).forEach(function(p){var m,v=null==(m=p.children[0])?void 0:m.children[0];null!=v&&v.classList.contains("error-message-text")&&p.remove()}),this._messageElementRefs=d,!1!==s&&(null!=(u=this._introPanel)&&u._elementRef&&this._introPanel.display(),this.addIntroductoryMessage()),this.messages.splice(0,this.messages.length),null==(l=this._onClearMessages)||l.call(this)}},{key:"refreshTextMessages",value:function(){var s=this;this._remarkable=RemarkableConfig.createNew(),this.messages.forEach(function(u,l){u.text&&(s._messageElementRefs[l].bubbleElement.innerHTML=s._remarkable.render(u.text))})}}],[{key:"getDisplayLoadingMessage",value:function(s,u){var l;return!u.websocket&&(null===(l=s.displayLoadingBubble)||void 0===l||l)}},{key:"createContainerElement",value:function(){var s=document.createElement("div");return s.id="messages",s}},{key:"createMessageContent",value:function(s,u,l){return l?{role:s?"ai":"user",file:l}:{role:s?"ai":"user",text:u||""}}},{key:"createBaseElements",value:function(){var s=document.createElement("div"),u=document.createElement("div");u.classList.add("inner-message-container"),s.appendChild(u),s.classList.add("outer-message-container");var l=document.createElement("div");return l.classList.add("message-bubble"),u.appendChild(l),{outerContainer:s,innerContainer:u,bubbleElement:l}}},{key:"editEmptyMessageElement",value:function(s){s.textContent=".",s.style.color="#00000000"}},{key:"checkPermittedErrorPrefixes",value:function(s,u){for(var l=0;l<s.length;l+=1)if(u.startsWith(s[l]))return u}}]),a;var h}(),_InputButtonStyleAdjustments=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"adjustInputPadding",value:function(s,u){u["inside-left"].length>0&&s.classList.add("text-input-inner-left-adjustment"),u["inside-right"].length>0&&s.classList.add("text-input-inner-right-adjustment")}},{key:"adjustForOutsideButton",value:function(s,u,l){0===l["outside-right"].length&&l["outside-left"].length>0?(s[0].classList.add(a.INPUT_OUTSIDE_LEFT_SMALL_ADJUSTMENT_CLASS),u.classList.add(a.INPUT_OUTSIDE_LEFT_SMALL_ADJUSTMENT_CLASS)):0===l["outside-left"].length&&l["outside-right"].length>0&&(s[3].classList.add(a.INPUT_OUTSIDE_RIGHT_SMALL_ADJUSTMENT_CLASS),u.classList.add(a.INPUT_OUTSIDE_RIGHT_SMALL_ADJUSTMENT_CLASS))}},{key:"adjustOutsideSubmit",value:function(s,u,l){if(!(l["inside-left"].length>0||l["inside-right"].length>0)){if(0===l["outside-right"].length&&l["outside-left"].length>0)return s[0].classList.add(a.INPUT_OUTSIDE_LEFT_ADJUSTMENT_CLASS),u.classList.add(a.INPUT_OUTSIDE_LEFT_ADJUSTMENT_CLASS),l["outside-left"].map(function(d){return d.button.elementRef.classList.add("submit-button-enlarged")});if(0===l["outside-left"].length&&l["outside-right"].length>0)return s[3].classList.add(a.INPUT_OUTSIDE_RIGHT_ADJUSTMENT_CLASS),u.classList.add(a.INPUT_OUTSIDE_RIGHT_ADJUSTMENT_CLASS),l["outside-right"].map(function(d){return d.button.elementRef.classList.add("submit-button-enlarged")})}}},{key:"set",value:function(s,u,l,d){a.adjustOutsideSubmit(u,l,d)||a.adjustForOutsideButton(u,l,d),a.adjustInputPadding(s,d)}}]),a}();_InputButtonStyleAdjustments.INPUT_OUTSIDE_LEFT_ADJUSTMENT_CLASS="text-input-container-left-adjustment",_InputButtonStyleAdjustments.INPUT_OUTSIDE_RIGHT_ADJUSTMENT_CLASS="text-input-container-right-adjustment",_InputButtonStyleAdjustments.INPUT_OUTSIDE_LEFT_SMALL_ADJUSTMENT_CLASS="text-input-container-left-small-adjustment",_InputButtonStyleAdjustments.INPUT_OUTSIDE_RIGHT_SMALL_ADJUSTMENT_CLASS="text-input-container-right-small-adjustment";var InputButtonStyleAdjustments=_InputButtonStyleAdjustments,ButtonContainers=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"create",value:function(){return Array.from({length:4}).map(function(s,u){var l=document.createElement("div");return l.classList.add("input-button-container"),(0===u||3===u)&&l.classList.add("outer-button-container"),(1===u||2===u)&&l.classList.add("inner-button-container"),l})}},{key:"add",value:function(s,u){s.insertBefore(u[1],s.firstChild),s.insertBefore(u[0],s.firstChild),s.appendChild(u[2]),s.appendChild(u[3])}},{key:"getContainerIndex",value:function(s){return"outside-left"===s?0:"inside-left"===s?1:"inside-right"===s?2:3}},{key:"addButton",value:function(s,u,l){u.classList.add(l);var d=a.getContainerIndex(l);s[d].appendChild(u),3===d&&u.classList.add("outside-right")}}]),a}(),BUTTON_ORDER=["camera","gifs","images","audio","mixedFiles","submit","microphone"],CustomButtonInnerElements=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"createTextElement",value:function(s){var u=document.createElement("div");return u.classList.add("text-button"),u.innerText=s,u}},{key:"createElement",value:function(s,u){return u?a.createTextElement(s):SVGIconUtils.createSVGElement(s)}},{key:"createCustomElement",value:function(s,u){var l,d,p,m,v=s[u];return null!=(l=v?.text)&&l.content?a.createElement(null==(d=v?.text)?void 0:d.content,!0):null!=(p=v?.svg)&&p.content?a.createElement(null==(m=v?.svg)?void 0:m.content,!1):void 0}},{key:"processElement",value:function(s,u){null!=u&&u.classList.contains("text-button")||s.classList.add("input-button-svg")}},{key:"createSpecificStateElement",value:function(s,u,l){var d;return l&&(d=a.createCustomElement(l,u)),a.processElement(s,d),d}},{key:"create",value:function(s,u,l){var d={};if(!l)return a.processElement(s),d;var p=a.createSpecificStateElement(s,u[0],l);d[u[0]]=p;var m=p;return u.slice(1).forEach(function(v){m=a.createCustomElement(l,v)||m,d[v]=m}),d}}]),a}(),PLUS_ICON_STRING='<?xml version="1.0" encoding="utf-8"?>\n<svg viewBox="0 0 32 32" version="1.1" xmlns="http://www.w3.org/2000/svg">\n    <path d="M16 0c-8.836 0-16 7.163-16 16s7.163 16 16 16c8.837 0 16-7.163 16-16s-7.163-16-16-16zM16 30.032c-7.72 0-14-6.312-14-14.032s6.28-14 14-14 14 6.28 14 14-6.28 14.032-14 14.032zM23 15h-6v-6c0-0.552-0.448-1-1-1s-1 0.448-1 1v6h-6c-0.552 0-1 0.448-1 1s0.448 1 1 1h6v6c0 0.552 0.448 1 1 1s1-0.448 1-1v-6h6c0.552 0 1-0.448 1-1s-0.448-1-1-1z"></path>\n</svg>',ButtonCSS=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"unsetAllCSS",value:function(s,u){var l,d;u.container&&StyleUtils.unsetAllCSSMouseStates(s,u.container),null!=(l=u.svg)&&l.styles&&StyleUtils.unsetAllCSSMouseStates(s.children[0],u.svg.styles),null!=(d=u.text)&&d.styles&&StyleUtils.unsetAllCSSMouseStates(s.children[0],u.text.styles)}},{key:"unsetActionCSS",value:function(s,u){var l,d;u.container&&StyleUtils.unsetActivityCSSMouseStates(s,u.container),null!=(l=u.svg)&&l.styles&&StyleUtils.unsetActivityCSSMouseStates(s.children[0],u.svg.styles),null!=(d=u.text)&&d.styles&&StyleUtils.unsetActivityCSSMouseStates(s.children[0],u.text.styles)}},{key:"setElementsCSS",value:function(s,u,l){var d,p,m,v,b;Object.assign(s.style,null==(d=u.container)?void 0:d[l]),Object.assign(s.children[0].style,null==(m=null==(p=u.svg)?void 0:p.styles)?void 0:m[l]),Object.assign(s.children[0].style,null==(b=null==(v=u.text)?void 0:v.styles)?void 0:b[l])}},{key:"setElementCssUpToState",value:function(s,u,l){a.setElementsCSS(s,u,"default"),"default"!==l&&(a.setElementsCSS(s,u,"hover"),"hover"!==l&&a.setElementsCSS(s,u,"click"))}}]),a}(),InputButton=function(){function a(h,s,u,l){_classCallCheck(this,a),this._mouseState={state:"default"},this.elementRef=h,this._customStyles=u,this.position=s,this.dropupText=l}return _createClass(a,[{key:"buttonMouseLeave",value:function(s){this._mouseState.state="default",s&&(ButtonCSS.unsetAllCSS(this.elementRef,s),ButtonCSS.setElementsCSS(this.elementRef,s,"default"))}},{key:"buttonMouseEnter",value:function(s){this._mouseState.state="hover",s&&ButtonCSS.setElementsCSS(this.elementRef,s,"hover")}},{key:"buttonMouseUp",value:function(s){s&&ButtonCSS.unsetActionCSS(this.elementRef,s),this.buttonMouseEnter(s)}},{key:"buttonMouseDown",value:function(s){this._mouseState.state="click",s&&ButtonCSS.setElementsCSS(this.elementRef,s,"click")}},{key:"setEvents",value:function(s){this.elementRef.onmousedown=this.buttonMouseDown.bind(this,s),this.elementRef.onmouseup=this.buttonMouseUp.bind(this,s),this.elementRef.onmouseenter=this.buttonMouseEnter.bind(this,s),this.elementRef.onmouseleave=this.buttonMouseLeave.bind(this,s)}},{key:"unsetCustomStateStyles",value:function(s){if(this._customStyles)for(var u=0;u<s.length;u+=1){var l=s[u],d=l&&this._customStyles[l];d&&ButtonCSS.unsetActionCSS(this.elementRef,d)}}},{key:"reapplyStateStyle",value:function(s,u){if(this._customStyles){u&&this.unsetCustomStateStyles(u);var l=this._customStyles[s];l&&ButtonCSS.setElementCssUpToState(this.elementRef,l,this._mouseState.state),this.setEvents(l)}}}]),a}(),DropupItemNavigation=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"focusItemWhenOnEdge",value:function(s,u){a.focusSiblingItem(u?s.children[0]:s.children[s.children.length-1],s,u,!0)}},{key:"focusSiblingItem",value:function(s,u,l){var p=arguments.length>3&&void 0!==arguments[3]&&arguments[3]?s:s[l?"nextSibling":"previousSibling"];p?(s.dispatchEvent(new MouseEvent("mouseleave")),p.dispatchEvent(new MouseEvent("mouseenter"))):(s.dispatchEvent(new MouseEvent("mouseleave")),a.focusItemWhenOnEdge(u,l))}}]),a}(),StatefulEvents=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"mouseUp",value:function(s,u){var l=u.target;StyleUtils.unsetAllCSSMouseStates(l,s),Object.assign(l.style,s.default),Object.assign(l.style,s.hover)}},{key:"mouseDown",value:function(s,u){Object.assign(u.target.style,s.click)}},{key:"mouseLeave",value:function(s,u){var l=u.target;StyleUtils.unsetAllCSSMouseStates(l,s),Object.assign(l.style,s.default)}},{key:"mouseEnter",value:function(s,u){Object.assign(u.target.style,s.hover)}},{key:"add",value:function(s,u){s.addEventListener("mouseenter",a.mouseEnter.bind(this,u)),s.addEventListener("mouseleave",a.mouseLeave.bind(this,u)),s.addEventListener("mousedown",a.mouseDown.bind(this,u)),s.addEventListener("mouseup",a.mouseUp.bind(this,u))}}]),a}(),DropupItem=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"addItemEvents",value:function(s,u,l,d){StatefulEvents.add(u,d),u.addEventListener("click",function(){l.click()}),u.addEventListener("mouseenter",function(p){s.highlightedItem=p.target}),u.addEventListener("mouseleave",function(){s.highlightedItem=void 0})}},{key:"createItemText",value:function(s,u){var l=document.createElement("div");return Object.assign(l.style,u),l.classList.add("dropup-menu-item-text"),l.textContent=s||"File",l}},{key:"createItemIcon",value:function(s,u){var l=document.createElement("div");return Object.assign(l.style,u),l.classList.add("dropup-menu-item-icon"),l.appendChild(s.children[0]),l}},{key:"populateItem",value:function(s,u,l,d){var p=s.children[0];p.classList.contains("text-button")?u.appendChild(a.createItemText(p.textContent,d?.text)):(u.appendChild(a.createItemIcon(s,d?.iconContainer)),u.appendChild(a.createItemText(l,d?.text)))}},{key:"createItem",value:function(s,u,l){var d,p=u.elementRef,m=u.dropupText,v=document.createElement("div");Object.assign(v.style,null==(d=l?.item)?void 0:d.default),a.populateItem(p,v,m,l),v.classList.add("dropup-menu-item");var b=StyleUtils.generateStateful(l?.item||{},{backgroundColor:"#f3f3f3"},{backgroundColor:"#ebebeb"});return a.addItemEvents(s,v,p,b),v}}]),a}(),DropupMenu=function(){function a(h,s){var l,u=this;_classCallCheck(this,a),this._isOpen=!0,this._styles=s,this.elementRef=a.createElement(null==(l=this._styles)?void 0:l.container),this.close(),setTimeout(function(){return u.addWindowEvents(h)})}return _createClass(a,[{key:"open",value:function(){this.elementRef.style.display="block",this._isOpen=!0}},{key:"close",value:function(){this._isOpen&&(this.elementRef.style.display="none",this._isOpen=!1)}},{key:"toggle",value:function(){this._isOpen?this.close():this.open()}},{key:"addItem",value:function(s){var u=DropupItem.createItem(this,s,this._styles);this.elementRef.appendChild(u)}},{key:"addWindowEvents",value:function(s){var u=this;window.addEventListener("click",function(l){var d;s.parentElement!==(null==(d=l.target.shadowRoot)?void 0:d.children[0])&&u.close()}),window.addEventListener("keydown",function(l){var d,p,m;u._isOpen&&(l.key===KEYBOARD_KEY.ESCAPE?(u.close(),null==(d=u.highlightedItem)||d.dispatchEvent(new MouseEvent("mouseleave"))):l.key===KEYBOARD_KEY.ENTER?(null==(p=u.highlightedItem)||p.click(),null==(m=u.highlightedItem)||m.dispatchEvent(new MouseEvent("mouseleave"))):l.key===KEYBOARD_KEY.ARROW_DOWN?DropupItemNavigation.focusSiblingItem(u.highlightedItem||u.elementRef.children[u.elementRef.children.length-1],u.elementRef,!0):l.key===KEYBOARD_KEY.ARROW_UP&&DropupItemNavigation.focusSiblingItem(u.highlightedItem||u.elementRef.children[0],u.elementRef,!1))})}}],[{key:"createElement",value:function(s){var u=document.createElement("div");return u.id="dropup-menu",Object.assign(u.style,s),u}}]),a}(),Dropup=function(a){_inherits(s,a);var h=_createSuper(s);function s(u,l){var d,p;_classCallCheck(this,s);var m=(d=h.call(this,s.createButtonElement(),void 0,{styles:null==(p=l?.button)?void 0:p.styles})).createInnerElements(d._customStyles);return d._menu=new DropupMenu(u,l?.menu),d.addClickEvent(),d.buttonContainer=s.createButtonContainer(),d.elementRef.appendChild(m.styles),d.buttonContainer.appendChild(d.elementRef),d.elementRef.classList.add("dropup-icon","upload-file-button"),d.buttonContainer.appendChild(d._menu.elementRef),d.reapplyStateStyle("styles"),d.addContainerEvents(u),d}return _createClass(s,[{key:"createInnerElements",value:function(l){return{styles:this.createInnerElement(s.createSVGIconElement(),"styles",l)}}},{key:"createInnerElement",value:function(l,d,p){return CustomButtonInnerElements.createSpecificStateElement(this.elementRef,d,p)||l}},{key:"addClickEvent",value:function(){this.elementRef.onclick=this._menu.toggle.bind(this._menu)}},{key:"addItem",value:function(l){this._menu.addItem(l)}},{key:"addContainerEvents",value:function(l){var d=this;l.addEventListener("click",function(p){p.target.classList.contains("dropup-icon")||d._menu.close()})}}],[{key:"createButtonElement",value:function(){var l=document.createElement("div");return l.classList.add("input-button"),l}},{key:"createSVGIconElement",value:function(){var l=SVGIconUtils.createSVGElement(PLUS_ICON_STRING);return l.id="dropup-icon",l}},{key:"createButtonContainer",value:function(){var l=document.createElement("div");return l.id="dropup-container",l}},{key:"getPosition",value:function(l,d){var p,m;return null!=(p=d?.button)&&p.position?null==(m=d?.button)?void 0:m.position:l["outside-left"].length>0&&0===l["outside-right"].length?"outside-right":"outside-left"}}]),s}(InputButton),InputButtonPositions=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"addToDropup",value:function(s,u,l,d){var p=new Dropup(l,d);BUTTON_ORDER.forEach(function(v){var b=u["dropup-menu"].findIndex(function(S){return S.buttonType===v}),w=u["dropup-menu"][b];w&&(p.addItem(w.button),u["dropup-menu"].splice(b,1))});var m=Dropup.getPosition(u,d);ButtonContainers.addButton(s,p.buttonContainer,m),u[m].push({})}},{key:"addToSideContainer",value:function(s,u){["inside-left","inside-right","outside-left","outside-right"].forEach(function(l){var d=l;u[d].forEach(function(p){ButtonContainers.addButton(s,p.button.elementRef,d)})})}},{key:"setPosition",value:function(s,u,l){var d=_objectSpread(_objectSpread({},s[u]),{},{buttonType:u});l.push(d),delete s[u]}},{key:"createPositionsObj",value:function(){return{"dropup-menu":[],"outside-left":[],"inside-left":[],"inside-right":[],"outside-right":[]}}},{key:"generatePositions",value:function(s){var u=a.createPositionsObj();Object.keys(s).forEach(function(d){var p,m=null==(p=s[d])?void 0:p.button.position;m&&a.setPosition(s,d,u[m])}),0===u["inside-right"].length&&s.submit&&a.setPosition(s,"submit",u["inside-right"]),0===u["outside-right"].length&&(s.submit?a.setPosition(s,"submit",u["outside-right"]):s.microphone?a.setPosition(s,"microphone",u["outside-right"]):s.camera&&a.setPosition(s,"camera",u["outside-right"])),s.submit&&a.setPosition(s,"submit",0===u["outside-left"].length?u["outside-left"]:u["inside-right"]),s.microphone&&a.setPosition(s,"microphone",0===u["outside-left"].length?u["outside-left"]:u["inside-right"]);var l=Object.keys(s);return l.length>1||u["dropup-menu"].length>0?BUTTON_ORDER.forEach(function(d){s[d]&&u["dropup-menu"].push(_objectSpread(_objectSpread({},s[d]),{},{buttonType:d}))}):1===l.length&&a.setPosition(s,l[0],0===u["outside-right"].length?u["outside-right"]:u["outside-left"]),u}},{key:"addButtons",value:function(s,u,l,d){var p=a.generatePositions(u);return a.addToSideContainer(s,p),p["dropup-menu"].length>0&&a.addToDropup(s,p,l,d),p}}]),a}(),MIXED_FILES_ICON_STRING='<?xml version="1.0" encoding="utf-8"?>\n<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n<title>file</title>\n<path d="M20 10.9696L11.9628 18.5497C10.9782 19.4783 9.64274 20 8.25028 20C6.85782 20 5.52239 19.4783 4.53777 18.5497C3.55315 17.6211 3 16.3616 3 15.0483C3 13.7351 3.55315 12.4756 4.53777 11.547L12.575 3.96687C13.2314 3.34779 14.1217 3 15.05 3C15.9783 3 16.8686 3.34779 17.525 3.96687C18.1814 4.58595 18.5502 5.4256 18.5502 6.30111C18.5502 7.17662 18.1814 8.01628 17.525 8.63535L9.47904 16.2154C9.15083 16.525 8.70569 16.6989 8.24154 16.6989C7.77738 16.6989 7.33224 16.525 7.00403 16.2154C6.67583 15.9059 6.49144 15.4861 6.49144 15.0483C6.49144 14.6106 6.67583 14.1907 7.00403 13.8812L14.429 6.88674" stroke="#000000" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>\n</svg>',IMAGE_ICON_STRING='<?xml version="1.0" encoding="utf-8"?>\n<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">\n  <path d="M20,15.2928932 L20,5.5 C20,4.67157288 19.3284271,4 18.5,4 L5.5,4 C4.67157288,4 4,4.67157288 4,5.5 L4,12.2928932 L7.14644661,9.14644661 C7.34170876,8.95118446 7.65829124,8.95118446 7.85355339,9.14644661 L13.5,14.7928932 L16.1464466,12.1464466 C16.3417088,11.9511845 16.6582912,11.9511845 16.8535534,12.1464466 L20,15.2928932 Z M20,16.7071068 L16.5,13.2071068 L13.8535534,15.8535534 C13.6582912,16.0488155 13.3417088,16.0488155 13.1464466,15.8535534 L7.5,10.2071068 L4,13.7071068 L4,18.5 C4,19.3284271 4.67157288,20 5.5,20 L18.5,20 C19.3284271,20 20,19.3284271 20,18.5 L20,16.7071068 Z M3,5.5 C3,4.11928813 4.11928813,3 5.5,3 L18.5,3 C19.8807119,3 21,4.11928813 21,5.5 L21,18.5 C21,19.8807119 19.8807119,21 18.5,21 L5.5,21 C4.11928813,21 3,19.8807119 3,18.5 L3,5.5 Z M15,6 L17,6 C17.5522847,6 18,6.44771525 18,7 L18,9 C18,9.55228475 17.5522847,10 17,10 L15,10 C14.4477153,10 14,9.55228475 14,9 L14,7 C14,6.44771525 14.4477153,6 15,6 Z M15,7 L15,9 L17,9 L17,7 L15,7 Z"/>\n</svg>\n',AUDIO_ICON_STRING='<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="-49.49 -49.49 593.87 593.87" stroke-width="3.95908" transform="rotate(0)">\n  <g stroke-width="0"></g>\n  <g stroke-linecap="round" stroke-linejoin="round" stroke-width="0.98977"></g>\n  <g>\n    <g>\n      <g>\n        <path d="M163.205,76.413v293.301c-3.434-3.058-7.241-5.867-11.486-8.339c-21.38-12.452-49.663-15.298-77.567-7.846 c-49.038,13.096-80.904,54.519-71.038,92.337c4.019,15.404,14.188,28.221,29.404,37.087c13.553,7.894,29.87,11.933,47.115,11.933 c9.962,0,20.231-1.356,30.447-4.087c42.74-11.406,72.411-44.344,72.807-77.654h0.011v-0.162c0.002-0.166,0-0.331,0-0.496V187.072 l290.971-67.3v178.082c-3.433-3.055-7.238-5.863-11.481-8.334c-21.385-12.452-49.654-15.308-77.567-7.846 c-49.038,13.087-80.904,54.519-71.038,92.356c4.019,15.385,14.183,28.212,29.404,37.067c13.548,7.894,29.875,11.933,47.115,11.933 c9.962,0,20.231-1.356,30.452-4.087c42.74-11.413,72.411-44.346,72.804-77.654h0.004v-0.065c0.003-0.236,0.001-0.469,0-0.704V0 L163.205,76.413z M104.999,471.779c-22.543,6.038-45.942,3.846-62.572-5.846c-10.587-6.163-17.591-14.817-20.255-25.038 c-7.144-27.375,18.452-58.029,57.062-68.346c8.409-2.25,16.938-3.346,25.188-3.346c13.87,0,26.962,3.115,37.389,9.192 c10.587,6.163,17.591,14.817,20.255,25.029c0.809,3.102,1.142,6.248,1.139,9.4v0.321h0.014 C162.99,437.714,139.082,462.678,104.999,471.779z M182.898,166.853V92.067l290.971-67.298v74.784L182.898,166.853z M415.677,399.923c-22.558,6.038-45.942,3.837-62.587-5.846c-10.587-6.163-17.587-14.817-20.25-25.019 c-7.144-27.385,18.452-58.058,57.058-68.365c8.414-2.25,16.942-3.346,25.192-3.346c13.875,0,26.962,3.115,37.385,9.192 c10.596,6.163,17.596,14.817,20.26,25.029v0.01c0.796,3.05,1.124,6.144,1.135,9.244v0.468h0.02 C473.668,365.851,449.763,390.814,415.677,399.923z">\n        </path>\n      </g>\n    </g>\n  </g>\n</svg>',GIF_ICON_STRING='<?xml version="1.0" encoding="UTF-8" standalone="no"?>\n<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 5.9266752 5.6408391" height="21.31971" width="22.4">\n  <g>\n    <path d="m 5.2564627,1.548212 c -3.1136005,-0.4796804 -1.5568006,-0.2398402 0,0 z M 2.0001198,2.0922063 c 0.1556781,0 0.2657489,0.020893 0.3917849,0.080366 0.081154,0.038347 0.1153492,0.134065 0.076377,0.2138602 -0.038973,0.07979 -0.1363527,0.1134129 -0.2175069,0.075091 -0.078199,-0.036919 -0.1407455,-0.048792 -0.250655,-0.048792 -0.2260486,0 -0.3921482,0.2042182 -0.3921482,0.4801409 0,0.2761822 0.1663188,0.4810688 0.3921482,0.4810688 0.1117901,0 0.2064255,-0.046133 0.255659,-0.1284198 l 0.00162,-0.00389 V 3.0534032 l -0.098011,1.75e-4 c -0.081844,0 -0.1495979,-0.059305 -0.1612403,-0.1365887 l -0.00175,-0.023683 c 0,-0.08047 0.060311,-0.1470874 0.1389194,-0.1585331 l 0.024085,-0.00195 h 0.2612303 c 0.081842,0 0.149598,0.059305 0.1612404,0.1365891 l 0.00175,0.023683 -3.398e-4,0.3968809 v 0 l -0.00168,0.014211 v 0 l -0.00553,0.023034 v 0 l -0.00532,0.014145 c -0.098178,0.22826 -0.3236506,0.3528713 -0.5706303,0.3528713 -0.4240855,0 -0.7181621,-0.3622714 -0.7181621,-0.8016063 0,-0.4391857 0.2940275,-0.8006848 0.7181621,-0.8006848 z m 1.2034759,0.031275 c 0.081843,0 0.1495977,0.059305 0.1612403,0.1365891 l 0.00175,0.023683 v 1.2211775 c 0,0.088516 -0.07298,0.1602721 -0.1630073,0.1602721 -0.081841,0 -0.1495972,-0.059305 -0.1612397,-0.1365892 L 3.040589,3.5049308 V 2.2837527 c 0,-0.088516 0.07298,-0.1602721 0.1630067,-0.1602714 z m 0.7813442,0 0.5209469,0.00195 c 0.090025,3.048e-4 0.1627543,0.072306 0.1624458,0.1608234 -2.809e-4,0.08047 -0.06083,0.1468798 -0.1394772,0.158066 l -0.024092,0.00195 -0.3575326,-0.0013 v 0.4497782 l 0.2928918,2.27e-4 c 0.081842,0 0.1495979,0.059305 0.1612403,0.136589 l 0.00175,0.023683 c 0,0.080469 -0.06031,0.1470871 -0.1389193,0.1585393 l -0.024092,0.00195 -0.2928919,-2.336e-4 1.563e-4,0.2860316 c 0,0.080471 -0.06031,0.1470873 -0.1389193,0.1585395 l -0.024085,0.00195 c -0.081843,0 -0.1495979,-0.059305 -0.1612403,-0.1365826 l -0.00175,-0.023691 V 2.2841354 c 2.798e-4,-0.08047 0.060829,-0.1468797 0.1394758,-0.1580594 z"/>\n    <path d="m 5.0894191,1.0943261 c 0,-0.21918999 -0.177687,-0.39686999 -0.396876,-0.39686999 h -3.43959 c -0.2191879,0 -0.391262,0.1777519 -0.3968759,0.39686999 l -0.027082,3.4379266 c 0.040152,0.2939927 0.4235456,0.409415 0.4235456,0.409415 l 3.4785583,-0.00851 c 0,0 0.3008506,-0.1402998 0.3236271,-0.4201576 0.042911,-0.5272495 0.034693,-1.6106146 0.034693,-3.4186761 z m -4.49792494,0 c 0,-0.36530999 0.29614504,-0.66145999 0.66145894,-0.66145999 h 3.43959 c 0.365314,0 0.66146,0.29615 0.66146,0.66145999 v 3.43959 c 0,0.36532 -0.296146,0.66146 -0.66146,0.66146 h -3.43959 c -0.3653139,0 -0.66145894,-0.29614 -0.66145894,-0.66146 z"/>\n  </g>\n</svg>\n',FILE_TYPE_BUTTON_ICONS={images:{id:"upload-images-icon",svgString:IMAGE_ICON_STRING,dropupText:"Image"},gifs:{id:"upload-gifs-icon",svgString:GIF_ICON_STRING,dropupText:"GIF"},audio:{id:"upload-audio-icon",svgString:AUDIO_ICON_STRING,dropupText:"Audio"},mixedFiles:{id:"upload-mixed-files-icon",svgString:MIXED_FILES_ICON_STRING,dropupText:"File"}},FileAttachmentsType=function(){function a(h,s,u){_classCallCheck(this,a),this._attachments=[],this._fileCountLimit=99,this._acceptedFormat="",h.maxNumberOfFiles&&(this._fileCountLimit=h.maxNumberOfFiles),this._toggleContainerDisplay=s,this._fileAttachmentsContainerRef=u,h.acceptedFormats&&(this._acceptedFormat=h.acceptedFormats)}return _createClass(a,[{key:"attemptAddFile",value:function(s,u){return!!a.isFileTypeValid(s,this._acceptedFormat)&&(this.addAttachmentBasedOnType(s,u,!0),!0)}},{key:"addAttachmentBasedOnType",value:function(s,u,l){if(s.type.startsWith("image")){var d=a.createImageAttachment(u);this.addFileAttachment(s,"image",d,l)}else if(s.type.startsWith("audio")){var p=AudioFileAttachmentType.createAudioAttachment(u);this.addFileAttachment(s,"audio",p,l)}else{var m=a.createAnyFileAttachment(s.name);this.addFileAttachment(s,"any",m,l)}}},{key:"addFileAttachment",value:function(s,u,l,d){var p=a.createContainer(l);if(this._attachments.length>=this._fileCountLimit){var m=this._attachments[this._attachments.length-1].removeButton;m?.click(),this._fileAttachmentsContainerRef.insertBefore(p,this._fileAttachmentsContainerRef.children[0])}else this._fileAttachmentsContainerRef.appendChild(p);var b={file:s,attachmentContainerElement:p,fileType:u};return d&&(b.removeButton=this.createRemoveAttachmentButton(b),p.appendChild(b.removeButton)),this._toggleContainerDisplay(!0),this._attachments.push(b),this._fileAttachmentsContainerRef.scrollTop=this._fileAttachmentsContainerRef.scrollHeight,b}},{key:"createRemoveAttachmentButton",value:function(s){var u=document.createElement("div");u.classList.add("remove-file-attachment-button"),u.onclick=this.removeAttachment.bind(this,s);var l=document.createElement("div");return l.classList.add("x-icon"),l.innerText="\xd7",u.appendChild(l),u}},{key:"removeAttachment",value:function(s){var u=this._attachments.findIndex(function(d){return d===s}),l=this._attachments[u].attachmentContainerElement;this._attachments.splice(u,1),AudioFileAttachmentType.stopAttachmentPlayback(l),l.remove(),this._toggleContainerDisplay(!1)}},{key:"getFiles",value:function(){return Array.from(this._attachments).map(function(s){return{file:s.file,type:s.fileType}})}},{key:"removeAllAttachments",value:function(){this._attachments.forEach(function(s){setTimeout(function(){var u;return null==(u=s.removeButton)?void 0:u.click()})})}}],[{key:"isFileTypeValid",value:function(s,u){if(""===u)return!0;for(var l=u.split(","),d=0;d<l.length;d++){var p=l[d].trim();if(s.type===p)return!0;if(p.startsWith(".")){var m=p.slice(1);if(s.name.endsWith(m))return!0}else if(s.name.endsWith(p)||p.endsWith("/*")&&s.type.startsWith(p.slice(0,-2)))return!0}return!1}},{key:"createImageAttachment",value:function(s){var u=new Image;return u.src=s,u.classList.add("image-attachment"),u}},{key:"createAnyFileAttachment",value:function(s){var u=document.createElement("div");u.classList.add("border-bound-attachment"),Browser$1.IS_SAFARI&&u.classList.add("border-bound-attachment-safari");var l=document.createElement("div");l.classList.add("any-file-attachment-text");var d=document.createElement("div");return d.classList.add("file-attachment-text-container"),d.appendChild(l),l.textContent=s,u.appendChild(d),u}},{key:"createContainer",value:function(s){var u=document.createElement("div");return u.classList.add("file-attachment"),u.appendChild(s),u}}]),a}(),PLAY_ICON_STRING='<?xml version="1.0" encoding="utf-8"?>\n<svg viewBox="0 0 32 32" version="1.1" xmlns="http://www.w3.org/2000/svg">\n  <title>play</title>\n  <path d="M5.92 24.096q0 1.088 0.928 1.728 0.512 0.288 1.088 0.288 0.448 0 0.896-0.224l16.16-8.064q0.48-0.256 0.8-0.736t0.288-1.088-0.288-1.056-0.8-0.736l-16.16-8.064q-0.448-0.224-0.896-0.224-0.544 0-1.088 0.288-0.928 0.608-0.928 1.728v16.16z"></path>\n</svg>',STOP_ICON_STRING='<?xml version="1.0" encoding="utf-8"?>\n<svg viewBox="0 0 32 32" version="1.1" xmlns="http://www.w3.org/2000/svg">\n<title>stop</title>\n<path d="M5.92 24.096q0 0.832 0.576 1.408t1.44 0.608h16.128q0.832 0 1.44-0.608t0.576-1.408v-16.16q0-0.832-0.576-1.44t-1.44-0.576h-16.128q-0.832 0-1.44 0.576t-0.576 1.44v16.16z"></path>\n</svg>',_AudioFileAttachmentType=function(a){_inherits(s,a);var h=_createSuper(s);function s(u,l,d){return _classCallCheck(this,s),h.call(this,u,l,d)}return _createClass(s,[{key:"createTimer",value:function(l,d){var p=this,m=0,v=void 0!==d&&d<s.TIMER_LIMIT_S?d:s.TIMER_LIMIT_S;return setInterval(function(){var b;(m+=1)===v&&(null==(b=p.stopPlaceholderCallback)||b.call(p),p.clearTimer()),600===m&&l.classList.add("audio-placeholder-text-4-digits");var w=Math.floor(m/60),S=(m%60).toString().padStart(2,"0");l.textContent="".concat(w,":").concat(S)},1e3)}},{key:"createPlaceholderAudioAttachment",value:function(l){var d=s.createAudioContainer(),p=document.createElement("div");p.classList.add("audio-placeholder-text-3-digits");var m=document.createElement("div");m.classList.add("file-attachment-text-container","audio-placeholder-text-3-digits-container"),m.appendChild(p);var v=SVGIconUtils.createSVGElement(STOP_ICON_STRING);return v.classList.add("attachment-icon","stop-icon","not-removable-attachment-icon"),p.textContent="0:00",this._activePlaceholderTimer=this.createTimer(p,l),d.appendChild(m),this.addPlaceholderAudioAttachmentEvents(d,v,m),d}},{key:"addPlaceholderAudioAttachmentEvents",value:function(l,d,p){var m=this;l.addEventListener("mouseenter",function(){return l.replaceChildren(d)}),l.addEventListener("mouseleave",function(){return l.replaceChildren(p)}),l.addEventListener("click",function(){var M;return null==(M=m.stopPlaceholderCallback)?void 0:M.call(m)})}},{key:"addPlaceholderAttachment",value:function(l,d){var p=this.createPlaceholderAudioAttachment(d);this._activePlaceholderAttachment=this.addFileAttachment(new File([],""),"audio",p,!1),this.stopPlaceholderCallback=l}},{key:"completePlaceholderAttachment",value:function(l,d){var p=this._activePlaceholderAttachment;p&&(p.file=l,s.addAudioElements(p.attachmentContainerElement.children[0],d),p.removeButton=this.createRemoveAttachmentButton(p),p.attachmentContainerElement.appendChild(p.removeButton),this._activePlaceholderAttachment=void 0,this.clearTimer())}},{key:"removePlaceholderAttachment",value:function(){this._activePlaceholderAttachment&&(this.removeAttachment(this._activePlaceholderAttachment),this._activePlaceholderAttachment=void 0,this.clearTimer())}},{key:"clearTimer",value:function(){void 0!==this._activePlaceholderTimer&&(clearInterval(this._activePlaceholderTimer),this._activePlaceholderTimer=void 0,this.stopPlaceholderCallback=void 0)}}],[{key:"createAudioContainer",value:function(){var l=document.createElement("div");return l.classList.add("border-bound-attachment","audio-attachment-icon-container"),Browser$1.IS_SAFARI&&l.classList.add("border-bound-attachment-safari"),l}},{key:"addAudioElements",value:function(l,d){var p=l.parentElement?ElementUtils.cloneElement(l):l,m=document.createElement("audio");m.src=d;var v=SVGIconUtils.createSVGElement(PLAY_ICON_STRING);v.classList.add("attachment-icon","play-icon");var b=SVGIconUtils.createSVGElement(STOP_ICON_STRING);b.classList.add("attachment-icon","stop-icon"),p.replaceChildren(v),m.onplay=function(){p.replaceChildren(b)},m.onpause=function(){p.replaceChildren(v),m.currentTime=0},m.onended=function(){p.replaceChildren(v)},p.onclick=function(){m.paused?m.play():m.pause()}}},{key:"createAudioAttachment",value:function(l){var d=s.createAudioContainer();return s.addAudioElements(d,l),d}},{key:"stopAttachmentPlayback",value:function(l){var d,p,m;null!=(m=null==(p=null==(d=l.children[0])?void 0:d.children)?void 0:p[0])&&m.classList.contains("stop-icon")&&l.children[0].click()}}]),s}(FileAttachmentsType);_AudioFileAttachmentType.TIMER_LIMIT_S=5999;var AudioFileAttachmentType=_AudioFileAttachmentType,FileAttachmentTypeFactory=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"create",value:function(s,u,l,d){return"audio"===d?new AudioFileAttachmentType(s,u,l):new FileAttachmentsType(s,u,l)}}]),a}(),FileAttachments=function(){function a(h,s,u){_classCallCheck(this,a),this._fileAttachmentsTypes=[],this.elementRef=this.createAttachmentContainer();var l="object"==_typeof(u)&&!!u.displayFileAttachmentContainer;this.toggleContainerDisplay(l),h.appendChild(this.elementRef),s&&Object.assign(this.elementRef.style,s)}return _createClass(a,[{key:"addType",value:function(s,u){var l=FileAttachmentTypeFactory.create(s,this.toggleContainerDisplay.bind(this),this.elementRef,u);return this._fileAttachmentsTypes.push(l),l}},{key:"createAttachmentContainer",value:function(){var s=document.createElement("div");return s.id="file-attachment-container",s}},{key:"toggleContainerDisplay",value:function(s){s?this.elementRef.style.display="block":0===this.elementRef.children.length&&(this.elementRef.style.display="none")}},{key:"getAllFileData",value:function(){var s=this._fileAttachmentsTypes.map(function(u){return u.getFiles()}).flat();return s.length>0?s:void 0}},{key:"completePlaceholders",value:(h=_asyncToGenerator(_regeneratorRuntime().mark(function u(){return _regeneratorRuntime().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,Promise.all(this._fileAttachmentsTypes.map(function(){var p=_asyncToGenerator(_regeneratorRuntime().mark(function m(v){var b;return _regeneratorRuntime().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return S.abrupt("return",null==(b=v.stopPlaceholderCallback)?void 0:b.call(v));case 1:case"end":return S.stop()}},m)}));return function(m){return p.apply(this,arguments)}}()));case 2:case"end":return d.stop()}},u,this)})),function s(){return h.apply(this,arguments)})},{key:"addFilesToAnyType",value:function(s){a.addFilesToType(s,this._fileAttachmentsTypes)}},{key:"removeAllFiles",value:function(){this._fileAttachmentsTypes.forEach(function(s){return s.removeAllAttachments()}),this.elementRef.replaceChildren(),this.toggleContainerDisplay(!1)}},{key:"getNumberOfTypes",value:function(){return this._fileAttachmentsTypes.length}}],[{key:"addFilesToType",value:function(s,u){s.forEach(function(l){var d=new FileReader;d.readAsDataURL(l),d.onload=function(p){for(var m=0;m<u.length&&!u[m].attemptAddFile(l,p.target.result);m+=1);}})}}]),a;var h}(),_Modal=function(){function a(h,s,u){_classCallCheck(this,a),this._isOpen=!1,this._contentRef=a.createModalContent(s,u?.backgroundColor),this._buttonPanel=a.createButtonPanel(u?.backgroundColor),this._elementRef=a.createContainer(this._contentRef,u),this._elementRef.appendChild(this._buttonPanel),h.appendChild(this._elementRef),this._backgroundPanelRef=a.createDarkBackgroundPanel(),h.appendChild(this._backgroundPanelRef),this.addWindowEvents()}return _createClass(a,[{key:"isOpen",value:function(){return this._isOpen}},{key:"addButtons",value:function(){for(var s=this,u=arguments.length,l=new Array(u),d=0;d<u;d++)l[d]=arguments[d];l.forEach(function(p){return s._buttonPanel.appendChild(p)})}},{key:"close",value:function(){var s=this;this._elementRef.classList.remove("show-modal"),this._elementRef.classList.add("hide-modal"),this._backgroundPanelRef.classList.remove("show-modal-background"),this._backgroundPanelRef.classList.add("hide-modal-background"),this._isOpen=!1,setTimeout(function(){s._elementRef.style.display="none",s._backgroundPanelRef.style.display="none"},a.MODAL_CLOSE_TIMEOUT_MS)}},{key:"displayModalElements",value:function(){this._elementRef.style.display="flex",this._elementRef.classList.remove("hide-modal"),this._elementRef.classList.add("show-modal"),this._backgroundPanelRef.style.display="block",this._backgroundPanelRef.classList.remove("hide-modal-background"),this._backgroundPanelRef.classList.add("show-modal-background"),this._isOpen=!0}},{key:"openTextModal",value:function(s){this._contentRef.innerHTML=s,this.displayModalElements()}},{key:"addCloseButton",value:function(s,u,l){var d=this,p=u?a.createSVGButton(s):a.createTextButton(s);return this.addButtons(p),p.onclick=function(){d.close(),setTimeout(function(){l?.()},140)},p}},{key:"addWindowEvents",value:function(){var s=this;window.addEventListener("keydown",function(u){var l,d;s._isOpen&&(u.key===KEYBOARD_KEY.ESCAPE?(s.close(),null==(l=s.extensionCloseCallback)||l.call(s)):u.key===KEYBOARD_KEY.ENTER&&(s.close(),null==(d=s.extensionCloseCallback)||d.call(s)))})}}],[{key:"createContainer",value:function(s,u){var l=document.createElement("div");return l.classList.add("modal"),l.appendChild(s),u&&delete u.backgroundColor,Object.assign(l.style,u),l}},{key:"createModalContent",value:function(s,u){var l,d=document.createElement("div");return(l=d.classList).add.apply(l,_toConsumableArray(s)),u&&(d.style.backgroundColor=u),document.createElement("div").appendChild(d),d}},{key:"createButtonPanel",value:function(s){var u=document.createElement("div");return u.classList.add("modal-button-panel"),s&&(u.style.backgroundColor=s),u}},{key:"createDarkBackgroundPanel",value:function(){var s=document.createElement("div");return s.id="modal-background-panel",s}},{key:"createTextButton",value:function(s){var u=document.createElement("div");return u.classList.add("modal-button"),u.textContent=s,u}},{key:"createSVGButton",value:function(s){var u=document.createElement("div");u.classList.add("modal-button","modal-svg-button");var l=SVGIconUtils.createSVGElement(s);return l.classList.add("modal-svg-button-icon"),u.appendChild(l),u}},{key:"createTextModalFunc",value:function(s,u,l){var d;if("object"==_typeof(u)&&null!=(d=u.files)&&d.infoModal){var p=new a(s,["modal-content"],u.files.infoModal.containerStyle);return p.addCloseButton("OK",!1,l),p.openTextModal.bind(p,u.infoModalTextMarkUp||"")}}}]),a}();_Modal.MODAL_CLOSE_TIMEOUT_MS=190;var Modal=_Modal,UploadFileButton=function(a){_inherits(s,a);var h=_createSuper(s);function s(u,l,d,p,m,v){var b,w,S,M,A,k,N;_classCallCheck(this,s);var B=(b=h.call(this,s.createButtonElement(),null==(w=d.button)?void 0:w.position,d.button,v)).createInnerElements(p,m,b._customStyles);return b._inputElement=s.createInputElement(null==(S=d?.files)?void 0:S.acceptedFormats),b.addClickEvent(u,d),b.elementRef.replaceChildren(B.styles),b.reapplyStateStyle("styles"),b._fileAttachmentsType=l,b._openModalOnce=!1===(null==(A=null==(M=d.files)?void 0:M.infoModal)?void 0:A.openModalOnce)||null==(N=null==(k=d.files)?void 0:k.infoModal)?void 0:N.openModalOnce,b}return _createClass(s,[{key:"createInnerElements",value:function(l,d,p){var m=s.createSVGIconElement(l,d);return{styles:this.createInnerElement(m,"styles",p)}}},{key:"triggerImportPrompt",value:function(l){l.onchange=this.import.bind(this,l),l.click()}},{key:"import",value:function(l){FileAttachments.addFilesToType(Array.from(l.files||[]),[this._fileAttachmentsType]),l.value=""}},{key:"createInnerElement",value:function(l,d,p){return CustomButtonInnerElements.createSpecificStateElement(this.elementRef,d,p)||l}},{key:"addClickEvent",value:function(l,d){var p=this.triggerImportPrompt.bind(this,this._inputElement),m=Modal.createTextModalFunc(l,d,p);this.elementRef.onclick=this.click.bind(this,m)}},{key:"click",value:function(l){!l||void 0!==this._openModalOnce&&!0!==this._openModalOnce?this.triggerImportPrompt(this._inputElement):(l(),!0===this._openModalOnce&&(this._openModalOnce=!1))}}],[{key:"createInputElement",value:function(l){var d=document.createElement("input");return d.type="file",d.accept=l||"",d.hidden=!0,d.multiple=!0,d}},{key:"createButtonElement",value:function(){var l=document.createElement("div");return l.classList.add("input-button","upload-file-button"),l}},{key:"createSVGIconElement",value:function(l,d){var p=SVGIconUtils.createSVGElement(d);return p.id=l,p}}]),s}(InputButton),DragAndDrop=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"create",value:function(s,u,l){var d=a.createElement(l);a.addEvents(d,s,u),s.appendChild(d)}},{key:"createElement",value:function(s){var u=document.createElement("div");return u.id="drag-and-drop","object"==_typeof(s)&&Object.assign(u.style,s),u}},{key:"addEvents",value:function(s,u,l){u.ondragenter=function(d){d.preventDefault(),a.display(s)},s.ondragleave=function(d){d.preventDefault(),a.hide(s)},s.ondragover=function(d){d.preventDefault()},s.ondrop=function(d){d.preventDefault(),a.uploadFile(l,d),a.hide(s)}}},{key:"uploadFile",value:function(s,u){var l,d=null==(l=u.dataTransfer)?void 0:l.files;d&&s.addFilesToAnyType(Array.from(d))}},{key:"display",value:function(s){s.style.display="block"}},{key:"hide",value:function(s){s.style.display="none"}},{key:"isEnabled",value:function(s,u){return(void 0===u||!1!==u)&&(!!u||s.getNumberOfTypes()>0)}}]),a}(),MICROPHONE_ICON_STRING='<?xml version="1.0" encoding="iso-8859-1"?>\n<svg height="1.4em" width="1.4em" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"\n\t viewBox="0 0 490.9 490.9" xml:space="preserve">\n\t<g>\n\t\t<g>\n\t\t\t<path d="M245.5,322.9c53,0,96.2-43.2,96.2-96.2V96.2c0-53-43.2-96.2-96.2-96.2s-96.2,43.2-96.2,96.2v130.5\n\t\t\t\tC149.3,279.8,192.5,322.9,245.5,322.9z M173.8,96.2c0-39.5,32.2-71.7,71.7-71.7s71.7,32.2,71.7,71.7v130.5\n\t\t\t\tc0,39.5-32.2,71.7-71.7,71.7s-71.7-32.2-71.7-71.7V96.2z"/>\n\t\t\t<path d="M94.4,214.5c-6.8,0-12.3,5.5-12.3,12.3c0,85.9,66.7,156.6,151.1,162.8v76.7h-63.9c-6.8,0-12.3,5.5-12.3,12.3\n\t\t\t\ts5.5,12.3,12.3,12.3h152.3c6.8,0,12.3-5.5,12.3-12.3s-5.5-12.3-12.3-12.3h-63.9v-76.7c84.4-6.3,151.1-76.9,151.1-162.8\n\t\t\t\tc0-6.8-5.5-12.3-12.3-12.3s-12.3,5.5-12.3,12.3c0,76.6-62.3,138.9-138.9,138.9s-138.9-62.3-138.9-138.9\n\t\t\t\tC106.6,220,101.2,214.5,94.4,214.5z"/>\n\t\t</g>\n\t</g>\n</svg>\n',MicrophoneButton=function(a){_inherits(s,a);var h=_createSuper(s);function s(u){var l;return _classCallCheck(this,s),"dropup-menu"===u?.position&&(u.position="outside-right"),(l=h.call(this,s.createMicrophoneElement(),u?.position,u)).isActive=!1,l._innerElements=l.createInnerElements(l._customStyles),l.changeToDefault(),l}return _createClass(s,[{key:"createInnerElements",value:function(l){var d=s.createSVGIconElement();return{default:this.createInnerElement(d,"default",l),active:this.createInnerElement(d,"active",l),unsupported:this.createInnerElement(d,"unsupported",l),commandMode:this.createInnerElement(d,"commandMode",l)}}},{key:"createInnerElement",value:function(l,d,p){return CustomButtonInnerElements.createSpecificStateElement(this.elementRef,d,p)||l}},{key:"changeToActive",value:function(){this.elementRef.replaceChildren(this._innerElements.active),this.toggleIconFilter("active"),this.reapplyStateStyle("active",["default","commandMode"]),this.isActive=!0}},{key:"changeToDefault",value:function(){this.elementRef.replaceChildren(this._innerElements.default),this.toggleIconFilter("default"),this.reapplyStateStyle("default",["active","commandMode"]),this.isActive=!1}},{key:"changeToCommandMode",value:function(){this.elementRef.replaceChildren(this._innerElements.unsupported),this.toggleIconFilter("command"),this.reapplyStateStyle("commandMode",["active"])}},{key:"changeToUnsupported",value:function(){this.elementRef.replaceChildren(this._innerElements.unsupported),this.elementRef.classList.add("unsupported-microphone"),this.reapplyStateStyle("unsupported",["active"])}},{key:"toggleIconFilter",value:function(l){var d=this.elementRef.children[0];if("svg"===d.tagName.toLocaleLowerCase())switch(l){case"default":d.classList.remove("active-microphone-icon","command-microphone-icon"),d.classList.add("default-microphone-icon");break;case"active":d.classList.remove("default-microphone-icon","command-microphone-icon"),d.classList.add("active-microphone-icon");break;case"command":d.classList.remove("active-microphone-icon","default-microphone-icon"),d.classList.add("command-microphone-icon")}}}],[{key:"createMicrophoneElement",value:function(){var l=document.createElement("div");return l.id="microphone-button",l.classList.add("input-button"),l}},{key:"createSVGIconElement",value:function(){var l=SVGIconUtils.createSVGElement(MICROPHONE_ICON_STRING);return l.id="microphone-icon",l}}]),s}(InputButton),dist={},webSpeech={},webSpeechTranscript={},translate={},text={};Object.defineProperty(text,"__esModule",{value:!0}),text.Text=void 0;var Text=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"capitalize",value:function(s){return s.replace(a.FIRST_CHAR_REGEX,function(u){return u.toUpperCase()})}},{key:"lineBreak",value:function(s){return s.replace(a.DOUBLE_LINE,"<p></p>").replace(a.ONE_LINE,"<br>")}},{key:"isCharDefined",value:function(s){return void 0!==s&&"\xa0"!==s&&" "!==s&&"\n"!==s&&""!==s}},{key:"breakupIntoWordsArr",value:function(s){return s.split(/(\W+)/)}}]),a}();text.Text=Text,Text.FIRST_CHAR_REGEX=/\S/,Text.DOUBLE_LINE=/\n\n/g,Text.ONE_LINE=/\n/g,Object.defineProperty(translate,"__esModule",{value:!0}),translate.Translate=void 0;var text_1$3=text,Translate=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"translate",value:function(s,u){for(var l=text_1$3.Text.breakupIntoWordsArr(s),d=0;d<l.length;d+=1)u[l[d]]&&(l[d]=u[l[d]]);return l.join("")}}]),a}();translate.Translate=Translate,Object.defineProperty(webSpeechTranscript,"__esModule",{value:!0}),webSpeechTranscript.WebSpeechTranscript=void 0;var translate_1$1=translate,WebSpeechTranscript=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"extract",value:function(s,u,l){for(var d="",p=s.resultIndex;p<s.results.length;++p){var m=s.results[p][0].transcript;l&&(m=translate_1$1.Translate.translate(m,l)),s.results[p].isFinal?u+=m:d+=m}return{interimTranscript:d,finalTranscript:u,newText:d||u}}},{key:"extractSafari",value:function(s,u,l){for(var d="",m=s.resultIndex;m<s.results.length;++m){var v=s.results[m][0].transcript;l&&(v=translate_1$1.Translate.translate(v,l)),d+=v}return{interimTranscript:"",finalTranscript:d,newText:d}}}]),a}();webSpeechTranscript.WebSpeechTranscript=WebSpeechTranscript;var browser={};Object.defineProperty(browser,"__esModule",{value:!0}),browser.Browser=void 0;var Browser=_createClass(function a(){_classCallCheck(this,a)});browser.Browser=Browser,Browser.IS_SAFARI=function(){return void 0===Browser._IS_SAFARI&&(Browser._IS_SAFARI=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)),Browser._IS_SAFARI};var speech={},eventListeners={};Object.defineProperty(eventListeners,"__esModule",{value:!0}),eventListeners.EventListeners=void 0;var EventListeners=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"getElementIfFocusedOnAvailable",value:function(s,u){return Array.isArray(s)?s.find(function(l){return u===l}):u===s?s:void 0}},{key:"keyDownWindow",value:function(s){var u=this;s.element&&a.getElementIfFocusedOnAvailable(s.element,document.activeElement)&&(null!==a.KEY_DOWN_TIMEOUT&&clearTimeout(a.KEY_DOWN_TIMEOUT),a.KEY_DOWN_TIMEOUT=setTimeout(function(){a.KEY_DOWN_TIMEOUT=null,u.resetRecording(s)},500))}},{key:"mouseDownWindow",value:function(s,u){this.mouseDownElement=a.getElementIfFocusedOnAvailable(s,u.target)}},{key:"mouseUpWindow",value:function(s){this.mouseDownElement&&this.resetRecording(s),this.mouseDownElement=void 0}},{key:"add",value:function(s,u){null!=u&&u.element&&(void 0===u?.insertInCursorLocation||u?.insertInCursorLocation)&&(s.mouseDownEvent=a.mouseDownWindow.bind(s,u.element),document.addEventListener("mousedown",s.mouseDownEvent),s.mouseUpEvent=a.mouseUpWindow.bind(s,u),document.addEventListener("mouseup",s.mouseUpEvent),s.keyDownEvent=a.keyDownWindow.bind(s,u),document.addEventListener("keydown",s.keyDownEvent))}},{key:"remove",value:function(s){document.removeEventListener("mousedown",s.mouseDownEvent),document.removeEventListener("mouseup",s.mouseUpEvent),document.removeEventListener("keydown",s.keyDownEvent)}}]),a}();eventListeners.EventListeners=EventListeners,EventListeners.KEY_DOWN_TIMEOUT=null;var preResultUtils={};Object.defineProperty(preResultUtils,"__esModule",{value:!0}),preResultUtils.PreResultUtils=void 0;var PreResultUtils=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"process",value:function(s,u,l,d,p){var m=d?.(u,l);return!!m&&(setTimeout(function(){m.restart?s.resetRecording(p):m.stop&&s.stop()}),(m.stop||m.restart)&&m.removeNewText)}}]),a}();preResultUtils.PreResultUtils=PreResultUtils;var commandUtils={},autoScroll={};Object.defineProperty(autoScroll,"__esModule",{value:!0}),autoScroll.AutoScroll=void 0;var AutoScroll=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"changeStateIfNeeded",value:function(s,u){u&&!s.isCursorAtEnd&&(s.endPadding="",s.scrollingSpan.innerHTML="&nbsp;")}},{key:"scrollGeneric",value:function(s,u){s.isCursorAtEnd?u.scrollTop=u.scrollHeight:s.scrollingSpan.scrollIntoView({block:"nearest"})}},{key:"scrollSafariPrimitiveToEnd",value:function(s){s.scrollLeft=s.scrollWidth,s.scrollTop=s.scrollHeight}},{key:"isElementOverflown",value:function(s){return s.scrollHeight>s.clientHeight||s.scrollWidth>s.clientWidth}},{key:"isRequired",value:function(s,u){return s&&a.isElementOverflown(u)}}]),a}();autoScroll.AutoScroll=AutoScroll;var elements={};Object.defineProperty(elements,"__esModule",{value:!0}),elements.Elements=void 0;var Elements=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"isPrimitiveElement",value:function(s){return"INPUT"===s.tagName||"TEXTAREA"===s.tagName}},{key:"createInterimSpan",value:function(){var s=document.createElement("span");return s.style.color="grey",s.style.pointerEvents="none",s}},{key:"createGenericSpan",value:function(){var s=document.createElement("span");return s.style.pointerEvents="none",s}},{key:"appendSpans",value:function(s,u){if(s.spansPopulated=!0,s.insertInCursorLocation&&document.activeElement===u){var l=window.getSelection();if(null!=l&&l.focusNode){var d=l.getRangeAt(0);return d.insertNode(s.scrollingSpan),d.insertNode(s.interimSpan),d.insertNode(s.finalSpan),d.collapse(!1),l.removeAllRanges(),void l.addRange(d)}}u.appendChild(s.finalSpan),u.appendChild(s.interimSpan),u.appendChild(s.scrollingSpan)}},{key:"applyCustomColors",value:function(s,u){u.interim&&(s.interimSpan.style.color=u.interim),u.final&&(s.finalSpan.style.color=u.final)}},{key:"isInsideShadowDOM",value:function(s){return s.getRootNode()instanceof ShadowRoot}}]),a}();elements.Elements=Elements;var cursor={};Object.defineProperty(cursor,"__esModule",{value:!0}),cursor.Cursor=void 0;var Cursor=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"setOffsetForGeneric",value:function(s,u){for(var l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,d=0,p=0;p<s.childNodes.length;p+=1){var m=s.childNodes[p];if(m.childNodes.length>0){var v=a.setOffsetForGeneric(m,u,l);if(-1===v)return-1;l+=v}else if(null!==m.textContent){if(l+m.textContent.length>u){var b=document.createRange();b.setStart(m,u-l),b.collapse(!0);var w=window.getSelection();return w?.removeAllRanges(),w?.addRange(b),s.focus(),-1}l+=m.textContent.length,d+=m.textContent.length}}return d}},{key:"focusEndOfGeneric",value:function(s){var u=document.createRange();u.selectNodeContents(s),u.collapse(!1);var l=window.getSelection();l&&(l.removeAllRanges(),l.addRange(u))}},{key:"setOffsetForSafariGeneric",value:function(s,u){var l=window.getSelection();if(l){var d=a.getGenericElementCursorOffset(s,l,!0);console.log(d),setTimeout(function(){},100),a.setOffsetForGeneric(s,d+u)}}},{key:"setOffsetForPrimitive",value:function(s,u,l){l&&s.blur(),s.setSelectionRange(u,u),s.focus()}},{key:"getGenericElementCursorOffset",value:function(s,u,l){var d=0;if(u.rangeCount>0){var p=u.getRangeAt(0),m=p.cloneRange();m.selectNodeContents(s),l?m.setEnd(p.startContainer,p.startOffset):m.setEnd(p.endContainer,p.endOffset),d=m.toString().length}return d}}]),a}();cursor.Cursor=Cursor,Object.defineProperty(commandUtils,"__esModule",{value:!0}),commandUtils.CommandUtils=void 0;var autoScroll_1$1=autoScroll,elements_1$3=elements,browser_1$2=browser,cursor_1$3=cursor,text_1$2=text,CommandUtils=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"processCommand",value:function(s,u){return(!u||!u.caseSensitive)&&(s=s.toLowerCase()),!1===u?.substrings?text_1$2.Text.breakupIntoWordsArr(s):s}},{key:"process",value:function(s){var u;return!0===(null===(u=s.settings)||void 0===u?void 0:u.caseSensitive)?s:Object.keys(s).reduce(function(l,d){var p=s[d];return l[d]="string"==typeof p?a.processCommand(p,s.settings):p,l},{})}},{key:"toggleCommandModeOn",value:function(s){var u;s.isWaitingForCommand=!0,null===(u=s.onCommandModeTrigger)||void 0===u||u.call(s,!0)}},{key:"toggleCommandModeOff",value:function(s){var u;s.isWaitingForCommand&&(null===(u=s.onCommandModeTrigger)||void 0===u||u.call(s,!1),s.isWaitingForCommand=!1)}},{key:"setText",value:function(s,u,l,d){a.toggleCommandModeOff(s),elements_1$3.Elements.isPrimitiveElement(d)?(d.value=l,s.isTargetInShadow||cursor_1$3.Cursor.setOffsetForPrimitive(d,l.length,!0),browser_1$2.Browser.IS_SAFARI()&&s.autoScroll&&autoScroll_1$1.AutoScroll.scrollSafariPrimitiveToEnd(d)):(d.textContent=l,s.isTargetInShadow||cursor_1$3.Cursor.focusEndOfGeneric(d),setTimeout(function(){return autoScroll_1$1.AutoScroll.scrollGeneric(s,d)})),s.resetRecording(u)}},{key:"checkIfMatchesSubstring",value:function(s,u){return u.includes(s)}},{key:"checkIfMatchesWord",value:function(s,u,l){for(var d=s,p=l.length-1;p>=0;p-=1){for(var m=p,v=d.length-1;l[m]===d[v]&&v>=0;)m-=1,v-=1;if(v<0)return!0}return!1}},{key:"execCommand",value:function(s,u,l,d,p){var m,v,b,w=s.commands;if(w&&d&&l){var S=!0===(null===(m=w.settings)||void 0===m?void 0:m.caseSensitive)?u:u.toLowerCase(),M=text_1$2.Text.breakupIntoWordsArr(S),A=!1===(null===(v=w.settings)||void 0===v?void 0:v.substrings)?a.checkIfMatchesWord:a.checkIfMatchesSubstring;if(w.commandMode&&A(w.commandMode,S,M))return s.setInterimColorToFinal(),setTimeout(function(){return a.toggleCommandModeOn(s)}),{doNotProcessTranscription:!1};if(!w.commandMode||s.isWaitingForCommand){if(w.stop&&A(w.stop,S,M))return a.toggleCommandModeOff(s),setTimeout(function(){return s.stop()}),{doNotProcessTranscription:!1};if(w.pause&&A(w.pause,S,M))return a.toggleCommandModeOff(s),s.setInterimColorToFinal(),setTimeout(function(){var k;s.isPaused=!0,null===(k=s.onPauseTrigger)||void 0===k||k.call(s,!0)}),{doNotProcessTranscription:!1};if(w.resume&&A(w.resume,S,M))return s.isPaused=!1,null===(b=s.onPauseTrigger)||void 0===b||b.call(s,!1),a.toggleCommandModeOff(s),s.resetRecording(l),{doNotProcessTranscription:!0};if(w.reset&&A(w.reset,S,M))return void 0!==p&&a.setText(s,l,p,d),{doNotProcessTranscription:!0};if(w.removeAllText&&A(w.removeAllText,S,M))return a.setText(s,l,"",d),{doNotProcessTranscription:!0}}}}}]),a}();commandUtils.CommandUtils=CommandUtils;var highlight={};Object.defineProperty(highlight,"__esModule",{value:!0}),highlight.Highlight=void 0;var elements_1$2=elements,cursor_1$2=cursor,Highlight=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"setStateForPrimitive",value:function(s,u){var l,d;null!==u.selectionStart&&(l=u.selectionStart),null!==u.selectionEnd&&(d=u.selectionEnd),s.isHighlighted=l!==d}},{key:"setStateForGeneric",value:function(s,u){var l=window.getSelection();if(null!=l&&l.focusNode){var d=cursor_1$2.Cursor.getGenericElementCursorOffset(u,l,!0),p=cursor_1$2.Cursor.getGenericElementCursorOffset(u,l,!1);s.isHighlighted=d!==p}}},{key:"setState",value:function(s,u){document.activeElement===u&&(elements_1$2.Elements.isPrimitiveElement(u)?a.setStateForPrimitive(s,u):a.setStateForGeneric(s,u))}},{key:"removeForGeneric",value:function(s,u){var l=window.getSelection();if(l){var d=cursor_1$2.Cursor.getGenericElementCursorOffset(u,l,!0);l.deleteFromDocument(),cursor_1$2.Cursor.setOffsetForGeneric(u,d),s.isHighlighted=!1}}},{key:"removeForPrimitive",value:function(s,u){var l=u.selectionStart,d=u.selectionEnd,p=u.value;if(l&&d){var m=p.substring(0,l)+p.substring(d);u.value=m,cursor_1$2.Cursor.setOffsetForPrimitive(u,l,s.autoScroll)}s.isHighlighted=!1}}]),a}();highlight.Highlight=Highlight;var padding={};Object.defineProperty(padding,"__esModule",{value:!0}),padding.Padding=void 0;var elements_1$1=elements,cursor_1$1=cursor,text_1$1=text,Padding=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"setStateForPrimitiveElement",value:function(s,u){if(document.activeElement===u&&null!==u.selectionStart){var l=u.selectionStart,p=null===u.selectionEnd?l:u.selectionEnd,m=u.value[p];return text_1$1.Text.isCharDefined(u.value[l-1])&&(s.startPadding=" ",s.numberOfSpacesBeforeNewText=1),text_1$1.Text.isCharDefined(m)&&(s.endPadding=" ",s.numberOfSpacesAfterNewText=1),void(s.isCursorAtEnd=u.value.length===p)}text_1$1.Text.isCharDefined(u.value[u.value.length-1])&&(s.startPadding=" ",s.numberOfSpacesBeforeNewText=1),s.isCursorAtEnd=!0}},{key:"setStateForGenericElement",value:function(s,u){var l,d,p;if(document.activeElement===u){var m=window.getSelection();if(null!=m&&m.focusNode){var v=cursor_1$1.Cursor.getGenericElementCursorOffset(u,m,!0),b=null===(l=u.textContent)||void 0===l?void 0:l[v-1],w=cursor_1$1.Cursor.getGenericElementCursorOffset(u,m,!1),S=null===(d=u.textContent)||void 0===d?void 0:d[w];return text_1$1.Text.isCharDefined(b)&&(s.startPadding=" "),text_1$1.Text.isCharDefined(S)&&(s.endPadding=" "),void(s.isCursorAtEnd=(null===(p=u.textContent)||void 0===p?void 0:p.length)===w)}}var M=u.innerText.charAt(u.innerText.length-1);text_1$1.Text.isCharDefined(M)&&(s.startPadding=" "),s.isCursorAtEnd=!0}},{key:"setState",value:function(s,u){elements_1$1.Elements.isPrimitiveElement(u)?a.setStateForPrimitiveElement(s,u):a.setStateForGenericElement(s,u)}},{key:"adjustStateAfterRecodingPrimitiveElement",value:function(s,u){s.primitiveTextRecorded=!0,s.startPadding=s.insertInCursorLocation&&document.activeElement===u&&(null!==u.selectionEnd&&(s.endPadding=s.endPadding+u.value.slice(u.selectionEnd)),null!==u.selectionStart)?u.value.slice(0,u.selectionStart)+s.startPadding:u.value+s.startPadding}},{key:"adjustSateForNoTextPrimitiveElement",value:function(s){1===s.numberOfSpacesBeforeNewText&&(s.startPadding=s.startPadding.substring(0,s.startPadding.length-1),s.numberOfSpacesBeforeNewText=0),1===s.numberOfSpacesAfterNewText&&(s.endPadding=s.endPadding.substring(1),s.numberOfSpacesAfterNewText=0)}}]),a}();padding.Padding=Padding,Object.defineProperty(speech,"__esModule",{value:!0}),speech.Speech=void 0;var eventListeners_1=eventListeners,preResultUtils_1=preResultUtils,commandUtils_1$1=commandUtils,autoScroll_1=autoScroll,highlight_1=highlight,elements_1=elements,padding_1=padding,browser_1$1=browser,cursor_1=cursor,text_1=text,Speech=function(){function a(){_classCallCheck(this,a),this.finalTranscript="",this.interimSpan=elements_1.Elements.createInterimSpan(),this.finalSpan=elements_1.Elements.createGenericSpan(),this.scrollingSpan=elements_1.Elements.createGenericSpan(),this.isCursorAtEnd=!1,this.spansPopulated=!1,this.startPadding="",this.endPadding="",this.numberOfSpacesBeforeNewText=0,this.numberOfSpacesAfterNewText=0,this.isHighlighted=!1,this.primitiveTextRecorded=!1,this.recognizing=!1,this._displayInterimResults=!0,this.insertInCursorLocation=!0,this.autoScroll=!0,this.isRestarting=!1,this.isPaused=!1,this.isWaitingForCommand=!1,this.isTargetInShadow=!1,this.cannotBeStopped=!1,this.resetState()}return _createClass(a,[{key:"prepareBeforeStart",value:function(s){var u,l;if(null!=s&&s.element)if(eventListeners_1.EventListeners.add(this,s),Array.isArray(s.element)){var d=s.element.find(function(p){return p===document.activeElement})||s.element[0];if(!d)return;this.prepare(d)}else this.prepare(s.element);void 0!==s?.displayInterimResults&&(this._displayInterimResults=s.displayInterimResults),null!=s&&s.textColor&&(this._finalTextColor=null===(u=s?.textColor)||void 0===u?void 0:u.final,elements_1.Elements.applyCustomColors(this,s.textColor)),void 0!==s?.insertInCursorLocation&&(this.insertInCursorLocation=s.insertInCursorLocation),void 0!==s?.autoScroll&&(this.autoScroll=s.autoScroll),this._onResult=s?.onResult,this._onPreResult=s?.onPreResult,this._onStart=s?.onStart,this._onStop=s?.onStop,this._onError=s?.onError,this.onCommandModeTrigger=s?.onCommandModeTrigger,this.onPauseTrigger=s?.onPauseTrigger,this._options=s,null!==(l=this._options)&&void 0!==l&&l.commands&&(this.commands=commandUtils_1$1.CommandUtils.process(this._options.commands))}},{key:"prepare",value:function(s){padding_1.Padding.setState(this,s),highlight_1.Highlight.setState(this,s),this.isTargetInShadow=elements_1.Elements.isInsideShadowDOM(s),elements_1.Elements.isPrimitiveElement(s)?(this._primitiveElement=s,this._originalText=this._primitiveElement.value):(this._genericElement=s,this._originalText=this._genericElement.textContent)}},{key:"resetRecording",value:function(s){this.isRestarting=!0,this.stop(!0),this.resetState(!0),this.start(s,!0)}},{key:"updateElements",value:function(s,u,l){var d,p=text_1.Text.capitalize(u);if(this.finalTranscript!==p||""!==s){preResultUtils_1.PreResultUtils.process(this,l,""===s,this._onPreResult,this._options)&&(s="",l="");var m=this.commands&&commandUtils_1$1.CommandUtils.execCommand(this,l,this._options,this._primitiveElement||this._genericElement,this._originalText);if(m){if(m.doNotProcessTranscription)return;s="",l=""}if(!this.isPaused&&!this.isWaitingForCommand){null===(d=this._onResult)||void 0===d||d.call(this,l,""===s),this.finalTranscript=p,this._displayInterimResults||(s="");var v=""===this.finalTranscript&&""===s;this._primitiveElement?this.updatePrimitiveElement(this._primitiveElement,s,v):this._genericElement&&this.updateGenericElement(this._genericElement,s,v)}}}},{key:"updatePrimitiveElement",value:function(s,u,l){this.isHighlighted&&highlight_1.Highlight.removeForPrimitive(this,s),this.primitiveTextRecorded||padding_1.Padding.adjustStateAfterRecodingPrimitiveElement(this,s),l&&padding_1.Padding.adjustSateForNoTextPrimitiveElement(this);var d=this.startPadding+this.finalTranscript+u;s.value=d+this.endPadding,this.isTargetInShadow||cursor_1.Cursor.setOffsetForPrimitive(s,d.length+this.numberOfSpacesAfterNewText,this.autoScroll),this.autoScroll&&browser_1$1.Browser.IS_SAFARI()&&this.isCursorAtEnd&&autoScroll_1.AutoScroll.scrollSafariPrimitiveToEnd(s)}},{key:"updateGenericElement",value:function(s,u,l){this.isHighlighted&&highlight_1.Highlight.removeForGeneric(this,s),this.spansPopulated||elements_1.Elements.appendSpans(this,s);var d=(l?"":this.startPadding)+text_1.Text.lineBreak(this.finalTranscript);this.finalSpan.innerHTML=d;var p=autoScroll_1.AutoScroll.isRequired(this.autoScroll,s);autoScroll_1.AutoScroll.changeStateIfNeeded(this,p);var m=text_1.Text.lineBreak(u)+(l?"":this.endPadding);this.interimSpan.innerHTML=m,browser_1$1.Browser.IS_SAFARI()&&this.insertInCursorLocation&&cursor_1.Cursor.setOffsetForSafariGeneric(s,d.length+m.length),p&&autoScroll_1.AutoScroll.scrollGeneric(this,s),l&&(this.scrollingSpan.innerHTML="")}},{key:"finalise",value:function(s){this._genericElement&&(s?(this.finalSpan=elements_1.Elements.createGenericSpan(),this.setInterimColorToFinal(),this.interimSpan=elements_1.Elements.createInterimSpan(),this.scrollingSpan=elements_1.Elements.createGenericSpan()):this._genericElement.textContent=this._genericElement.textContent,this.spansPopulated=!1),eventListeners_1.EventListeners.remove(this)}},{key:"setInterimColorToFinal",value:function(){this.interimSpan.style.color=this._finalTextColor||"black"}},{key:"resetState",value:function(s){this._primitiveElement=void 0,this._genericElement=void 0,this.finalTranscript="",this.finalSpan.innerHTML="",this.interimSpan.innerHTML="",this.scrollingSpan.innerHTML="",this.startPadding="",this.endPadding="",this.isHighlighted=!1,this.primitiveTextRecorded=!1,this.numberOfSpacesBeforeNewText=0,this.numberOfSpacesAfterNewText=0,s||(this.stopTimeout=void 0)}},{key:"setStateOnStart",value:function(){var s;this.recognizing=!0,this.isRestarting?this.isRestarting=!1:null===(s=this._onStart)||void 0===s||s.call(this)}},{key:"setStateOnStop",value:function(){var s;this.recognizing=!1,this.isRestarting||null===(s=this._onStop)||void 0===s||s.call(this)}},{key:"setStateOnError",value:function(s){var u;null===(u=this._onError)||void 0===u||u.call(this,s),this.recognizing=!1}}]),a}();speech.Speech=Speech,Object.defineProperty(webSpeech,"__esModule",{value:!0}),webSpeech.WebSpeech=void 0;var webSpeechTranscript_1=webSpeechTranscript,browser_1=browser,speech_1$1=speech,WebSpeech=function(a){_inherits(s,a);var h=_createSuper(s);function s(){return _classCallCheck(this,s),h.call(this)}return _createClass(s,[{key:"start",value:function(l){var d;void 0===this._extractText&&(this._extractText=browser_1.Browser.IS_SAFARI()?webSpeechTranscript_1.WebSpeechTranscript.extractSafari:webSpeechTranscript_1.WebSpeechTranscript.extract),this.validate()&&(this.prepareBeforeStart(l),this.instantiateService(l),null===(d=this._service)||void 0===d||d.start(),this._translations=l?.translations)}},{key:"validate",value:function(){return!!s.getAPI()||(this.error("Speech Recognition is unsupported"),!1)}},{key:"instantiateService",value:function(l){var d,p,m=s.getAPI();this._service=new m,this._service.continuous=!0,this._service.interimResults=null===(d=l?.displayInterimResults)||void 0===d||d,this._service.lang=(null===(p=l?.language)||void 0===p?void 0:p.trim())||"en-US",this.setEvents()}},{key:"setEvents",value:function(){var l=this;this._service&&(this._service.onstart=function(){l.setStateOnStart()},this._service.onerror=function(d){browser_1.Browser.IS_SAFARI()&&"Another request is started"===d.message||"aborted"===d.error&&l.isRestarting||"no-speech"!==d.error&&l.error(d.message||d.error)},this._service.onaudioend=function(){l.setStateOnStop()},this._service.onend=function(){l._stopping=!1},this._service.onresult=function(d){if(_typeof(d.results)>"u"&&l._service)l._service.onend=null,l._service.stop();else if(l._extractText&&!l._stopping){var p=l._extractText(d,l.finalTranscript,l._translations);l.updateElements(p.interimTranscript,p.finalTranscript,p.newText)}})}},{key:"stop",value:function(l){var d;this._stopping=!0,null===(d=this._service)||void 0===d||d.stop(),this.finalise(l)}},{key:"error",value:function(l){console.error(l),this.setStateOnError(l),this.stop()}}],[{key:"getAPI",value:function(){return window.webkitSpeechRecognition||window.SpeechRecognition}}]),s}(speech_1$1.Speech);webSpeech.WebSpeech=WebSpeech;var globalState={};Object.defineProperty(globalState,"__esModule",{value:!0}),globalState.GlobalState=void 0;var GlobalState=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"doubleClickDetector",value:function(){return!!a.doubleClickPending||(a.doubleClickPending=!0,setTimeout(function(){a.doubleClickPending=!1},300),!1)}}]),a}();globalState.GlobalState=GlobalState,GlobalState.doubleClickPending=!1;var azure={},preventConnectionStop={};Object.defineProperty(preventConnectionStop,"__esModule",{value:!0}),preventConnectionStop.PreventConnectionStop=void 0;var PreventConnectionStop=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"applyPrevention",value:function(s){clearTimeout(s._manualConnectionStopPrevention),s.cannotBeStopped=!0,s._manualConnectionStopPrevention=setTimeout(function(){s.cannotBeStopped=!1},800)}},{key:"clearPrevention",value:function(s){clearTimeout(s._manualConnectionStopPrevention),s.cannotBeStopped=!1}}]),a}();preventConnectionStop.PreventConnectionStop=PreventConnectionStop;var azureSpeechConfig={},readme={};Object.defineProperty(readme,"__esModule",{value:!0}),readme.README_URL=void 0,readme.README_URL="https://github.com/OvidijusParsiunas/speech-to-element",Object.defineProperty(azureSpeechConfig,"__esModule",{value:!0}),azureSpeechConfig.AzureSpeechConfig=void 0;var readme_1=readme,AzureSpeechConfig=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"validateOptions",value:function(s,u){return u?u.subscriptionKey||u.token||u.retrieveToken?!!u.region||(s("Please define a 'region' property - more info: ".concat(readme_1.README_URL)),!1):(s("Please define a 'subscriptionKey', 'token' or 'retrieveToken' property - more info: ".concat(readme_1.README_URL)),!1):(s("Please provide subscription details - more info: ".concat(readme_1.README_URL)),!1)}},{key:"getNewSpeechConfig",value:(h=_asyncToGenerator(_regeneratorRuntime().mark(function u(l,d){return _regeneratorRuntime().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(!d.region){m.next=2;break}return m.abrupt("return",d.subscriptionKey?l.fromSubscription(d.subscriptionKey.trim(),d.region.trim()):d.token?l.fromAuthorizationToken(d.token.trim(),d.region.trim()):d.retrieveToken?d.retrieveToken().then(function(v){return d.region?l.fromAuthorizationToken(v?.trim()||"",d.region.trim()):null}).catch(function(v){return console.error(v),null}):null);case 2:case"end":return m.stop()}},u)})),function s(u,l){return h.apply(this,arguments)})},{key:"process",value:function(s,u){u.language&&(s.speechRecognitionLanguage=u.language.trim())}},{key:"get",value:function(){var h=_asyncToGenerator(_regeneratorRuntime().mark(function u(l,d){var p;return _regeneratorRuntime().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.next=2,a.getNewSpeechConfig(l,d);case 2:return v.abrupt("return",((p=v.sent)&&a.process(p,d),p));case 4:case"end":return v.stop()}},u)}));return function s(u,l){return h.apply(this,arguments)}}()}]),a;var h}();azureSpeechConfig.AzureSpeechConfig=AzureSpeechConfig;var stopTimeout={};Object.defineProperty(stopTimeout,"__esModule",{value:!0}),stopTimeout.StopTimeout=void 0;var StopTimeout=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"set",value:function(s){s.stopTimeout=setTimeout(function(){return s.stop()},s.stopTimeoutMS)}},{key:"reset",value:function(s,u){s.stopTimeoutMS=u||a.DEFAULT_MS,s.stopTimeout&&clearTimeout(s.stopTimeout),a.set(s)}}]),a}();stopTimeout.StopTimeout=StopTimeout,StopTimeout.DEFAULT_MS=2e4;var azureTranscript={};Object.defineProperty(azureTranscript,"__esModule",{value:!0}),azureTranscript.AzureTranscript=void 0;var translate_1=translate,AzureTranscript=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"extract",value:function(s,u,l,d){return d&&(s=translate_1.Translate.translate(s,d)),l?{interimTranscript:"",finalTranscript:u+s,newText:s}:{interimTranscript:s,finalTranscript:u,newText:s}}}]),a}();azureTranscript.AzureTranscript=AzureTranscript,Object.defineProperty(azure,"__esModule",{value:!0}),azure.Azure=void 0;var preventConnectionStop_1=preventConnectionStop,azureSpeechConfig_1=azureSpeechConfig,stopTimeout_1=stopTimeout,azureTranscript_1=azureTranscript,speech_1=speech,Azure=function(a){_inherits(s,a);var u,h=_createSuper(s);function s(){var u;return _classCallCheck(this,s),(u=h.apply(this,arguments))._newTextPadding="",u}return _createClass(s,[{key:"start",value:function(l,d){this._newTextPadding="",void 0===this.stopTimeout&&stopTimeout_1.StopTimeout.reset(this,l?.stopAfterSilenceMs),this.prepareBeforeStart(l),this.startAsync(l),d||preventConnectionStop_1.PreventConnectionStop.applyPrevention(this)}},{key:"startAsync",value:(u=_asyncToGenerator(_regeneratorRuntime().mark(function d(p){var m;return _regeneratorRuntime().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:if(b.t0=this.validate(p),!b.t0){b.next=6;break}return b.next=4,this.instantiateService(p);case 4:this._translations=p?.translations,null===(m=this._service)||void 0===m||m.startContinuousRecognitionAsync(function(){},this.error);case 6:case"end":return b.stop()}},d,this)})),function l(d){return u.apply(this,arguments)})},{key:"validate",value:function(l){return s.getAPI()?azureSpeechConfig_1.AzureSpeechConfig.validateOptions(this.error.bind(this),l):(this.moduleNotFound(),!1)}},{key:"instantiateService",value:function(){var u=_asyncToGenerator(_regeneratorRuntime().mark(function d(p){var m,v,b,w;return _regeneratorRuntime().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return m=s.getAPI(),v=m.AudioConfig.fromDefaultMicrophoneInput(),M.next=4,azureSpeechConfig_1.AzureSpeechConfig.get(m.SpeechConfig,p);case 4:(b=M.sent)?(w=new m.SpeechRecognizer(b,v),this.setEvents(w),this._service=w,p.retrieveToken&&this.retrieveTokenInterval(p.retrieveToken)):this.error("Unable to contact Azure server");case 6:case"end":return M.stop()}},d,this)}));return function l(d){return u.apply(this,arguments)}}()},{key:"setEvents",value:function(l){l.recognizing=this.onRecognizing.bind(this),l.recognized=this.onRecognized.bind(this),l.sessionStarted=this.onSessionStarted.bind(this),l.canceled=this.onCanceled.bind(this),l.sessionStopped=this.onSessionStopped.bind(this)}},{key:"onRecognizing",value:function(l,d){if(!this._stopping){var p=azureTranscript_1.AzureTranscript.extract(this._newTextPadding+d.result.text,this.finalTranscript,!1,this._translations),m=p.interimTranscript,v=p.finalTranscript,b=p.newText;stopTimeout_1.StopTimeout.reset(this,this.stopTimeoutMS),this.updateElements(m,v,b)}}},{key:"onRecognized",value:function(l,d){var p=d.result;switch(p.reason){case window.SpeechSDK.ResultReason.Canceled:break;case window.SpeechSDK.ResultReason.RecognizedSpeech:if(p.text&&!this._stopping){var m=azureTranscript_1.AzureTranscript.extract(this._newTextPadding+p.text,this.finalTranscript,!0,this._translations),v=m.interimTranscript,b=m.finalTranscript,w=m.newText;stopTimeout_1.StopTimeout.reset(this,this.stopTimeoutMS),this.updateElements(v,b,w),""!==b&&(this._newTextPadding=" ")}}}},{key:"onCanceled",value:function(l,d){d.reason===window.SpeechSDK.CancellationReason.Error&&this.error(d.errorDetails)}},{key:"onSessionStarted",value:function(){preventConnectionStop_1.PreventConnectionStop.clearPrevention(this),this.setStateOnStart()}},{key:"onSessionStopped",value:function(){this._retrieveTokenInterval||clearInterval(this._retrieveTokenInterval),this._stopping=!1,this.setStateOnStop()}},{key:"retrieveTokenInterval",value:function(l){var d=this;this._retrieveTokenInterval=setInterval(function(){l?.().then(function(p){d._service&&(d._service.authorizationToken=p?.trim()||"")}).catch(function(p){d.error(p)})},1e4)}},{key:"stop",value:function(l){var d;!l&&this._retrieveTokenInterval&&clearInterval(this._retrieveTokenInterval),this._stopping=!0,null===(d=this._service)||void 0===d||d.stopContinuousRecognitionAsync(),this.finalise(l)}},{key:"moduleNotFound",value:function(){console.error("speech recognition module not found:"),console.error("please install the 'microsoft-cognitiveservices-speech-sdk' npm package or add a script tag: <script src=\"https://aka.ms/csspeech/jsbrowserpackageraw\"><\/script>"),this.setStateOnError("speech recognition module not found")}},{key:"error",value:function(l){this._retrieveTokenInterval&&clearInterval(this._retrieveTokenInterval),console.error(l),this.setStateOnError(l),this.stop()}}],[{key:"getAPI",value:function(){return window.SpeechSDK}}]),s}(speech_1.Speech);azure.Azure=Azure,Object.defineProperty(dist,"__esModule",{value:!0});var webSpeech_1=webSpeech,commandUtils_1=commandUtils,globalState_1=globalState,azure_1=azure,SpeechToElement=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"toggle",value:function(s,u){var l,d,p=s.toLocaleLowerCase().trim();null!==(l=globalState_1.GlobalState.service)&&void 0!==l&&l.recognizing?this.stop():"webspeech"===p?a.startWebSpeech(u):"azure"===p?a.startAzure(u):(console.error("service not found - must be either 'webspeech' or 'azure'"),null===(d=u?.onError)||void 0===d||d.call(u,"service not found - must be either 'webspeech' or 'azure'"))}},{key:"startWebSpeech",value:function(s){a.stop()||(globalState_1.GlobalState.service=new webSpeech_1.WebSpeech,globalState_1.GlobalState.service.start(s))}},{key:"isWebSpeechSupported",value:function(){return!!webSpeech_1.WebSpeech.getAPI()}},{key:"startAzure",value:function(s){var u;a.stop()||null!==(u=globalState_1.GlobalState.service)&&void 0!==u&&u.cannotBeStopped||(globalState_1.GlobalState.service=new azure_1.Azure,globalState_1.GlobalState.service.start(s))}},{key:"stop",value:function(){var s;return!!globalState_1.GlobalState.doubleClickDetector()||(!(null===(s=globalState_1.GlobalState.service)||void 0===s)&&s.recognizing&&globalState_1.GlobalState.service.stop(),!1)}},{key:"endCommandMode",value:function(){globalState_1.GlobalState.service&&commandUtils_1.CommandUtils.toggleCommandModeOff(globalState_1.GlobalState.service)}}]),a}(),_default=dist.default=SpeechToElement,SpeechToText=function(a){_inherits(s,a);var h=_createSuper(s);function s(u,l,d){var p,m;_classCallCheck(this,s),p=h.call(this,"object"==_typeof(u.speechToText)?null==(m=u.speechToText)?void 0:m.button:{});var v=s.processConfiguration(l,u.speechToText),b=v.serviceName,w=v.processedConfig;if(p._addErrorMessage=d,"webspeech"!==b||_default.isWebSpeechSupported()){var S=!u.textInput||!u.textInput.disabled;p.elementRef.onclick=p.buttonClick.bind(_assertThisInitialized(p),l,S,b,w)}else p.changeToUnsupported();return p}return _createClass(s,[{key:"buttonClick",value:function(l,d,p,m){l.removeTextIfPlaceholder(),_default.toggle(p,_objectSpread({insertInCursorLocation:!1,element:d?l.inputElementRef:void 0,onError:this.onError.bind(this),onStart:this.changeToActive.bind(this),onStop:this.changeToDefault.bind(this),onCommandModeTrigger:this.onCommandModeTrigger.bind(this)},m))}},{key:"onCommandModeTrigger",value:function(l){l?this.changeToCommandMode():this.changeToActive()}},{key:"onError",value:function(){this._addErrorMessage("speechToText","speech input error")}}],[{key:"processConfiguration",value:function(l,d){var p,m,v,b,w,S="object"==_typeof(d)?d:{},M="object"==_typeof(S.webSpeech)?S.webSpeech:{},A=S.azure||{},k=_objectSpread(_objectSpread({displayInterimResults:null!==(p=S.displayInterimResults)&&void 0!==p?p:void 0,textColor:null!==(m=S.textColor)&&void 0!==m?m:void 0,translations:null!==(v=S.translations)&&void 0!==v?v:void 0,commands:null!==(b=S.commands)&&void 0!==b?b:void 0},M),A),N=null==(w=S.commands)?void 0:w.submit;return N&&(k.onPreResult=function(B){return B.toLowerCase().includes(N)?(setTimeout(function(){var z;return null==(z=l.submit)?void 0:z.call(l)}),_default.endCommandMode(),{restart:!0,removeNewText:!0}):null}),{serviceName:s.getServiceName(S),processedConfig:k}}},{key:"getServiceName",value:function(l){return l.webSpeech?"webspeech":l.azure?"azure":"webspeech"}}]),s}(MicrophoneButton),NewFileName=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"getFileName",value:function(s,u){var l=new Date,d=String(l.getHours()).padStart(2,"0"),p=String(l.getMinutes()).padStart(2,"0"),m=String(l.getSeconds()).padStart(2,"0");return"".concat(s,"-").concat(d,"-").concat(p,"-").concat(m,".").concat(u)}}]),a}(),RecordAudio=function(a){_inherits(s,a);var h=_createSuper(s);function s(u,l){var d,p,m;return _classCallCheck(this,s),(d=h.call(this,l.button))._waitingForBrowserApproval=!1,d._audioType=u,d._extension=(null==(p=l.files)?void 0:p.format)||"mp3",d._maxDurationSeconds=null==(m=l.files)?void 0:m.maxDurationSeconds,d.elementRef.onclick=d.buttonClick.bind(_assertThisInitialized(d)),d}return _createClass(s,[{key:"buttonClick",value:function(){this._waitingForBrowserApproval||(this.isActive?this.stop():(this._waitingForBrowserApproval=!0,this.record()))}},{key:"stop",value:function(){var l=this;return new Promise(function(d){var p,m;l.changeToDefault(),null==(p=l._mediaRecorder)||p.stop(),null==(m=l._mediaStream)||m.getTracks().forEach(function(v){return v.stop()}),setTimeout(function(){d()},10)})}},{key:"record",value:function(){var l=this;navigator.mediaDevices.getUserMedia({audio:!0}).then(function(d){l.changeToActive(),l._mediaRecorder=new MediaRecorder(d),l._audioType.addPlaceholderAttachment(l.stop.bind(l),l._maxDurationSeconds),l._mediaStream=d,l._mediaRecorder.addEventListener("dataavailable",function(p){l.createFile(p)}),l._mediaRecorder.start()}).catch(function(d){console.error(d),l.stop()}).finally(function(){l._waitingForBrowserApproval=!1})}},{key:"createFile",value:function(l){var d=this,p=new Blob([l.data],{type:"audio/".concat(this._extension)}),m=NewFileName.getFileName(this._newFilePrefix||"audio",this._extension),v=new File([p],m,{type:p.type}),b=new FileReader;b.readAsDataURL(v),b.onload=function(w){d._audioType.completePlaceholderAttachment(v,w.target.result)}}}]),s}(MicrophoneButton),SUBMIT_ICON_STRING='<?xml version="1.0" standalone="no"?>\n<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.0//EN" "http://www.w3.org/TR/2001/REC-SVG-20010904/DTD/svg10.dtd">\n<svg xmlns="http://www.w3.org/2000/svg" stroke="currentColor" fill="none" stroke-width="1" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round">\n  <line x1="22" y1="2" x2="11" y2="14"></line>\n  <polygon points="22 2 15 22 11 14 2 10 22 2"></polygon>\n</svg>\n',SubmitButtonStateStyle=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"resetSubmit",value:function(s,u){s.unsetCustomStateStyles(u?["loading","submit"]:["stop","loading","submit"]),s.reapplyStateStyle("submit")}}]),a}(),SubmitButton=function(a){_inherits(s,a);var u,h=_createSuper(s);function s(u,l,d,p,m){var v,b;return _classCallCheck(this,s),(v=h.call(this,s.createButtonContainerElement(),null==(b=u.submitButtonStyles)?void 0:b.position,u.submitButtonStyles))._isRequestInProgress=!1,v._isLoadingActive=!1,v._isSVGLoadingIconOverriden=!1,v._messages=d,v._inputElementRef=l,v._fileAttachments=m,v._innerElements=v.createInnerElements(),v._abortStream=new AbortController,v._stopClicked={listener:function(){}},v._serviceIO=p,v.attemptOverwriteLoadingStyle(u),v.changeToSubmitIcon(),v.assignHandlers(),v}return _createClass(s,[{key:"createInnerElements",value:function(){var l=CustomButtonInnerElements.create(this.elementRef,["submit","loading","stop"],this._customStyles),p=l.loading,m=l.stop;return{submit:l.submit||s.createSubmitIconElement(),loading:p||s.createLoadingIconElement(),stop:m||s.createStopIconElement()}}},{key:"attemptOverwriteLoadingStyle",value:function(l){var d,p,m,v,b,w,S,M,A;if(!(null!=(p=null==(d=this._customStyles)?void 0:d.submit)&&p.svg||null!=(b=null==(v=null==(m=this._customStyles)?void 0:m.loading)?void 0:v.svg)&&b.content||null!=(M=null==(S=null==(w=this._customStyles)?void 0:w.loading)?void 0:S.text)&&M.content||void 0!==l.displayLoadingBubble&&!0!==l.displayLoadingBubble)){var k=document.createElement("style");k.textContent="\n        .loading-button > * {\n          filter: brightness(0) saturate(100%) invert(72%) sepia(0%) saturate(3044%) hue-rotate(322deg) brightness(100%)\n            contrast(96%) !important;\n        }",null==(A=l.shadowRoot)||A.appendChild(k),this._isSVGLoadingIconOverriden=!0}}},{key:"assignHandlers",value:function(){this._serviceIO.completionsHandlers={onFinish:this.changeToSubmitIcon.bind(this)},this._serviceIO.streamHandlers={onOpen:this.changeToStopIcon.bind(this),onClose:this.changeToSubmitIcon.bind(this),abortStream:this._abortStream,stopClicked:this._stopClicked};var l=this._serviceIO.deepChat.stream;"object"==_typeof(l)&&"number"==typeof l.simulation&&(this._serviceIO.streamHandlers.simulationInterim=l.simulation)}},{key:"submitFromInput",value:function(){var l;if(this._inputElementRef.classList.contains("text-input-placeholder"))this.submit(!1,"");else{var d=null==(l=this._inputElementRef.textContent)?void 0:l.trim();this.submit(!1,d)}}},{key:"submit",value:(u=_asyncToGenerator(_regeneratorRuntime().mark(function d(p,m){var v,b,w,S,M,A;return _regeneratorRuntime().wrap(function(N){for(;;)switch(N.prev=N.next){case 0:if(N.t0=p,N.t0){N.next=6;break}return N.next=4,this._fileAttachments.completePlaceholders();case 4:w=this._fileAttachments.getAllFileData(),S=w?.map(function(B){return B.file});case 6:if(M=""===m?void 0:m,!this._isRequestInProgress&&Websocket.canSendMessage(this._serviceIO.websocket)){N.next=9;break}return N.abrupt("return");case 9:if(null==(v=this._serviceIO.deepChat)||!v.validateMessageBeforeSending){N.next=14;break}if(this._serviceIO.deepChat.validateMessageBeforeSending(M,S)){N.next=12;break}return N.abrupt("return");case 12:N.next=16;break;case 14:if(this._serviceIO.canSendMessage(M,S)){N.next=16;break}return N.abrupt("return");case 16:if(this.changeToLoadingIcon(),""!==m&&this._messages.addNewMessage({text:m},!1,!0),N.t1=w,!N.t1){N.next=22;break}return N.next=22,this._messages.addMultipleFiles(w);case 22:return this._messages.addLoadingMessage(),p||TextInputEl.clear(this._inputElementRef),A={text:M,files:S},N.next=27,this._serviceIO.callAPI(A,this._messages);case 27:p||null==(b=this._fileAttachments)||b.removeAllFiles();case 28:case"end":return N.stop()}},d,this)})),function l(d,p){return u.apply(this,arguments)})},{key:"stopStream",value:function(){var l;this._abortStream.abort(),null==(l=this._stopClicked)||l.listener(),this.changeToSubmitIcon()}},{key:"changeToStopIcon",value:function(){this.elementRef.classList.remove("loading-button"),this.elementRef.replaceChildren(this._innerElements.stop),this.reapplyStateStyle("stop",["loading","submit"]),this.elementRef.onclick=this.stopStream.bind(this),this._isLoadingActive=!1}},{key:"changeToLoadingIcon",value:function(){this._serviceIO.websocket||(this._isSVGLoadingIconOverriden||this.elementRef.replaceChildren(this._innerElements.loading),this.elementRef.classList.add("loading-button"),this.reapplyStateStyle("loading",["submit"]),this.elementRef.onclick=function(){},this._isRequestInProgress=!0,this._isLoadingActive=!0)}},{key:"changeToSubmitIcon",value:function(){this.elementRef.classList.remove("loading-button"),this.elementRef.replaceChildren(this._innerElements.submit),SubmitButtonStateStyle.resetSubmit(this,this._isLoadingActive),this.elementRef.onclick=this.submitFromInput.bind(this),this._isRequestInProgress=!1,this._isLoadingActive=!1}}],[{key:"createButtonContainerElement",value:function(){var l=document.createElement("div");return l.classList.add("input-button"),l}},{key:"createSubmitIconElement",value:function(){var l=SVGIconUtils.createSVGElement(SUBMIT_ICON_STRING);return l.id="submit-icon",l}},{key:"createLoadingIconElement",value:function(){var l=document.createElement("div");return l.classList.add("dots-jumping"),l}},{key:"createStopIconElement",value:function(){var l=document.createElement("div");return l.id="stop-icon",l}}]),s}(InputButton),REFRESH_ICON_STRING='<?xml version="1.0" encoding="utf-8"?>\n<svg viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">\n  <path d="M27.1 14.313V5.396L24.158 8.34c-2.33-2.325-5.033-3.503-8.11-3.503C9.902 4.837 4.901 9.847 4.899 16c.001 6.152 5.003 11.158 11.15 11.16 4.276 0 9.369-2.227 10.836-8.478l.028-.122h-3.23l-.022.068c-1.078 3.242-4.138 5.421-7.613 5.421a8 8 0 0 1-5.691-2.359A7.993 7.993 0 0 1 8 16.001c0-4.438 3.611-8.049 8.05-8.049 2.069 0 3.638.58 5.924 2.573l-3.792 3.789H27.1z"/>\n</svg>\n',CAPTURE_ICON_STRING='<?xml version="1.0" encoding="utf-8"?>\n<svg viewBox="0 0 32 32" version="1.1" xmlns="http://www.w3.org/2000/svg">\n  <title>capture</title>\n  <path d="M0 16q0 3.264 1.28 6.208t3.392 5.12 5.12 3.424 6.208 1.248 6.208-1.248 5.12-3.424 3.392-5.12 1.28-6.208-1.28-6.208-3.392-5.12-5.088-3.392-6.24-1.28q-3.264 0-6.208 1.28t-5.12 3.392-3.392 5.12-1.28 6.208zM4 16q0-3.264 1.6-6.016t4.384-4.352 6.016-1.632 6.016 1.632 4.384 4.352 1.6 6.016-1.6 6.048-4.384 4.352-6.016 1.6-6.016-1.6-4.384-4.352-1.6-6.048z"></path>\n</svg>\n',CLOSE_ICON_STRING='<?xml version="1.0" encoding="utf-8"?>\n<svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg">\n  <path d="M195.2 195.2a64 64 0 0 1 90.496 0L512 421.504 738.304 195.2a64 64 0 0 1 90.496 90.496L602.496 512 828.8 738.304a64 64 0 0 1-90.496 90.496L512 602.496 285.696 828.8a64 64 0 0 1-90.496-90.496L421.504 512 195.2 285.696a64 64 0 0 1 0-90.496z"/>\n</svg>',TICK_ICON_STRING='<?xml version="1.0" encoding="utf-8"?>\n<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path d="M4.89163 13.2687L9.16582 17.5427L18.7085 8" stroke="#000000" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>\n</svg>',CameraModal=function(a){_inherits(s,a);var h=_createSuper(s);function s(u,l,d,p){var m;_classCallCheck(this,s),(m=h.call(this,u,["modal-content","modal-camera-content"],d))._stopped=!1,m._format="image/png",m._canvas=document.createElement("canvas"),m._canvas.classList.add("camera-modal-canvas");var v=m.addButtonsAndTheirEvents(l),w=v.submitButton;return m._captureButton=v.captureButton,m._submitButton=w,m._captureIcon=m._captureButton.children[0],m._refreshIcon=SVGIconUtils.createSVGElement(REFRESH_ICON_STRING),m._refreshIcon.classList.add("modal-svg-button-icon","modal-svg-refresh-icon"),"jpeg"===p?.format&&(m._format="image/jpeg"),null!=p&&p.dimensions&&(m._dimensions=p.dimensions),m._contentRef.appendChild(m._canvas),m.extensionCloseCallback=m.stop,m}return _createClass(s,[{key:"addButtonsAndTheirEvents",value:function(l){var d=Modal.createSVGButton(CAPTURE_ICON_STRING);d.classList.add("modal-svg-camera-button"),d.children[0].classList.add("modal-svg-camera-icon");var p=this.addCloseButton(CLOSE_ICON_STRING,!0);p.classList.add("modal-svg-close-button"),p.children[0].classList.add("modal-svg-close-icon");var m=Modal.createSVGButton(TICK_ICON_STRING);return m.classList.add("modal-svg-submit-button"),this.addButtons(d,m),this.addButtonEvents(d,p,m,l),{captureButton:d,submitButton:m}}},{key:"addButtonEvents",value:function(l,d,p,m){var v=this;l.onclick=function(){v.capture()},d.addEventListener("click",this.stop.bind(this)),p.onclick=function(){var b=v.getFile();b&&FileAttachments.addFilesToType([b],[m]),v.stop(),v.close()}}},{key:"stop",value:function(){var l=this;this._mediaStream&&this._mediaStream.getTracks().forEach(function(d){return d.stop()}),this._stopped=!0,setTimeout(function(){l._captureButton.replaceChildren(l._captureIcon),l._captureButton.classList.replace("modal-svg-refresh-button","modal-svg-camera-button");var d=l._canvas.getContext("2d");d?.clearRect(0,0,l._canvas.width,l._canvas.height)},Modal.MODAL_CLOSE_TIMEOUT_MS)}},{key:"start",value:function(){var l=this;this._dataURL=void 0,this._submitButton.classList.add("modal-svg-submit-disabled"),this._stopped=!1,navigator.mediaDevices.getUserMedia({video:this._dimensions||!0}).then(function(d){if(l._mediaStream=d,!l.isOpen())return l.stop();var p=document.createElement("video");p.srcObject=d,p.play(),requestAnimationFrame(l.updateCanvas.bind(l,p,l._canvas))}).catch(function(d){console.error(d),l.stop(),l.close()})}},{key:"capture",value:function(){this._dataURL?(this._captureButton.replaceChildren(this._captureIcon),this._captureButton.classList.replace("modal-svg-refresh-button","modal-svg-camera-button"),this._submitButton.classList.add("modal-svg-submit-disabled"),this._dataURL=void 0):(this._captureButton.replaceChildren(this._refreshIcon),this._captureButton.classList.replace("modal-svg-camera-button","modal-svg-refresh-button"),this._submitButton.classList.remove("modal-svg-submit-disabled"),this._dataURL=this._canvas.toDataURL())}},{key:"getFile",value:function(){if(this._dataURL){for(var l=atob(this._dataURL.split(",")[1]),d=new Array(l.length),p=0;p<l.length;p++)d[p]=l.charCodeAt(p);var m=new Uint8Array(d),v=new Blob([m],{type:this._format}),w=NewFileName.getFileName(this._newFilePrefix||"photo","image/jpeg"===this._format?"jpeg":"png");return new File([v],w,{type:v.type})}}},{key:"updateCanvas",value:function(l,d){if(!this._stopped){if(!this._dataURL){d.width=l.videoWidth,d.height=l.videoHeight;var p=d.getContext("2d");p?.drawImage(l,0,0,d.width,d.height)}requestAnimationFrame(this.updateCanvas.bind(this,l,d))}}},{key:"openCameraModal",value:function(l){this.displayModalElements(),l.start()}}],[{key:"createCameraModalFunc",value:function(l,d,p,m){var v=new s(l,d,p,m);return v.openCameraModal.bind(v,v)}}]),s}(Modal),CAMERA_ICON_STRING='<?xml version="1.0" encoding="utf-8"?>\n<svg viewBox="0 0 32 32" version="1.1" xmlns="http://www.w3.org/2000/svg">\n  <path d="M29 7h-4.599l-2.401-4h-12l-2.4 4h-4.6c-1 0-3 1-3 2.969v16.031c0 1.657 1.5 3 2.792 3h26.271c1.313 0 2.938-1.406 2.938-2.968v-16.032c0-1-1-3-3-3zM30 26.032c0 0.395-0.639 0.947-0.937 0.969h-26.265c-0.232-0.019-0.797-0.47-0.797-1v-16.031c0-0.634 0.851-0.953 1-0.969h5.732l2.4-4h9.802l1.785 3.030 0.55 0.97h5.731c0.705 0 0.99 0.921 1 1v16.032zM16 10c-3.866 0-7 3.134-7 7s3.134 7 7 7 7-3.134 7-7-3.134-7-7-7zM16 22c-2.757 0-5-2.243-5-5s2.243-5 5-5 5 2.243 5 5-2.243 5-5 5z"></path>\n</svg>',CameraButton=function(a){_inherits(s,a);var h=_createSuper(s);function s(u,l,d){var p,m;_classCallCheck(this,s);var v=(p=h.call(this,s.createButtonElement(),null==(m=d?.button)?void 0:m.position,d?.button||{},"Photo")).createInnerElements(p._customStyles);return d&&p.addClickEvent(u,l,d.modalContainerStyle,d.files),p.elementRef.classList.add("upload-file-button"),p.elementRef.appendChild(v.styles),p.reapplyStateStyle("styles"),p}return _createClass(s,[{key:"createInnerElements",value:function(l){return{styles:this.createInnerElement(s.createSVGIconElement(),"styles",l)}}},{key:"createInnerElement",value:function(l,d,p){return CustomButtonInnerElements.createSpecificStateElement(this.elementRef,d,p)||l}},{key:"addClickEvent",value:function(l,d,p,m){var v=CameraModal.createCameraModalFunc(l,d,p,m);this.elementRef.onclick=v}}],[{key:"createButtonElement",value:function(){var l=document.createElement("div");return l.classList.add("input-button"),l}},{key:"createSVGIconElement",value:function(){var l=SVGIconUtils.createSVGElement(CAMERA_ICON_STRING);return l.id="camera-icon",l}}]),s}(InputButton),Input=function(){function a(h,s,u,l){_classCallCheck(this,a),this.elementRef=a.createPanelElement(h.inputAreaStyle);var d=new TextInputEl(u,h.textInput),p={},m=this.createFileUploadComponents(h,u,l,p);h.speechToText&&!p.microphone&&(p.microphone={button:new SpeechToText(h,d,s.addNewErrorMessage.bind(s))});var v=new SubmitButton(h,d.inputElementRef,s,u,m);d.submit=v.submitFromInput.bind(v),h.submitUserMessage=v.submit.bind(v,!0),p.submit={button:v},a.addElements(this.elementRef,d,p,l,m,h.dropupStyles)}return _createClass(a,[{key:"createFileUploadComponents",value:function(s,u,l,d){var p,m,v,b,w=new FileAttachments(this.elementRef,s.attachmentContainerStyle,u.demo);if(a.createUploadButtons(u.fileTypes||{},w,l,d),null!=(p=u.camera)&&p.files){var S=(null==(m=d.images)?void 0:m.fileType)||w.addType(u.camera.files,"images");d.camera={button:new CameraButton(l,S,u.camera)}}if(null!=(v=u.recordAudio)&&v.files){var M=(null==(b=d.audio)?void 0:b.fileType)||w.addType(u.recordAudio.files,"audio");d.microphone={button:new RecordAudio(M,u.recordAudio)}}return DragAndDrop.isEnabled(w,s.dragAndDrop)&&DragAndDrop.create(l,w,s.dragAndDrop),w}}],[{key:"createPanelElement",value:function(s){var u=document.createElement("div");return u.id="input",Object.assign(u.style,s),u}},{key:"createUploadButtons",value:function(s,u,l,d){Object.keys(s).forEach(function(p){var m=p,v=s[m];if(v.files){var b=u.addType(v.files,m),w=FILE_TYPE_BUTTON_ICONS[m],k=new UploadFileButton(l,b,v,w.id,w.svgString,w.dropupText);d[m]={button:k,fileType:b}}})}},{key:"addElements",value:function(s,u,l,d,p,m){ElementUtils.addElements(s,u.elementRef);var v=ButtonContainers.create(),b=InputButtonPositions.addButtons(v,l,d,m);InputButtonStyleAdjustments.set(u.inputElementRef,v,p.elementRef,b),ButtonContainers.add(s,v)}}]),a}(),ChatView=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"createElements",value:function(s,u,l){var d=document.createElement("div");d.id="chat-view";var p=new Messages(s,u,l);u.websocket&&Websocket.createConnection(u,p);var m=new Input(s,p,u,d);return ElementUtils.addElements(d,p.elementRef,m.elementRef),d}},{key:"render",value:function(s,u,l,d){var p=a.createElements(s,l,d);u.replaceChildren(p)}}]),a}(),style='#validate-property-key-view{height:100%;position:relative;display:flex;justify-content:center;align-items:center;padding:8px}#large-loading-ring{display:inline-block;width:50px;height:50px}#large-loading-ring:after{content:" ";display:block;width:38px;height:38px;margin:1px;border-radius:50%;border:5px solid #5fb2ff;border-color:#5fb2ff transparent #5fb2ff transparent;animation:large-loading-ring 1.4s linear infinite}@keyframes large-loading-ring{0%{transform:rotate(0)}to{transform:rotate(360deg)}}#insert-key-view{height:100%;position:relative}#insert-key-contents{text-align:center;position:absolute;top:44%;left:50%;transform:translate(-50%,-50%);width:82%;display:flex;max-width:700px}#insert-key-title{margin-bottom:15px}#insert-key-input-container{margin-right:2.7em;width:calc(100% - 80px)}#insert-key-input{padding:.3em 1.7em .3em .3em;border-width:1px;border-style:solid;border-radius:3px;width:100%;font-size:inherit}.insert-key-input-valid{border-color:gray}.insert-key-input-invalid{border-color:red}#visibility-icon-container{position:relative;float:right;cursor:pointer;-webkit-user-select:none;user-select:none}.visibility-icon{filter:brightness(0) saturate(100%) invert(63%) sepia(1%) saturate(9%) hue-rotate(43deg) brightness(98%) contrast(92%);position:absolute;right:-1.7em;top:-1.43em}#visible-icon{top:-1.4em}.visibility-icon:hover{filter:unset}.visibility-icon>*{pointer-events:none}#start-button{border:1px solid grey;color:#454545;border-radius:4px;width:3em;display:flex;justify-content:center;align-items:center;cursor:pointer;padding:.28em .3em;-webkit-user-select:none;user-select:none;background-color:#fff}#start-button:hover{background-color:#f2f2f2}#start-button:active{background-color:#d2d2d2}#insert-key-help-text-container{width:100%;position:absolute;margin-top:32px;margin-bottom:20px}#insert-key-help-text-contents{width:100%;position:absolute}#insert-key-input-invalid-text{display:block;margin-top:1em;margin-bottom:.5em;color:red}.insert-key-input-help-text{display:block;margin-top:16px}#loading-ring{display:inline-block;width:16px;height:16px}#loading-ring:after{content:" ";display:block;width:11px;height:11px;margin:1px;border-radius:50%;border:2px solid #0084ff;border-color:#0084ff transparent #0084ff transparent;animation:loading-ring 1.2s linear infinite}@keyframes loading-ring{0%{transform:rotate(0)}to{transform:rotate(360deg)}}#error-view{color:red;font-size:1.2em;line-height:1.3em;margin-top:-5px;text-align:center;height:100%;display:flex;justify-content:center;align-items:center;padding-left:8px;padding-right:8px}.intro-panel{position:absolute;display:flex;justify-content:center;right:0;bottom:0;left:0;margin:auto;height:fit-content;top:-2.5em}#internal-intro-panel{width:250px;height:min-content;display:block;border-radius:5px;overflow:auto;border:1px solid rgb(203,203,203);padding:10px;max-height:calc(100% - 6.8em)}#internal-intro-panel>p{margin-block-start:.8em;margin-block-end:.8em}pre code.hljs{display:block;overflow-x:auto;padding:1em}code.hljs{padding:3px 5px}/*!\n  Theme: a11y-dark\n  Author: @ericwbailey\n  Maintainer: @ericwbailey\n\n  Based on the Tomorrow Night Eighties theme: https://github.com/isagalaev/highlight.js/blob/master/src/styles/tomorrow-night-eighties.css\n*/.hljs{background:#2b2b2b;color:#f8f8f2}.hljs-comment,.hljs-quote{color:#d4d0ab}.hljs-deletion,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#ffa07a}.hljs-built_in,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-type{color:#f5ab35}.hljs-attribute{color:gold}.hljs-addition,.hljs-bullet,.hljs-string,.hljs-symbol{color:#abe338}.hljs-section,.hljs-title{color:#00e0e0}.hljs-keyword,.hljs-selector-tag{color:#dcc6e0}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}@media screen and (-ms-high-contrast: active){.hljs-addition,.hljs-attribute,.hljs-built_in,.hljs-bullet,.hljs-comment,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-quote,.hljs-string,.hljs-symbol,.hljs-type{color:highlight}.hljs-keyword,.hljs-selector-tag{font-weight:700}}#messages{overflow:auto}.outer-message-container:last-child{margin-bottom:5px}.inner-message-container{display:flex;width:90%;margin-left:auto;margin-right:auto;max-width:100%}.message-bubble{margin-top:10px;word-wrap:break-word;width:fit-content;max-width:60%;border-radius:10px;padding:.42em .55em;height:fit-content}.user-message-text{color:#fff;background-color:#0084ff;margin-right:0;margin-left:auto}.ai-message-text{color:#000;background-color:#e4e6eb;margin-left:0;margin-right:auto}.error-message-text{margin:14px auto 10px;background-color:#f4c0c0;color:#474747;text-align:center;max-width:95%}.loading-message-text{width:1em;padding:.6em .75em .6em 1.3em}.message-bubble>p{line-height:1.26em}.message-bubble>p:first-child{margin-top:0}.message-bubble>p:last-child{margin-bottom:0}pre{overflow:auto;display:block;word-break:break-all;word-wrap:break-word;border-radius:7px;background:#2b2b2b;color:#f8f8f2;margin-top:.8em;margin-bottom:.8em;padding:.6em;font-size:.9em;line-height:1.5em}.image-message{padding:0;display:flex;background-color:#ddd}.image-message>*,.image-message>*>*{width:100%;border-radius:8px;display:flex}.audio-message{width:60%;max-width:300px;height:2.2em;max-height:54px;padding:0;background-color:unset}.audio-player{width:100%;height:100%}.audio-player-safari{height:fit-content;width:40px}.audio-player-safari-left{float:left}.audio-player-safari-right{float:right}.any-file-message-bubble{padding:1px}.any-file-message-contents{display:flex}.any-file-message-icon-container{width:1.3em;min-width:1.3em;position:relative;border-radius:4px;margin-left:6px;margin-right:2px}.any-file-message-icon{background-color:#fff;border-radius:4px;position:absolute;width:1em;height:1.25em;padding:1px;margin-top:auto;margin-bottom:auto;top:0;bottom:0}.any-file-message-text{padding-top:5px;overflow-wrap:anywhere;padding-bottom:5px;padding-right:7px}.message-bubble>a{color:inherit}.left-item-position{margin-right:10px}.right-item-position{margin-left:10px}.avatar{padding-top:5px;width:1.5em;height:1.5em;border-radius:1px}.avatar-container{margin-top:9px}.name{margin-top:16px;font-size:15px}#drag-and-drop{position:absolute;display:none;z-index:10;height:calc(100% - 10px);width:calc(100% - 10px);background-color:#70c6ff4d;border:5px dashed #6dafff}#file-attachment-container{position:absolute;height:3.6em;width:calc(80% - 4px);top:-2.5em;border-radius:5px;overflow:auto;text-align:left;background-color:#d7d7d73b;padding-left:4px}.file-attachment{width:2.85em;height:2.85em;display:inline-flex;margin-right:.6em;margin-bottom:.44em;margin-top:4px;position:relative;background-color:#fff;border-radius:5px}.image-attachment{width:100%;height:100%;object-fit:cover;border-radius:5px}.border-bound-attachment{width:calc(100% - 2px);height:calc(100% - 2px);border:1px solid #c3c3c3;border-radius:5px;overflow:hidden}.border-bound-attachment-safari{width:calc(100% - 1px);height:calc(100% - 1px)}.audio-attachment-icon-container{cursor:pointer}.audio-attachment-icon-container:hover{background-color:#f8f8f8}.attachment-icon{left:0;right:0;bottom:0;top:2px;margin:auto;position:absolute;width:25px;-webkit-user-select:none;user-select:none}.not-removable-attachment-icon{top:0;right:0;bottom:0;left:0}.play-icon{filter:brightness(0) saturate(100%) invert(17%) sepia(0%) saturate(1392%) hue-rotate(67deg) brightness(98%) contrast(97%)}.stop-icon{filter:brightness(0) saturate(100%) invert(29%) sepia(90%) saturate(1228%) hue-rotate(198deg) brightness(93%) contrast(98%)}.audio-placeholder-text-3-digits{padding-left:.26rem}.audio-placeholder-text-4-digits{padding-left:.1rem}.any-file-attachment{padding:2px 0}.file-attachment-text-container{position:absolute;width:inherit;display:flex;align-items:center;height:100%;top:-1px}.audio-placeholder-text-3-digits-container{padding-top:1px;cursor:default}.any-file-attachment-text{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;padding-left:.13em;margin-left:auto;margin-right:auto}.remove-file-attachment-button{height:1.25em;width:1.25em;border:1px solid #cfcfcf;border-radius:25px;background-color:#fff;top:-4px;right:-5px;position:absolute;display:flex;justify-content:center;cursor:pointer;-webkit-user-select:none;user-select:none}.remove-file-attachment-button:hover{background-color:#e4e4e4}.remove-file-attachment-button:active{background-color:#d7d7d7}.x-icon{color:#4e4e4e;top:-.075em;position:relative;font-size:1.05em}.modal{display:none;flex-direction:column;align-items:center;justify-content:center;position:absolute;width:80%;max-width:420px;max-height:80%;margin:auto;top:0;right:0;bottom:0;left:0;z-index:2}.modal-content{border-top:1px solid rgb(217,217,217);border-left:1px solid rgb(217,217,217);border-right:1px solid rgb(217,217,217);border-top-left-radius:inherit;border-top-right-radius:inherit;background-color:#fff;overflow-y:auto;height:fit-content;max-height:calc(100% - 3.3em);width:100%}.modal-content>p{margin-left:1em;margin-right:1em}.modal-content>ul{margin-right:1em}.modal-button-panel{height:3.3em;border:1px solid;border-color:rgb(223,223,223) rgb(217,217,217) rgb(217,217,217);border-bottom-left-radius:inherit;border-bottom-right-radius:inherit;background-color:#fff;text-align:center;justify-content:center;display:flex;width:100%}.modal-button{min-width:2.5em;text-align:center;color:#fff;border-radius:5px;padding:.4em .4em .3em;height:1.25em;background-color:#3279b2;top:0;bottom:0;cursor:pointer;-webkit-user-select:none;user-select:none;margin:auto .31em}.modal-button:hover{background-color:#276da7}.modal-button:active{background-color:#1b5687}.modal-svg-button{padding:0 0 2px;width:2em;height:1.8em}.modal-svg-button-icon{width:100%;height:100%;filter:brightness(0) saturate(100%) invert(100%) sepia(15%) saturate(4%) hue-rotate(346deg) brightness(101%) contrast(102%)}#modal-background-panel{position:absolute;width:100%;height:100%;background-color:#00000042;z-index:1;display:none}.show-modal-background{animation:fadeInBackground .3s ease-in-out}@keyframes fadeInBackground{0%{opacity:0}to{opacity:1}}.show-modal{animation:fadeInModal .3s ease-in-out}@keyframes fadeInModal{0%{opacity:0;scale:.95}to{opacity:1;scale:1}}.hide-modal-background{animation:fadeOutBackground .2s ease-in-out}@keyframes fadeOutBackground{0%{opacity:1}to{opacity:0}}.hide-modal{animation:fadeOutModal .2s ease-in-out}@keyframes fadeOutModal{0%{opacity:1;scale:1}to{opacity:0;scale:.95}}.modal-camera-content{overflow:hidden;text-align:center;border:unset;height:100%;background-color:#2a2a2a;display:flex;justify-content:center}.camera-modal-canvas{max-width:100%;max-height:100%;margin-top:auto;margin-bottom:auto}.modal-svg-submit-button{background-color:green}.modal-svg-submit-button:hover{background-color:#007500}.modal-svg-submit-button:active{background-color:#006500}.modal-svg-submit-disabled{pointer-events:none;background-color:#747474}.modal-svg-close-button{height:1.56em;padding-top:.37em;padding-bottom:0;background-color:#c13e3e}.modal-svg-close-button:hover{background-color:#b43434}.modal-svg-close-button:active{background-color:#972929}.modal-svg-close-icon{width:80%;height:80%}.modal-svg-camera-button{height:1.6em;padding-top:.38em;padding-bottom:0}.modal-svg-camera-icon{height:76%}.modal-svg-refresh-icon{height:105%}.modal-svg-refresh-button{height:1.66em;padding-top:.11em;padding-bottom:.21em}.input-button-container{position:relative;z-index:1}.inside-right{position:absolute;right:calc(10% + .35em);bottom:.85em}.inside-left{position:absolute;left:calc(10% + .35em);bottom:.85em}.outside-left{position:absolute;right:calc(11px - .55em);bottom:.88em}.outside-right{position:absolute;left:calc(11px - .55em);bottom:.88em}#upload-images-icon{position:absolute;pointer-events:none;width:1.45em;height:1.45em;left:.11em;bottom:.08em;filter:brightness(0) saturate(100%) invert(43%) sepia(0%) saturate(740%) hue-rotate(77deg) brightness(99%) contrast(92%)}#upload-gifs-icon{position:absolute;pointer-events:none;width:1.5em;height:1.48em;left:.07em;bottom:.08em;filter:brightness(0) saturate(100%) invert(49%) sepia(0%) saturate(2586%) hue-rotate(12deg) brightness(93%) contrast(90%)}#upload-audio-icon{position:absolute;pointer-events:none;width:1.21em;height:1.21em;left:.17em;bottom:.2em;filter:brightness(0) saturate(100%) invert(15%) sepia(0%) saturate(337%) hue-rotate(125deg) brightness(91%) contrast(94%);transform:scaleX(.95)}#camera-icon{position:absolute;pointer-events:none;width:1.21em;height:1.21em;left:.23em;bottom:.2em;filter:brightness(0) saturate(100%) invert(52%) sepia(0%) saturate(161%) hue-rotate(164deg) brightness(91%) contrast(92%);transform:scaleX(.95)}#upload-mixed-files-icon{position:absolute;pointer-events:none;width:1.21em;height:1.21em;left:.25em;bottom:.2em;filter:brightness(0) saturate(100%) invert(53%) sepia(0%) saturate(36%) hue-rotate(74deg) brightness(98%) contrast(93%);transform:scaleX(.95)}#interim-text{color:gray}#microphone-button{padding-top:.5px}.outer-button-container>#microphone-button{padding-bottom:1px}#microphone-icon{position:absolute;pointer-events:none;width:1.21em;height:1.21em;left:.25em;bottom:.25em}.default-microphone-icon{filter:brightness(0) saturate(100%) invert(32%) sepia(0%) saturate(924%) hue-rotate(46deg) brightness(95%) contrast(99%)}.active-microphone-icon{filter:brightness(0) saturate(100%) invert(10%) sepia(97%) saturate(7495%) hue-rotate(0deg) brightness(101%) contrast(107%);border-radius:10px}.command-microphone-icon{filter:brightness(0) saturate(100%) invert(42%) sepia(96%) saturate(1067%) hue-rotate(77deg) brightness(99%) contrast(102%)}.unsupported-microphone{display:none}#submit-icon{height:100%;filter:brightness(0) saturate(100%) invert(32%) sepia(0%) saturate(924%) hue-rotate(46deg) brightness(95%) contrast(99%);width:1.21em}#stop-icon{background-color:#acacac;position:absolute;width:.95em;height:.95em;left:.35em;bottom:.35em;border-radius:2px}.submit-button-enlarged{scale:1.1;margin-right:.3em;margin-left:.3em}.dots-jumping{position:relative;left:calc(-9990px + .275em);width:.22em;height:.22em;border-radius:5px;background-color:#848484;color:#848484;box-shadow:9990px 0 #848484,calc(9990px + .44em) 0 0 0 #848484,calc(9990px + .8em) 0 0 0 #848484;animation:dots-jumping 1.5s infinite linear;bottom:-.7em}@keyframes dots-jumping{0%{box-shadow:9990px 0 #848484,calc(9990px + .44em) 0 0 0 #848484,calc(9990px + .8em) 0 0 0 #848484}16.667%{box-shadow:9990px -6px #848484,calc(9990px + .44em) 0 0 0 #848484,calc(9990px + .8em) 0 0 0 #848484}33.333%{box-shadow:9990px 0 #848484,calc(9990px + .44em) 0 0 0 #848484,calc(9990px + .8em) 0 0 0 #848484}50%{box-shadow:9990px 0 #848484,calc(9990px + .44em) -6px 0 0 #848484,calc(9990px + .8em) 0 0 0 #848484}66.667%{box-shadow:9990px 0 #848484,calc(9990px + .44em) 0 0 0 #848484,calc(9990px + .8em) 0 0 0 #848484}83.333%{box-shadow:9990px 0 #848484,calc(9990px + .44em) 0 0 0 #848484,calc(9990px + .8em) -6px 0 0 #848484}to{box-shadow:9990px 0 #848484,calc(9990px + .44em) 0 0 0 #848484,calc(9990px + .8em) 0 0 0 #848484}}.dots-flashing{position:relative;width:.45em;height:.45em;border-radius:5px;background-color:var(--message-dots-color);color:var(--message-dots-color);animation:dots-flashing 1s infinite linear alternate;animation-delay:.5s}.dots-flashing:before,.dots-flashing:after{content:"";display:inline-block;position:absolute;top:0}.dots-flashing:before{left:-.7em;width:.45em;height:.45em;border-radius:5px;background-color:var(--message-dots-color);color:var(--message-dots-color);animation:dots-flashing 1s infinite alternate;animation-delay:0s}.dots-flashing:after{left:.7em;width:.45em;height:.45em;border-radius:5px;background-color:var(--message-dots-color);color:var(--message-dots-color);animation:dots-flashing 1s infinite alternate;animation-delay:1s}@keyframes dots-flashing{0%{background-color:var(--message-dots-color)}50%,to{background-color:var(--message-dots-color-fade)}}.input-button{border-radius:4px;cursor:pointer;margin-bottom:.2em;-webkit-user-select:none;user-select:none}.input-button-svg{width:1.65em;height:1.65em}.input-button:hover{background-color:#9c9c9c2e}.input-button:active{background-color:#9c9c9c5e}.loading-button{background-color:#fff;cursor:auto}.loading-button:hover,.loading-button:active{background-color:#fff}.text-button{filter:unset!important;display:flex;justify-content:center;align-items:center;margin-left:4px;margin-right:4px;height:1.6em}#text-input-container{background-color:#fff;width:80%;display:flex;border:1px solid #0000001a;border-radius:5px;margin-top:.8em;margin-bottom:.8em;box-shadow:#959da533 0 1px 12px;overflow-y:auto;max-height:200px;position:relative}.text-input-container-left-adjustment{margin-left:1.5em}.text-input-container-right-adjustment{margin-right:1.5em}.text-input-container-left-small-adjustment{margin-left:1.1em}.text-input-container-left-small-adjustment>.outside-left{right:calc(14px - .55em)}.text-input-container-right-small-adjustment{margin-right:1.1em}.text-input-container-right-small-adjustment>.outside-right{left:calc(14px - .55em)}#text-input{text-align:left;outline:none;word-wrap:break-word;line-break:auto}.text-input-styling{padding:.4em .5em;overflow:overlay;width:100%}.text-input-inner-left-adjustment{padding-left:2.2em}.text-input-inner-right-adjustment{padding-right:2em}.text-input-disabled{pointer-events:none;-webkit-user-select:none;user-select:none}.text-input-placeholder{color:gray}.outside-right>#dropup-menu,.inside-right>#dropup-menu{right:0}#dropup-icon{position:absolute;pointer-events:none;width:1.16em;height:1.2em;left:.265em;bottom:.43em;filter:brightness(0) saturate(100%) invert(54%) sepia(0%) saturate(724%) hue-rotate(6deg) brightness(92%) contrast(90%)}#dropup-menu{background-color:#fff;position:absolute;transform:translateY(-100%);border-radius:5px;z-index:1;top:-.49em;box-shadow:#0003 -1px 2px 10px,#0000001a 0 2px 4px;cursor:pointer;-webkit-user-select:none;user-select:none}.dropup-menu-item{height:1.4em;padding:.28em .84em .28em .35em;display:flex;position:relative}.dropup-menu-item>*{pointer-events:none}.dropup-menu-item:first-child{padding-top:.49em;border-top-left-radius:inherit;border-top-right-radius:inherit}.dropup-menu-item:last-child{padding-bottom:.45em;border-bottom-left-radius:inherit;border-bottom-right-radius:inherit}.dropup-menu-item-icon{width:1.39em;position:relative;margin-right:.56em}.dropup-menu-item-icon>svg{bottom:0!important;top:0!important;margin-bottom:auto;margin-top:auto}.dropup-menu-item-text{margin-top:.08em;width:max-content}#input{width:100%;display:inline-flex;text-align:center;margin-left:auto;margin-right:auto;margin-top:auto;position:relative;justify-content:center}#chat-view{height:100%;display:grid;grid-template-columns:100%}::-webkit-scrollbar{width:9px;height:9px}::-webkit-scrollbar-thumb{background-color:#d0d0d0;border-radius:5px}::-webkit-scrollbar-track{background-color:#f2f2f2}:host{all:initial;display:table-cell}#container{height:350px;width:320px;border:1px solid #cacaca;font-family:Inter,sans-serif,Avenir,Helvetica,Arial;font-size:.9rem;background-color:#fff;position:relative;overflow:hidden}\n',__defProp=Object.defineProperty,__getOwnPropDesc=Object.getOwnPropertyDescriptor,__decorateClass=function a(h,s,u,l){for(var m,d=l>1?void 0:l?__getOwnPropDesc(s,u):s,p=h.length-1;p>=0;p--)(m=h[p])&&(d=(l?m(s,u,d):m(d))||d);return l&&d&&__defProp(s,u,d),d},DeepChat=function(a){_inherits(s,a);var h=_createSuper(s);function s(){var u;return _classCallCheck(this,s),(u=h.call(this)).getMessages=function(){return[]},u.submitUserMessage=function(){return console.warn("submitUserMessage failed - please wait for chat view to render before calling this property.")},u.focusInput=function(){FocusUtils.focusFromParentElement(u._elementRef)},u.refreshMessages=function(){},u.clearMessages=function(){},u.onNewMessage=function(){},u.onClearMessages=function(){},u.onComponentRender=function(){},u._hasBeenRendered=!1,u._auxiliaryStyleApplied=!1,GoogleFont.appendStyleSheetToHead(),u._elementRef=document.createElement("div"),u._elementRef.id="container",u.attachShadow({mode:"open"}).appendChild(u._elementRef),WebComponentStyleUtils.apply(style,u.shadowRoot),setTimeout(function(){u._hasBeenRendered||u.onRender()},20),u}return _createClass(s,[{key:"changeToChatView",value:function(){this._activeService&&(this._activeService.validateConfigKey=!1),this.onRender()}},{key:"onRender",value:function(){var l,d;null!==(l=this._activeService)&&void 0!==l||(this._activeService=ServiceIOFactory.create(this)),this._activeService&&(this.auxiliaryStyle&&!this._auxiliaryStyleApplied&&(WebComponentStyleUtils.apply(this.auxiliaryStyle,this.shadowRoot),this._auxiliaryStyleApplied=!0),Object.assign(this._elementRef.style,this.containerStyle),this._activeService.key&&this._activeService.validateConfigKey?ValidateKeyPropertyView.render(this._elementRef,this.changeToChatView.bind(this),this._activeService):this._activeService instanceof DirectServiceIO&&!this._activeService.key?this._activeService instanceof DirectServiceIO&&InsertKeyView.render(this._elementRef,this.changeToChatView.bind(this),this._activeService):(null!==(d=this._childElement)&&void 0!==d||(this._childElement=this.children[0]),ChatView.render(this,this._elementRef,this._activeService,this._childElement)),this._hasBeenRendered=!0,FireEvents.onRender(this))}}]),s}(InternalHTML);__decorateClass([Property("object")],DeepChat.prototype,"directConnection",2),__decorateClass([Property("object")],DeepChat.prototype,"request",2),__decorateClass([Property("object")],DeepChat.prototype,"stream",2),__decorateClass([Property("object")],DeepChat.prototype,"requestBodyLimits",2),__decorateClass([Property("function")],DeepChat.prototype,"requestInterceptor",2),__decorateClass([Property("function")],DeepChat.prototype,"responseInterceptor",2),__decorateClass([Property("function")],DeepChat.prototype,"validateMessageBeforeSending",2),__decorateClass([Property("object")],DeepChat.prototype,"containerStyle",2),__decorateClass([Property("object")],DeepChat.prototype,"attachmentContainerStyle",2),__decorateClass([Property("object")],DeepChat.prototype,"dropupStyles",2),__decorateClass([Property("object")],DeepChat.prototype,"inputAreaStyle",2),__decorateClass([Property("object")],DeepChat.prototype,"textInput",2),__decorateClass([Property("object")],DeepChat.prototype,"submitButtonStyles",2),__decorateClass([Property("string")],DeepChat.prototype,"auxiliaryStyle",2),__decorateClass([Property("array")],DeepChat.prototype,"initialMessages",2),__decorateClass([Property("string")],DeepChat.prototype,"introMessage",2),__decorateClass([Property("object")],DeepChat.prototype,"avatars",2),__decorateClass([Property("object")],DeepChat.prototype,"names",2),__decorateClass([Property("boolean")],DeepChat.prototype,"displayLoadingBubble",2),__decorateClass([Property("object")],DeepChat.prototype,"errorMessages",2),__decorateClass([Property("object")],DeepChat.prototype,"messageStyles",2),__decorateClass([Property("object")],DeepChat.prototype,"textToSpeech",2),__decorateClass([Property("object")],DeepChat.prototype,"speechToText",2),__decorateClass([Property("object")],DeepChat.prototype,"images",2),__decorateClass([Property("object")],DeepChat.prototype,"gifs",2),__decorateClass([Property("object")],DeepChat.prototype,"camera",2),__decorateClass([Property("object")],DeepChat.prototype,"audio",2),__decorateClass([Property("object")],DeepChat.prototype,"microphone",2),__decorateClass([Property("object")],DeepChat.prototype,"mixedFiles",2),__decorateClass([Property("object")],DeepChat.prototype,"dragAndDrop",2),__decorateClass([Property("object")],DeepChat.prototype,"introPanelStyle",2),__decorateClass([Property("function")],DeepChat.prototype,"onNewMessage",2),__decorateClass([Property("function")],DeepChat.prototype,"onClearMessages",2),__decorateClass([Property("function")],DeepChat.prototype,"onComponentRender",2),__decorateClass([Property("object")],DeepChat.prototype,"demo",2),customElements.define("deep-chat",DeepChat)}},a=>{a(a.s=991)}]);